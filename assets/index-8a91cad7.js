let Ht;const Cs=new Uint8Array(16);function Os(){if(!Ht&&(Ht=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ht))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ht(Cs)}const Rs=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ai(t){return typeof t=="string"&&Rs.test(t)}const de=[];for(let t=0;t<256;++t)de.push((t+256).toString(16).slice(1));function Is(t,e=0){return de[t[e+0]]+de[t[e+1]]+de[t[e+2]]+de[t[e+3]]+"-"+de[t[e+4]]+de[t[e+5]]+"-"+de[t[e+6]]+de[t[e+7]]+"-"+de[t[e+8]]+de[t[e+9]]+"-"+de[t[e+10]]+de[t[e+11]]+de[t[e+12]]+de[t[e+13]]+de[t[e+14]]+de[t[e+15]]}function Ts(t){if(!ai(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}const js=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Rr={randomUUID:js};function ci(t,e,n){if(Rr.randomUUID&&!e&&!t)return Rr.randomUUID();t=t||{};const r=t.random||(t.rng||Os)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let i=0;i<16;++i)e[n+i]=r[i];return e}return Is(r)}function ui(){return ci().replace(/-/g,"")}let ur=ui;const fi=()=>ur();fi.setFactory=t=>{ur=t};fi.reset=()=>{ur=ui};const ze=Symbol.for("_am_meta"),ft=Symbol.for("_am_trace"),lt=Symbol.for("_am_objectId"),vn=Symbol.for("_am_isProxy"),fr=Symbol.for("_am_clearCache"),li=Symbol.for("_am_uint"),hi=Symbol.for("_am_int"),di=Symbol.for("_am_f64"),gi=Symbol.for("_am_counter"),Us=Symbol.for("_am_text");class Be{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,Us,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="￼"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[ze])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[ze])throw new RangeError("object cannot be modified outside of a change block");n.every(r=>typeof r=="string")?this.elems.splice(e,0,...n.join("")):this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[ze])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new Be(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new Be(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){return new Be(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}}class Lt{constructor(e){this.value=e||0,Reflect.defineProperty(this,gi,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}increment(e){throw new Error("Counters should not be incremented outside of a change callback")}decrement(e){throw new Error("Counters should not be decremented outside of a change callback")}}class Ds extends Lt{constructor(e,n,r,i,s){super(e),this.context=n,this.path=r,this.objectId=i,this.key=s}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}}function Ms(t,e,n,r,i){return new Ds(t,e,n,r,i)}class mn{constructor(e){this.val=e}toString(){return this.val}}function Ne(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function Se(t,e){const{context:n,objectId:r,path:i,textV2:s}=t,o=n.getWithType(r,e);if(o===null)return;const a=o[0],c=o[1];switch(a){case void 0:return;case"map":return pt(n,c,s,[...i,e]);case"list":return Bt(n,c,s,[...i,e]);case"text":return s?n.text(c):jt(n,c,[...i,e]);case"str":return c;case"uint":return c;case"int":return c;case"f64":return c;case"boolean":return c;case"null":return null;case"bytes":return c;case"timestamp":return c;case"counter":return Ms(c,n,i,r,e);default:throw RangeError(`datatype ${a} unimplemented`)}}function cn(t,e){switch(typeof t){case"object":if(t==null)return[null,"null"];if(t[li])return[t.value,"uint"];if(t[hi])return[t.value,"int"];if(t[di])return[t.value,"f64"];if(t[gi])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof mn)return[t.toString(),"str"];if(t instanceof Be)return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.getPrototypeOf(t)===Object.getPrototypeOf({}))return[t,"map"];throw xn(t,context)?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];default:throw new RangeError(`Unsupported type of value: ${typeof t}`)}}function xn(t,e){var n,r;return t instanceof Date?!1:!!(t&&((r=(n=t[ze])===null||n===void 0?void 0:n.handle)===null||r===void 0?void 0:r.__wbg_ptr)===e.__wbg_ptr)}const Ps={get(t,e){const{context:n,objectId:r,cache:i}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===lt?r:e===vn?!0:e===ft?t.trace:e===ze?{handle:n}:(i[e]||(i[e]=Se(t,e)),i[e])},set(t,e,n){const{context:r,objectId:i,path:s,textV2:o}=t;if(t.cache={},xn(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===ft)return t.trace=n,!0;if(e===fr)return!0;const[a,c]=cn(n,o);switch(c){case"list":{const u=r.putObject(i,e,[]),f=Bt(r,u,o,[...s,e]);for(let l=0;l<a.length;l++)f[l]=a[l];break}case"text":{if(o)un(a),r.putObject(i,e,a);else{hr(a);const u=r.putObject(i,e,"");jt(r,u,[...s,e]).splice(0,0,...a)}break}case"map":{const u=r.putObject(i,e,{}),f=pt(r,u,o,[...s,e]);for(const l in a)f[l]=a[l];break}default:r.put(i,e,a,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;return t.cache={},n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n}=t,r=e.keys(n);return[...new Set(r)]}},pi={get(t,e){const{context:n,objectId:r}=t;return e=Ne(e),e===Symbol.hasInstance?i=>Array.isArray(i):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===lt?r:e===vn?!0:e===ft?t.trace:e===ze?{handle:n}:e==="length"?n.length(r):typeof e=="number"?Se(t,e):lr(t)[e]},set(t,e,n){const{context:r,objectId:i,path:s,textV2:o}=t;if(e=Ne(e),xn(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===fr)return!0;if(e===ft)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[a,c]=cn(n,o);switch(c){case"list":{let u;e>=r.length(i)?u=r.insertObject(i,e,[]):u=r.putObject(i,e,[]),Bt(r,u,o,[...s,e]).splice(0,0,...a);break}case"text":{if(o)un(a),e>=r.length(i)?r.insertObject(i,e,a):r.putObject(i,e,a);else{let u;hr(a),e>=r.length(i)?u=r.insertObject(i,e,""):u=r.putObject(i,e,""),jt(r,u,[...s,e]).splice(0,0,...a)}break}case"map":{let u;e>=r.length(i)?u=r.insertObject(i,e,{}):u=r.putObject(i,e,{});const f=pt(r,u,o,[...s,e]);for(const l in a)f[l]=a[l];break}default:e>=r.length(i)?r.insert(i,e,a,c):r.put(i,e,a,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;e=Ne(e);const i=n.get(r,e);if(i!=null&&i[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r}=t;return e=Ne(e),typeof e=="number"?e<n.length(r):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r}=t;return e==="length"?{writable:!0,value:n.length(r)}:e===lt?{configurable:!1,enumerable:!1,value:r}:(e=Ne(e),{configurable:!0,enumerable:!0,value:Se(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},Fs=Object.assign({},pi,{get(t,e){const{context:n,objectId:r}=t;return e=Ne(e),e===Symbol.hasInstance?i=>Array.isArray(i):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===lt?r:e===vn?!0:e===ft?t.trace:e===ze?{handle:n}:e==="length"?n.length(r):typeof e=="number"?Se(t,e):Ls(t)[e]||lr(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new Be)}});function pt(t,e,n,r){const i={context:t,objectId:e,path:r||[],cache:{},textV2:n},s={};return Object.assign(s,i),new Proxy(s,Ps)}function Bt(t,e,n,r){const i={context:t,objectId:e,path:r||[],cache:{},textV2:n},s=[];return Object.assign(s,i),new Proxy(s,pi)}function jt(t,e,n){const r={context:t,objectId:e,path:n||[],cache:{},textV2:!1},i={};return Object.assign(i,r),new Proxy(i,Fs)}function Ns(t,e){return pt(t,"_root",e,[])}function lr(t){const{context:e,objectId:n,path:r,textV2:i}=t;return{deleteAt(o,a){return typeof a=="number"?e.splice(n,o,a):e.delete(n,o),this},fill(o,a,c){const[u,f]=cn(o,i),l=e.length(n);a=Ne(a||0),c=Ne(c||l);for(let h=a;h<Math.min(c,l);h++)if(f==="list"||f==="map")e.putObject(n,h,u);else if(f==="text")if(i)un(u),e.putObject(n,h,u);else{hr(u);const d=e.putObject(n,h,""),y=jt(e,d,[...r,h]);for(let _=0;_<u.length;_++)y[_]=u.get(_)}else e.put(n,h,u,f);return this},indexOf(o,a=0){const c=e.length(n);for(let u=a;u<c;u++){const f=e.getWithType(n,u);if(f&&(f[1]===o[lt]||f[1]===o))return u}return-1},insertAt(o,...a){return this.splice(o,0,...a),this},pop(){const o=e.length(n);if(o==0)return;const a=Se(t,o-1);return e.delete(n,o-1),a},push(...o){const a=e.length(n);return this.splice(a,0,...o),e.length(n)},shift(){if(e.length(n)==0)return;const o=Se(t,0);return e.delete(n,0),o},splice(o,a,...c){o=Ne(o),typeof a!="number"&&(a=e.length(n)-o),a=Ne(a);for(const l of c)if(xn(l,e))throw new RangeError("Cannot create a reference to an existing document object");const u=[];for(let l=0;l<a;l++){const h=Se(t,o);h!==void 0&&u.push(h),e.delete(n,o)}const f=c.map(l=>cn(l,i));for(const[l,h]of f){switch(h){case"list":{const d=e.insertObject(n,o,[]);Bt(e,d,i,[...r,o]).splice(0,0,...l);break}case"text":{if(i)un(l),e.insertObject(n,o,l);else{const d=e.insertObject(n,o,"");jt(e,d,[...r,o]).splice(0,0,...l)}break}case"map":{const d=e.insertObject(n,o,{}),y=pt(e,d,i,[...r,o]);for(const _ in l)y[_]=l[_];break}default:e.insert(n,o,l,h)}o+=1}return u},unshift(...o){return this.splice(0,0,...o),e.length(n)},entries(){let o=0;return{next:()=>{const c=Se(t,o);return c===void 0?{value:void 0,done:!0}:{value:[o++,c],done:!1}},[Symbol.iterator](){return this}}},keys(){let o=0;const a=e.length(n);return{next:()=>o<a?{value:o++,done:!1}:{value:void 0,done:!0},[Symbol.iterator](){return this}}},values(){let o=0;return{next:()=>{const c=Se(t,o++);return c===void 0?{value:void 0,done:!0}:{value:c,done:!1}},[Symbol.iterator](){return this}}},toArray(){const o=[];let a;do a=Se(t,o.length),a!==void 0&&o.push(a);while(a!==void 0);return o},map(o){return this.toArray().map(o)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(o){return this.toArray().forEach(o)},concat(o){return this.toArray().concat(o)},every(o){return this.toArray().every(o)},filter(o){return this.toArray().filter(o)},find(o){let a=0;for(const c of this){if(o(c,a))return c;a+=1}},findIndex(o){let a=0;for(const c of this){if(o(c,a))return a;a+=1}return-1},includes(o){return this.find(a=>a===o)!==void 0},join(o){return this.toArray().join(o)},reduce(o,a){return this.toArray().reduce(o,a)},reduceRight(o,a){return this.toArray().reduceRight(o,a)},lastIndexOf(o,a=1/0){return this.toArray().lastIndexOf(o,a)},slice(o,a){return this.toArray().slice(o,a)},some(o){let a=0;for(const c of this){if(o(c,a))return!0;a+=1}return!1},[Symbol.iterator]:function*(){let o=0,a=Se(t,o);for(;a!==void 0;)yield a,o+=1,a=Se(t,o)}}}function Ls(t){const{context:e,objectId:n}=t;return{set(i,s){return this[i]=s},get(i){return this[i]},toString(){return e.text(n).replace(/￼/g,"")},toSpans(){const i=[];let s="";const o=e.length(n);for(let a=0;a<o;a++){const c=this[a];typeof c=="string"?s+=c:(s.length>0&&(i.push(s),s=""),i.push(c))}return s.length>0&&i.push(s),i},toJSON(){return this.toString()},indexOf(i,s=0){return e.text(n).indexOf(i,s)},insertAt(i,...s){s.every(o=>typeof o=="string")?e.splice(n,i,0,s.join("")):lr(t).insertAt(i,...s)}}}function hr(t){if(!(t instanceof Be))throw new Error("value was not a Text instance")}function un(t){if(typeof t!="string")throw new Error("value was not a string")}class Bs{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,hi,{value:!0}),Object.freeze(this)}}class $s{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,li,{value:!0}),Object.freeze(this)}}class zs{constructor(e){if(typeof e!="number")throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Reflect.defineProperty(this,di,{value:!0}),Object.freeze(this)}}function Vs(t){for(const e in t)pe[e]=t[e]}const pe={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function G(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,ze);if(n===void 0||n==null||e&&Ie(t)!=="_root")throw new RangeError("must be the document root");return n}function Hs(t){Reflect.set(t,fr,!0)}function dr(t){return Reflect.get(t,ft)}function Ie(t){return typeof t!="object"||t===null?null:Reflect.get(t,lt)}function je(t){return!!Reflect.get(t,vn)}function Ws(t,e,n){return yi(t,e,n,!0,(r,i)=>new Be(r.text(i)))}function Ks(t,e,n){return yi(t,e,n,!0,(r,i)=>r.text(i))}function yi(t,e,n,r,i){const s=t.getAll(e,n);if(s.length<=1)return;const o={};for(const a of s)switch(a[0]){case"map":o[a[1]]=pt(t,a[1],r,[n]);break;case"list":o[a[1]]=Bt(t,a[1],r,[n]);break;case"text":o[a[1]]=i(t,a[1]);break;case"str":case"uint":case"int":case"f64":case"boolean":case"bytes":case"null":o[a[2]]=a[1];break;case"counter":o[a[2]]=new Lt(a[1]);break;case"timestamp":o[a[2]]=new Date(a[1]);break;default:throw RangeError(`datatype ${a[0]} unimplemented`)}return o}const Js=""+new URL("automerge_wasm_bg-cc6d012d.wasm",import.meta.url).href;let g;const $e=new Array(128).fill(void 0);$e.push(void 0,null,!0,!1);function D(t){return $e[t]}let Rt=$e.length;function Gs(t){t<132||($e[t]=Rt,Rt=t)}function T(t){const e=D(t);return Gs(t),e}const _i=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&_i.decode();let mt=null;function It(){return(mt===null||mt.byteLength===0)&&(mt=new Uint8Array(g.memory.buffer)),mt}function me(t,e){return t=t>>>0,_i.decode(It().subarray(t,t+e))}function S(t){Rt===$e.length&&$e.push($e.length+1);const e=Rt;return Rt=$e[e],$e[e]=t,e}let Ae=0;const Qt=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},qs=typeof Qt.encodeInto=="function"?function(t,e){return Qt.encodeInto(t,e)}:function(t,e){const n=Qt.encode(t);return e.set(n),{read:t.length,written:n.length}};function Le(t,e,n){if(n===void 0){const a=Qt.encode(t),c=e(a.length,1)>>>0;return It().subarray(c,c+a.length).set(a),Ae=a.length,c}let r=t.length,i=e(r,1)>>>0;const s=It();let o=0;for(;o<r;o++){const a=t.charCodeAt(o);if(a>127)break;s[i+o]=a}if(o!==r){o!==0&&(t=t.slice(o)),i=n(i,r,r=o+t.length*3,1)>>>0;const a=It().subarray(i+o,i+r),c=qs(t,a);o+=c.written}return Ae=o,i}function se(t){return t==null}let xt=null;function m(){return(xt===null||xt.byteLength===0)&&(xt=new Int32Array(g.memory.buffer)),xt}let St=null;function Zt(){return(St===null||St.byteLength===0)&&(St=new Float64Array(g.memory.buffer)),St}function Kn(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const i=t.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=t.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(t)){const i=t.length;let s="[";i>0&&(s+=Kn(t[0]));for(let o=1;o<i;o++)s+=", "+Kn(t[o]);return s+="]",s}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function ot(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function Xs(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.create(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return Fe.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Ys(t,e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.load(s,S(t),S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return Fe.__wrap(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Qs(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.encodeChange(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Zs(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.decodeChange(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function eo(){const t=g.initSyncState();return Te.__wrap(t)}function to(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.importSyncState(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return Te.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function no(t){ot(t,Te);const e=g.exportSyncState(t.__wbg_ptr);return T(e)}function ro(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.encodeSyncMessage(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function io(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.decodeSyncMessage(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function so(t){ot(t,Te);const e=g.encodeSyncState(t.__wbg_ptr);return T(e)}function oo(t){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.decodeSyncState(i,S(t));var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return Te.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function ye(t,e){try{return t.apply(this,e)}catch(n){g.__wbindgen_exn_store(S(n))}}function ao(t,e){return t=t>>>0,It().subarray(t/1,t/1+e)}const co=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),Ir=new FinalizationRegistry(t=>g.__wbg_automerge_free(t>>>0));class Fe{static __wrap(e){e=e>>>0;const n=Object.create(Fe.prototype);return n.__wbg_ptr=e,Ir.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ir.unregister(this),e}free(){const e=this.__destroy_into_raw();g.__wbg_automerge_free(e)}static new(e,n){try{const c=g.__wbindgen_add_to_stack_pointer(-16);var r=se(e)?0:Le(e,g.__wbindgen_malloc,g.__wbindgen_realloc),i=Ae;g.automerge_new(c,r,i,n);var s=m()[c/4+0],o=m()[c/4+1],a=m()[c/4+2];if(a)throw T(o);return Fe.__wrap(s)}finally{g.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{const a=g.__wbindgen_add_to_stack_pointer(-16);var n=se(e)?0:Le(e,g.__wbindgen_malloc,g.__wbindgen_realloc),r=Ae;g.automerge_clone(a,this.__wbg_ptr,n,r);var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return Fe.__wrap(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{const c=g.__wbindgen_add_to_stack_pointer(-16);var r=se(e)?0:Le(e,g.__wbindgen_malloc,g.__wbindgen_realloc),i=Ae;g.automerge_fork(c,this.__wbg_ptr,r,i,S(n));var s=m()[c/4+0],o=m()[c/4+1],a=m()[c/4+2];if(a)throw T(o);return Fe.__wrap(s)}finally{g.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const e=g.automerge_pendingOps(this.__wbg_ptr);return T(e)}commit(e,n){var r=se(e)?0:Le(e,g.__wbindgen_malloc,g.__wbindgen_realloc),i=Ae;const s=g.automerge_commit(this.__wbg_ptr,r,i,!se(n),se(n)?0:n);return T(s)}merge(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);ot(e,Fe),g.automerge_merge(s,this.__wbg_ptr,e.__wbg_ptr);var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}rollback(){return g.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_keys(o,this.__wbg_ptr,S(e),se(n)?0:S(n));var r=m()[o/4+0],i=m()[o/4+1],s=m()[o/4+2];if(s)throw T(i);return T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,i;try{const l=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_text(l,this.__wbg_ptr,S(e),se(n)?0:S(n));var s=m()[l/4+0],o=m()[l/4+1],a=m()[l/4+2],c=m()[l/4+3],u=s,f=o;if(c)throw u=0,f=0,T(a);return r=u,i=f,me(u,f)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(r,i,1)}}splice(e,n,r,i){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_splice(a,this.__wbg_ptr,S(e),n,r,S(i));var s=m()[a/4+0],o=m()[a/4+1];if(o)throw T(s)}finally{g.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_push(o,this.__wbg_ptr,S(e),S(n),S(r));var i=m()[o/4+0],s=m()[o/4+1];if(s)throw T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_pushObject(a,this.__wbg_ptr,S(e),S(n));var r=m()[a/4+0],i=m()[a/4+1],s=m()[a/4+2],o=m()[a/4+3];if(o)throw T(s);let c;return r!==0&&(c=me(r,i).slice(),g.__wbindgen_free(r,i*1)),c}finally{g.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,i){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_insert(a,this.__wbg_ptr,S(e),n,S(r),S(i));var s=m()[a/4+0],o=m()[a/4+1];if(o)throw T(s)}finally{g.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{const c=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_insertObject(c,this.__wbg_ptr,S(e),n,S(r));var i=m()[c/4+0],s=m()[c/4+1],o=m()[c/4+2],a=m()[c/4+3];if(a)throw T(o);let u;return i!==0&&(u=me(i,s).slice(),g.__wbindgen_free(i,s*1)),u}finally{g.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,i){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_put(a,this.__wbg_ptr,S(e),S(n),S(r),S(i));var s=m()[a/4+0],o=m()[a/4+1];if(o)throw T(s)}finally{g.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_putObject(a,this.__wbg_ptr,S(e),S(n),S(r));var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_increment(o,this.__wbg_ptr,S(e),S(n),S(r));var i=m()[o/4+0],s=m()[o/4+1];if(s)throw T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_get(a,this.__wbg_ptr,S(e),S(n),se(r)?0:S(r));var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getWithType(a,this.__wbg_ptr,S(e),S(n),se(r)?0:S(r));var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getAll(a,this.__wbg_ptr,S(e),S(n),se(r)?0:S(r));var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_enableFreeze(s,this.__wbg_ptr,S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_registerDatatype(s,this.__wbg_ptr,S(e),S(n));var r=m()[s/4+0],i=m()[s/4+1];if(i)throw T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyPatches(o,this.__wbg_ptr,S(e),S(n));var r=m()[o/4+0],i=m()[o/4+1],s=m()[o/4+2];if(s)throw T(i);return T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyAndReturnPatches(o,this.__wbg_ptr,S(e),S(n));var r=m()[o/4+0],i=m()[o/4+1],s=m()[o/4+2];if(s)throw T(i);return T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}diffIncremental(){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_diffIncremental(i,this.__wbg_ptr);var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}updateDiffCursor(){g.automerge_updateDiffCursor(this.__wbg_ptr)}resetDiffCursor(){g.automerge_resetDiffCursor(this.__wbg_ptr)}diff(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_diff(o,this.__wbg_ptr,S(e),S(n));var r=m()[o/4+0],i=m()[o/4+1],s=m()[o/4+2];if(s)throw T(i);return T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}isolate(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_isolate(i,this.__wbg_ptr,S(e));var n=m()[i/4+0],r=m()[i/4+1];if(r)throw T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}integrate(){g.automerge_integrate(this.__wbg_ptr)}length(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_length(o,this.__wbg_ptr,S(e),se(n)?0:S(n));var r=Zt()[o/8+0],i=m()[o/4+2],s=m()[o/4+3];if(s)throw T(i);return r}finally{g.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_delete(s,this.__wbg_ptr,S(e),S(n));var r=m()[s/4+0],i=m()[s/4+1];if(i)throw T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}save(){const e=g.automerge_save(this.__wbg_ptr);return T(e)}saveIncremental(){const e=g.automerge_saveIncremental(this.__wbg_ptr);return T(e)}saveSince(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_saveSince(s,this.__wbg_ptr,S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}saveNoCompress(){const e=g.automerge_saveNoCompress(this.__wbg_ptr);return T(e)}saveAndVerify(){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_saveAndVerify(i,this.__wbg_ptr);var e=m()[i/4+0],n=m()[i/4+1],r=m()[i/4+2];if(r)throw T(n);return T(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_loadIncremental(s,this.__wbg_ptr,S(e));var n=Zt()[s/8+0],r=m()[s/4+2],i=m()[s/4+3];if(i)throw T(r);return n}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyChanges(i,this.__wbg_ptr,S(e));var n=m()[i/4+0],r=m()[i/4+1];if(r)throw T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getChanges(s,this.__wbg_ptr,S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getChangeByHash(s,this.__wbg_ptr,S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){ot(e,Fe);const n=g.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return T(n)}getHeads(){const e=g.automerge_getHeads(this.__wbg_ptr);return T(e)}getActorId(){let e,n;try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getActorId(s,this.__wbg_ptr);var r=m()[s/4+0],i=m()[s/4+1];return e=r,n=i,me(r,i)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(e,n,1)}}getLastLocalChange(){const e=g.automerge_getLastLocalChange(this.__wbg_ptr);return T(e)}dump(){g.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getMissingDeps(s,this.__wbg_ptr,se(e)?0:S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{const s=g.__wbindgen_add_to_stack_pointer(-16);ot(e,Te),g.automerge_receiveSyncMessage(s,this.__wbg_ptr,e.__wbg_ptr,S(n));var r=m()[s/4+0],i=m()[s/4+1];if(i)throw T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){ot(e,Te);const n=g.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return T(n)}toJS(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_toJS(s,this.__wbg_ptr,S(e));var n=m()[s/4+0],r=m()[s/4+1],i=m()[s/4+2];if(i)throw T(r);return T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_materialize(a,this.__wbg_ptr,S(e),se(n)?0:S(n),S(r));var i=m()[a/4+0],s=m()[a/4+1],o=m()[a/4+2];if(o)throw T(s);return T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getCursor(e,n,r){let i,s;try{const h=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getCursor(h,this.__wbg_ptr,S(e),n,se(r)?0:S(r));var o=m()[h/4+0],a=m()[h/4+1],c=m()[h/4+2],u=m()[h/4+3],f=o,l=a;if(u)throw f=0,l=0,T(c);return i=f,s=l,me(f,l)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(i,s,1)}}getCursorPosition(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getCursorPosition(a,this.__wbg_ptr,S(e),S(n),se(r)?0:S(r));var i=Zt()[a/8+0],s=m()[a/4+2],o=m()[a/4+3];if(o)throw T(s);return i}finally{g.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=se(e)?0:Le(e,g.__wbindgen_malloc,g.__wbindgen_realloc),i=Ae;const s=g.automerge_emptyChange(this.__wbg_ptr,r,i,!se(n),se(n)?0:n);return T(s)}mark(e,n,r,i,s){try{const c=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_mark(c,this.__wbg_ptr,S(e),S(n),S(r),S(i),S(s));var o=m()[c/4+0],a=m()[c/4+1];if(a)throw T(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_unmark(o,this.__wbg_ptr,S(e),S(n),S(r));var i=m()[o/4+0],s=m()[o/4+1];if(s)throw T(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_marks(o,this.__wbg_ptr,S(e),se(n)?0:S(n));var r=m()[o/4+0],i=m()[o/4+1],s=m()[o/4+2];if(s)throw T(i);return T(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}}const Tr=new FinalizationRegistry(t=>g.__wbg_syncstate_free(t>>>0));class Te{static __wrap(e){e=e>>>0;const n=Object.create(Te.prototype);return n.__wbg_ptr=e,Tr.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Tr.unregister(this),e}free(){const e=this.__destroy_into_raw();g.__wbg_syncstate_free(e)}get sharedHeads(){const e=g.syncstate_sharedHeads(this.__wbg_ptr);return T(e)}get lastSentHeads(){const e=g.syncstate_lastSentHeads(this.__wbg_ptr);return T(e)}set lastSentHeads(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.syncstate_set_lastSentHeads(i,this.__wbg_ptr,S(e));var n=m()[i/4+0],r=m()[i/4+1];if(r)throw T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.syncstate_set_sentHashes(i,this.__wbg_ptr,S(e));var n=m()[i/4+0],r=m()[i/4+1];if(r)throw T(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}clone(){const e=g.syncstate_clone(this.__wbg_ptr);return Te.__wrap(e)}}function uo(){const t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){T(e)},t.wbg.__wbindgen_error_new=function(e,n){const r=new Error(me(e,n));return S(r)},t.wbg.__wbindgen_string_get=function(e,n){const r=D(n),i=typeof r=="string"?r:void 0;var s=se(i)?0:Le(i,g.__wbindgen_malloc,g.__wbindgen_realloc),o=Ae;m()[e/4+1]=o,m()[e/4+0]=s},t.wbg.__wbindgen_object_clone_ref=function(e){const n=D(e);return S(n)},t.wbg.__wbindgen_string_new=function(e,n){const r=me(e,n);return S(r)},t.wbg.__wbindgen_number_get=function(e,n){const r=D(n),i=typeof r=="number"?r:void 0;Zt()[e/8+1]=se(i)?0:i,m()[e/4+0]=!se(i)},t.wbg.__wbindgen_is_undefined=function(e){return D(e)===void 0},t.wbg.__wbindgen_boolean_get=function(e){const n=D(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_is_null=function(e){return D(e)===null},t.wbg.__wbindgen_number_new=function(e){return S(e)},t.wbg.__wbindgen_is_function=function(e){return typeof D(e)=="function"},t.wbg.__wbindgen_is_string=function(e){return typeof D(e)=="string"},t.wbg.__wbindgen_json_serialize=function(e,n){const r=D(n),i=JSON.stringify(r===void 0?null:r),s=Le(i,g.__wbindgen_malloc,g.__wbindgen_realloc),o=Ae;m()[e/4+1]=o,m()[e/4+0]=s},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return S(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){const r=D(n).stack,i=Le(r,g.__wbindgen_malloc,g.__wbindgen_realloc),s=Ae;m()[e/4+1]=s,m()[e/4+0]=i},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){let r,i;try{r=e,i=n,console.error(me(e,n))}finally{g.__wbindgen_free(r,i,1)}},t.wbg.__wbindgen_is_object=function(e){const n=D(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return D(e)==D(n)},t.wbg.__wbg_String_91fba7ded13ba54c=function(e,n){const r=String(D(n)),i=Le(r,g.__wbindgen_malloc,g.__wbindgen_realloc),s=Ae;m()[e/4+1]=s,m()[e/4+0]=i},t.wbg.__wbindgen_bigint_from_i64=function(e){return S(e)},t.wbg.__wbindgen_bigint_from_u64=function(e){const n=BigInt.asUintN(64,e);return S(n)},t.wbg.__wbg_set_20cbc34131e76824=function(e,n,r){D(e)[T(n)]=T(r)},t.wbg.__wbg_randomFillSync_6894564c2c334c42=function(){return ye(function(e,n,r){D(e).randomFillSync(ao(n,r))},arguments)},t.wbg.__wbg_getRandomValues_805f1c3d65988a5a=function(){return ye(function(e,n){D(e).getRandomValues(D(n))},arguments)},t.wbg.__wbg_crypto_e1d53a1d73fb10b8=function(e){const n=D(e).crypto;return S(n)},t.wbg.__wbg_process_038c26bf42b093f8=function(e){const n=D(e).process;return S(n)},t.wbg.__wbg_versions_ab37218d2f0b24a8=function(e){const n=D(e).versions;return S(n)},t.wbg.__wbg_node_080f4b19d15bc1fe=function(e){const n=D(e).node;return S(n)},t.wbg.__wbg_msCrypto_6e7d3e1f92610cbb=function(e){const n=D(e).msCrypto;return S(n)},t.wbg.__wbg_require_78a3dcfbdba9cbce=function(){return ye(function(){const e=module.require;return S(e)},arguments)},t.wbg.__wbg_log_4b5638ad60bdc54a=function(e){console.log(D(e))},t.wbg.__wbg_log_89ca282a8a49b121=function(e,n){console.log(D(e),D(n))},t.wbg.__wbg_get_57245cc7d7c7619d=function(e,n){const r=D(e)[n>>>0];return S(r)},t.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return D(e).length},t.wbg.__wbg_new_1d9a920c6bfc44a8=function(){const e=new Array;return S(e)},t.wbg.__wbg_newnoargs_b5b063fc6c2f0376=function(e,n){const r=new Function(me(e,n));return S(r)},t.wbg.__wbg_next_579e583d33566a86=function(e){const n=D(e).next;return S(n)},t.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return ye(function(e){const n=D(e).next();return S(n)},arguments)},t.wbg.__wbg_done_1b73b0672e15f234=function(e){return D(e).done},t.wbg.__wbg_value_1ccc36bc03462d71=function(e){const n=D(e).value;return S(n)},t.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return S(Symbol.iterator)},t.wbg.__wbg_get_765201544a2b6869=function(){return ye(function(e,n){const r=Reflect.get(D(e),D(n));return S(r)},arguments)},t.wbg.__wbg_call_97ae9d8645dc388b=function(){return ye(function(e,n){const r=D(e).call(D(n));return S(r)},arguments)},t.wbg.__wbg_new_0b9bfdd97583284e=function(){const e=new Object;return S(e)},t.wbg.__wbg_length_f2ab5db52e68a619=function(e){return D(e).length},t.wbg.__wbg_set_a68214f35c417fa9=function(e,n,r){D(e)[n>>>0]=T(r)},t.wbg.__wbg_from_7ce3cb27cb258569=function(e){const n=Array.from(D(e));return S(n)},t.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(D(e))},t.wbg.__wbg_push_740e4b286702d964=function(e,n){return D(e).push(D(n))},t.wbg.__wbg_unshift_1bf718f5eb23ad8a=function(e,n){return D(e).unshift(D(n))},t.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let n;try{n=D(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_new_8d2af00bc1e329ee=function(e,n){const r=new Error(me(e,n));return S(r)},t.wbg.__wbg_call_168da88779e35f61=function(){return ye(function(e,n,r){const i=D(e).call(D(n),D(r));return S(i)},arguments)},t.wbg.__wbg_instanceof_Date_b979044f17219415=function(e){let n;try{n=D(e)instanceof Date}catch{n=!1}return n},t.wbg.__wbg_getTime_cb82adb2556ed13e=function(e){return D(e).getTime()},t.wbg.__wbg_new_c8631234f931e1c4=function(e){const n=new Date(D(e));return S(n)},t.wbg.__wbg_instanceof_Object_595a1007518cbea3=function(e){let n;try{n=D(e)instanceof Object}catch{n=!1}return n},t.wbg.__wbg_assign_e3deabdbb7f0913d=function(e,n){const r=Object.assign(D(e),D(n));return S(r)},t.wbg.__wbg_defineProperty_e47dcaf04849e02c=function(e,n,r){const i=Object.defineProperty(D(e),D(n),D(r));return S(i)},t.wbg.__wbg_entries_65a76a413fc91037=function(e){const n=Object.entries(D(e));return S(n)},t.wbg.__wbg_freeze_863b0fb5229a1aa6=function(e){const n=Object.freeze(D(e));return S(n)},t.wbg.__wbg_keys_0702294afaeb6044=function(e){const n=Object.keys(D(e));return S(n)},t.wbg.__wbg_values_f72d246067c121fe=function(e){const n=Object.values(D(e));return S(n)},t.wbg.__wbg_new_bec064441604955e=function(e,n){const r=new RangeError(me(e,n));return S(r)},t.wbg.__wbg_apply_75f7334893eef4ad=function(){return ye(function(e,n,r){const i=Reflect.apply(D(e),D(n),D(r));return S(i)},arguments)},t.wbg.__wbg_deleteProperty_424563545efc9635=function(){return ye(function(e,n){return Reflect.deleteProperty(D(e),D(n))},arguments)},t.wbg.__wbg_ownKeys_bf24e1178641d9f0=function(){return ye(function(e){const n=Reflect.ownKeys(D(e));return S(n)},arguments)},t.wbg.__wbg_set_bf3f89b92d5a34bf=function(){return ye(function(e,n,r){return Reflect.set(D(e),D(n),D(r))},arguments)},t.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const n=D(e).buffer;return S(n)},t.wbg.__wbg_concat_783dc3b16a989c3a=function(e,n){const r=D(e).concat(D(n));return S(r)},t.wbg.__wbg_slice_283900b9d91a5de8=function(e,n,r){const i=D(e).slice(n>>>0,r>>>0);return S(i)},t.wbg.__wbg_for_5dcca67bf52b18ca=function(e,n){const r=Symbol.for(me(e,n));return S(r)},t.wbg.__wbg_toString_1f0448acb8520180=function(e){const n=D(e).toString();return S(n)},t.wbg.__wbg_self_6d479506f72c6a71=function(){return ye(function(){const e=self.self;return S(e)},arguments)},t.wbg.__wbg_window_f2557cc78490aceb=function(){return ye(function(){const e=window.window;return S(e)},arguments)},t.wbg.__wbg_globalThis_7f206bda628d5286=function(){return ye(function(){const e=globalThis.globalThis;return S(e)},arguments)},t.wbg.__wbg_global_ba75c50d1cf384f4=function(){return ye(function(){const e=global.global;return S(e)},arguments)},t.wbg.__wbg_newwithbyteoffsetandlength_d9aa266703cb98be=function(e,n,r){const i=new Uint8Array(D(e),n>>>0,r>>>0);return S(i)},t.wbg.__wbg_new_8c3f0052272a457a=function(e){const n=new Uint8Array(D(e));return S(n)},t.wbg.__wbg_set_83db9690f9353e79=function(e,n,r){D(e).set(D(n),r>>>0)},t.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return D(e).length},t.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let n;try{n=D(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_newwithlength_f5933855e4f48a19=function(e){const n=new Uint8Array(e>>>0);return S(n)},t.wbg.__wbg_subarray_58ad4efbb5bcb886=function(e,n,r){const i=D(e).subarray(n>>>0,r>>>0);return S(i)},t.wbg.__wbindgen_debug_string=function(e,n){const r=Kn(D(n)),i=Le(r,g.__wbindgen_malloc,g.__wbindgen_realloc),s=Ae;m()[e/4+1]=s,m()[e/4+0]=i},t.wbg.__wbindgen_throw=function(e,n){throw new Error(me(e,n))},t.wbg.__wbindgen_memory=function(){const e=g.memory;return S(e)},t}function fo(t,e){return g=t.exports,St=null,xt=null,mt=null,g}function bi(t){if(g!==void 0)return g;const e=uo();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));const n=new WebAssembly.Instance(t,e);return fo(n)}const lo=new Promise(t=>{fetch(Js).then(e=>{e.arrayBuffer().then(n=>{bi(n),t()})})}),ho=Object.freeze(Object.defineProperty({__proto__:null,Automerge:Fe,SyncState:Te,TextRepresentation:co,create:Xs,decodeChange:Zs,decodeSyncMessage:io,decodeSyncState:oo,encodeChange:Qs,encodeSyncMessage:ro,encodeSyncState:so,exportSyncState:no,importSyncState:to,initSync:bi,initSyncState:eo,load:Ys,promise:lo},Symbol.toStringTag,{value:"Module"}));var go=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function po(t,e,...n){if(!je(t))throw new RangeError("object cannot be modified outside of a change block");t.insertAt(e,...n)}function yo(t,e,n){if(!je(t))throw new RangeError("object cannot be modified outside of a change block");t.deleteAt(e,n)}function _o(t){Vs(t)}_o(ho);function bo(t){return G(t).handle}function gr(t){return typeof t=="object"?t:{actor:t}}function Sn(t){const e=gr(t),n=!!e.freeze,r=e.patchCallback,i=!e.enableTextV2,s=e.actor,o=pe.create({actor:s,text_v1:i});o.enableFreeze(!!e.freeze),o.registerDatatype("counter",u=>new Lt(u));const a=e.enableTextV2||!1;return a?o.registerDatatype("str",u=>new mn(u)):o.registerDatatype("text",u=>new Be(u)),o.materialize("/",void 0,{handle:o,heads:void 0,freeze:n,patchCallback:r,textV2:a})}function wo(t,e){const n=G(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function vo(t,e){const n=G(t),r=n.heads,i=gr(e),s=n.handle.fork(i.actor,r);s.updateDiffCursor();const o=go(n,["heads"]);return o.patchCallback=i.patchCallback,s.applyPatches(t,Object.assign(Object.assign({},o),{handle:s}))}function mo(t){return G(t).handle.free()}function xo(t,e){return Ut(Sn(e),"from",{},n=>Object.assign(n,t)).newDoc}function wi(t,e,n){if(typeof e=="function")return Ut(t,"change",{},e).newDoc;if(typeof n=="function")return typeof e=="string"&&(e={message:e}),Ut(t,"change",e,n).newDoc;throw RangeError("Invalid args for change")}function vi(t,e,n,r){if(typeof n=="function")return Ut(t,"changeAt",{},n,e);if(typeof r=="function")return typeof n=="string"&&(n={message:n}),Ut(t,"changeAt",n,r,e);throw RangeError("Invalid args for changeAt")}function yt(t,e,n,r){if(n==null)return t;const i=G(t),s=Object.assign(Object.assign({},i),{heads:void 0}),{value:o,patches:a}=i.handle.applyAndReturnPatches(t,s);if(a.length>0){r?.(a,{before:t,after:o,source:e});const c=G(o);c.mostRecentPatch={before:G(t).heads,after:c.handle.getHeads(),patches:a,source:e}}return i.heads=n,o}function Ut(t,e,n,r,i){if(typeof r!="function")throw new RangeError("invalid change function");const s=G(t);if(t===void 0||s===void 0)throw new RangeError("must be the document root");if(s.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");let o=s.handle.getHeads();i&&Ro(i,o)&&(i=void 0),i&&(s.handle.isolate(i),o=i);try{s.heads=o;const a=Ns(s.handle,s.textV2);if(r(a),s.handle.pendingOps()===0)return s.heads=void 0,i&&s.handle.integrate(),{newDoc:t,newHeads:null};{const c=s.handle.commit(n.message,n.time);return s.handle.integrate(),{newDoc:yt(t,e,o,n.patchCallback||s.patchCallback),newHeads:c!=null?[c]:null}}}catch(a){throw s.heads=void 0,s.handle.rollback(),a}}function mi(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e});const n=G(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),yt(t,"emptyChange",r)}function So(t,e){const n=gr(e),r=n.actor,i=n.patchCallback,s=!n.enableTextV2,o=n.unchecked||!1,a=n.allowMissingChanges||!1,c=n.convertRawStringsToText||!1,u=pe.load(t,{text_v1:s,actor:r,unchecked:o,allowMissingDeps:a,convertRawStringsToText:c});u.enableFreeze(!!n.freeze),u.registerDatatype("counter",h=>new Lt(h));const f=n.enableTextV2||!1;return f?u.registerDatatype("str",h=>new mn(h)):u.registerDatatype("text",h=>new Be(h)),u.materialize("/",void 0,{handle:u,heads:void 0,patchCallback:i,textV2:f})}function pr(t,e,n){n||(n={});const r=G(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+dr(t));if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.loadIncremental(e),yt(t,"loadIncremental",i,n.patchCallback||r.patchCallback)}function Eo(t){const e=G(t);if(e.heads)throw new RangeError("Attempting to change an out of date document - set at: "+dr(t));if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");return e.handle.saveIncremental()}function xi(t){return G(t).handle.save()}function Si(t,e){const n=G(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+dr(t));const r=n.handle.getHeads(),i=G(e),s=n.handle.getChangesAdded(i.handle);return n.handle.applyChanges(s),yt(t,"merge",r,n.patchCallback)}function Ao(t){return G(t).handle.getActorId()}function gu(t,e){const n=G(t,!1);if(n.textV2)throw new Error("use unstable.getConflicts for an unstable document");const r=Ie(t);if(r!=null)return Ws(n.handle,r,e)}function ko(t){return G(t).handle.getLastLocalChange()||void 0}function Ei(t,e){if(e){const n=G(t,!1),r=Ie(t);return!n||!r?null:n.handle.get(r,e)}else return Ie(t)}function Co(t,e){return G(e).handle.getChanges(ke(t))}function Ai(t){return G(t).handle.getChanges([])}function ki(t,e,n){const r=G(t);if(n||(n={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.applyChanges(e),r.heads=i,[yt(t,"applyChanges",i,n.patchCallback||r.patchCallback)]}function Oo(t){const e=G(t).textV2,n=Ai(t);return n.map((r,i)=>({get change(){return Ui(r)},get snapshot(){const[s]=ki(Sn({enableTextV2:e}),n.slice(0,i+1));return s}}))}function Ci(t,e,n){jr(e,"before"),jr(n,"after");const r=G(t);return r.mostRecentPatch&&fn(r.mostRecentPatch.before,e)&&fn(r.mostRecentPatch.after,n)?r.mostRecentPatch.patches:r.handle.diff(e,n)}function Ro(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function jr(t,e){if(!Array.isArray(t))throw new Error(`${e} must be an array`)}function fn(t,e){if(!Ur(t)||!Ur(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i]!==r[i]||!fn(t[n[i]],e[r[i]]))return!1;return!0}function Oi(t){const e=pe.importSyncState(t),n=pe.encodeSyncState(e);return e.free(),n}function Ri(t){const e=pe.decodeSyncState(t),n=pe.exportSyncState(e);return e.free(),n}function Ii(t,e){const n=G(t),r=pe.importSyncState(e),i=n.handle.generateSyncMessage(r);return[pe.exportSyncState(r),i]}function Ti(t,e,n,r){const i=pe.importSyncState(e);r||(r={});const s=G(t);if(s.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(je(t))throw new RangeError("Calls to Automerge.change cannot be nested");const o=s.handle.getHeads();s.handle.receiveSyncMessage(i,n);const a=pe.exportSyncState(i);return[yt(t,"receiveSyncMessage",o,r.patchCallback||s.patchCallback),a,null]}function ji(){return pe.exportSyncState(pe.initSyncState())}function Io(t){return pe.encodeChange(t)}function Ui(t){return pe.decodeChange(t)}function To(t){return pe.encodeSyncMessage(t)}function Di(t){return pe.decodeSyncMessage(t)}function jo(t,e){return G(t).handle.getMissingDeps(e)}function ke(t){const e=G(t);return e.heads||e.handle.getHeads()}function Uo(t){G(t).handle.dump()}function Do(t){const e=G(t),n=e.handle.enableFreeze(!1),r=e.handle.materialize();return e.handle.enableFreeze(n),r}function Mo(t){return typeof t=="object"&&t!==null?Ei(t)==="_root"&&!!Reflect.get(t,ze):!1}function Ur(t){return typeof t=="object"&&t!==null}function Mi(t,e){return G(t).handle.saveSince(e)}const Po=bo;function En(t){const e=An(t);return e.enableTextV2=!0,Sn(e)}function Pi(t,e){const n=An(e);return n.enableTextV2=!0,vo(t,n)}function Fo(t,e){const n=An(e);return n.enableTextV2=!0,xo(t,n)}function No(t,e){const n=An(e);return n.enableTextV2=!0,n.patchCallback?pr(Sn(n),t):So(t,n)}function An(t){return typeof t=="object"?t:{actor:t}}function Lo(t,e,n){if(typeof n=="string"){if(/^[0-9]+@[0-9a-zA-z]+$/.test(n))return t.handle.getCursorPosition(e,n);throw new RangeError("index must be a number or cursor")}else return n}function Bo(t,e,n,r,i){if(!je(t))throw new RangeError("object cannot be modified outside of a change block");const s=G(t,!1),o=Ie(t);if(!o)throw new RangeError("invalid object for splice");Hs(t),e.unshift(o);const a=e.join("/");n=Lo(s,a,n);try{return s.handle.splice(a,n,r,i)}catch(c){throw new RangeError(`Cannot splice: ${c}`)}}function $o(t,e,n){const r=G(t,!1),i=Ie(t);if(!i)throw new RangeError("invalid object for getCursor");e.unshift(i);const s=e.join("/");try{return r.handle.getCursor(s,n)}catch(o){throw new RangeError(`Cannot getCursor: ${o}`)}}function zo(t,e,n){const r=G(t,!1),i=Ie(t);if(!i)throw new RangeError("invalid object for getCursorPosition");e.unshift(i);const s=e.join("/");try{return r.handle.getCursorPosition(s,n)}catch(o){throw new RangeError(`Cannot getCursorPosition: ${o}`)}}function Vo(t,e,n,r,i){if(!je(t))throw new RangeError("object cannot be modified outside of a change block");const s=G(t,!1),o=Ie(t);if(!o)throw new RangeError("invalid object for mark");e.unshift(o);const a=e.join("/");try{return s.handle.mark(a,n,r,i)}catch(c){throw new RangeError(`Cannot mark: ${c}`)}}function Ho(t,e,n,r){if(!je(t))throw new RangeError("object cannot be modified outside of a change block");const i=G(t,!1),s=Ie(t);if(!s)throw new RangeError("invalid object for unmark");e.unshift(s);const o=e.join("/");try{return i.handle.unmark(o,n,r)}catch(a){throw new RangeError(`Cannot unmark: ${a}`)}}function Wo(t,e){const n=G(t,!1),r=Ie(t);if(!r)throw new RangeError("invalid object for unmark");e.unshift(r);const i=e.join("/");try{return n.handle.marks(i)}catch(s){throw new RangeError(`Cannot call marks(): ${s}`)}}function Ko(t,e){const n=G(t,!1);if(!n.textV2)throw new Error("use getConflicts for a stable document");const r=Ie(t);if(r!=null)return Ks(n.handle,r,e)}const pu=Object.freeze(Object.defineProperty({__proto__:null,Counter:Lt,Float64:zs,Int:Bs,RawString:mn,Uint:$s,applyChanges:ki,change:wi,changeAt:vi,clone:Pi,decodeChange:Ui,decodeSyncMessage:Di,decodeSyncState:Ri,deleteAt:yo,diff:Ci,dump:Uo,emptyChange:mi,encodeChange:Io,encodeSyncMessage:To,encodeSyncState:Oi,equals:fn,free:mo,from:Fo,generateSyncMessage:Ii,getActorId:Ao,getAllChanges:Ai,getBackend:Po,getChanges:Co,getConflicts:Ko,getCursor:$o,getCursorPosition:zo,getHeads:ke,getHistory:Oo,getLastLocalChange:ko,getMissingDeps:jo,getObjectId:Ei,init:En,initSyncState:ji,insertAt:po,isAutomerge:Mo,load:No,loadIncremental:pr,mark:Vo,marks:Wo,merge:Si,receiveSyncMessage:Ti,save:xi,saveIncremental:Eo,saveSince:Mi,splice:Bo,toJS:Do,unmark:Ho,view:wo},Symbol.toStringTag,{value:"Module"}));var Jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jn={exports:{}},jn,Dr;function Go(){if(Dr)return jn;Dr=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,s=r*365.25;jn=function(f,l){l=l||{};var h=typeof f;if(h==="string"&&f.length>0)return o(f);if(h==="number"&&isFinite(f))return l.long?c(f):a(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function o(f){if(f=String(f),!(f.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(l){var h=parseFloat(l[1]),d=(l[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return h*s;case"weeks":case"week":case"w":return h*i;case"days":case"day":case"d":return h*r;case"hours":case"hour":case"hrs":case"hr":case"h":return h*n;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function a(f){var l=Math.abs(f);return l>=r?Math.round(f/r)+"d":l>=n?Math.round(f/n)+"h":l>=e?Math.round(f/e)+"m":l>=t?Math.round(f/t)+"s":f+"ms"}function c(f){var l=Math.abs(f);return l>=r?u(f,l,r,"day"):l>=n?u(f,l,n,"hour"):l>=e?u(f,l,e,"minute"):l>=t?u(f,l,t,"second"):f+" ms"}function u(f,l,h,d){var y=l>=h*1.5;return Math.round(f/h)+" "+d+(y?"s":"")}return jn}function qo(t){n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=i,n.enabled=o,n.humanize=Go(),n.destroy=u,Object.keys(t).forEach(f=>{n[f]=t[f]}),n.names=[],n.skips=[],n.formatters={};function e(f){let l=0;for(let h=0;h<f.length;h++)l=(l<<5)-l+f.charCodeAt(h),l|=0;return n.colors[Math.abs(l)%n.colors.length]}n.selectColor=e;function n(f){let l,h=null,d,y;function _(...x){if(!_.enabled)return;const A=_,k=Number(new Date),w=k-(l||k);A.diff=w,A.prev=l,A.curr=k,l=k,x[0]=n.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let P=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(E,I)=>{if(E==="%%")return"%";P++;const U=n.formatters[I];if(typeof U=="function"){const M=x[P];E=U.call(A,M),x.splice(P,1),P--}return E}),n.formatArgs.call(A,x),(A.log||n.log).apply(A,x)}return _.namespace=f,_.useColors=n.useColors(),_.color=n.selectColor(f),_.extend=r,_.destroy=n.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(d!==n.namespaces&&(d=n.namespaces,y=n.enabled(f)),y),set:x=>{h=x}}),typeof n.init=="function"&&n.init(_),_}function r(f,l){const h=n(this.namespace+(typeof l>"u"?":":l)+f);return h.log=this.log,h}function i(f){n.save(f),n.namespaces=f,n.names=[],n.skips=[];let l;const h=(typeof f=="string"?f:"").split(/[\s,]+/),d=h.length;for(l=0;l<d;l++)h[l]&&(f=h[l].replace(/\*/g,".*?"),f[0]==="-"?n.skips.push(new RegExp("^"+f.slice(1)+"$")):n.names.push(new RegExp("^"+f+"$")))}function s(){const f=[...n.names.map(a),...n.skips.map(a).map(l=>"-"+l)].join(",");return n.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let l,h;for(l=0,h=n.skips.length;l<h;l++)if(n.skips[l].test(f))return!1;for(l=0,h=n.names.length;l<h;l++)if(n.names[l].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Xo=qo;(function(t,e){e.formatArgs=r,e.save=i,e.load=s,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let f=0,l=0;c[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(f++,h==="%c"&&(l=f))}),c.splice(l,0,u)}e.log=console.debug||console.log||(()=>{});function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function s(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=Xo(e);const{formatters:a}=t.exports;a.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Jn,Jn.exports);var Yo=Jn.exports;const Ye=yr(Yo);var Fi={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function s(c,u,f,l,h){if(typeof f!="function")throw new TypeError("The listener must be a function");var d=new i(f,l||c,h),y=n?n+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],d]:c._events[y].push(d):(c._events[y]=d,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],f,l;if(this._eventsCount===0)return u;for(l in f=this._events)e.call(f,l)&&u.push(n?l.slice(1):l);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},a.prototype.listeners=function(u){var f=n?n+u:u,l=this._events[f];if(!l)return[];if(l.fn)return[l.fn];for(var h=0,d=l.length,y=new Array(d);h<d;h++)y[h]=l[h].fn;return y},a.prototype.listenerCount=function(u){var f=n?n+u:u,l=this._events[f];return l?l.fn?1:l.length:0},a.prototype.emit=function(u,f,l,h,d,y){var _=n?n+u:u;if(!this._events[_])return!1;var x=this._events[_],A=arguments.length,k,w;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),A){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,f),!0;case 3:return x.fn.call(x.context,f,l),!0;case 4:return x.fn.call(x.context,f,l,h),!0;case 5:return x.fn.call(x.context,f,l,h,d),!0;case 6:return x.fn.call(x.context,f,l,h,d,y),!0}for(w=1,k=new Array(A-1);w<A;w++)k[w-1]=arguments[w];x.fn.apply(x.context,k)}else{var P=x.length,L;for(w=0;w<P;w++)switch(x[w].once&&this.removeListener(u,x[w].fn,void 0,!0),A){case 1:x[w].fn.call(x[w].context);break;case 2:x[w].fn.call(x[w].context,f);break;case 3:x[w].fn.call(x[w].context,f,l);break;case 4:x[w].fn.call(x[w].context,f,l,h);break;default:if(!k)for(L=1,k=new Array(A-1);L<A;L++)k[L-1]=arguments[L];x[w].fn.apply(x[w].context,k)}}return!0},a.prototype.on=function(u,f,l){return s(this,u,f,l,!1)},a.prototype.once=function(u,f,l){return s(this,u,f,l,!0)},a.prototype.removeListener=function(u,f,l,h){var d=n?n+u:u;if(!this._events[d])return this;if(!f)return o(this,d),this;var y=this._events[d];if(y.fn)y.fn===f&&(!h||y.once)&&(!l||y.context===l)&&o(this,d);else{for(var _=0,x=[],A=y.length;_<A;_++)(y[_].fn!==f||h&&!y[_].once||l&&y[_].context!==l)&&x.push(y[_]);x.length?this._events[d]=x.length===1?x[0]:x:o(this,d)}return this},a.prototype.removeAllListeners=function(u){var f;return u?(f=n?n+u:u,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(Fi);var Qo=Fi.exports;const Qe=yr(Qo);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var N=function(){return N=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},N.apply(this,arguments)};function _r(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Q(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Z(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function re(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var ne;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(ne||(ne={}));var ht;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(ht||(ht={}));var Gn=ne.Start,br=ne.Stop,$t=ne.Raise,kn=ne.Send,Ni=ne.Cancel,Zo=ne.NullEvent,wr=ne.Assign;ne.After;ne.DoneState;var Li=ne.Log,ea=ne.Init,qn=ne.Invoke;ne.ErrorExecution;var Mr=ne.ErrorPlatform,ta=ne.ErrorCustom,Bi=ne.Update,na=ne.Choose,ra=ne.Pure,$i=".",Pr={},Xn="xstate.guard",ia="",Wt;function vr(t,e,n){n===void 0&&(n=$i);var r=Tt(t,n),i=Tt(e,n);return te(i)?te(r)?i===r:!1:te(r)?r in i:Object.keys(r).every(function(s){return s in i?vr(r[s],i[s]):!1})}function zi(t){try{return te(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function Yn(t,e){try{return _t(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function sa(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function Tt(t,e){if(sa(t))return t.value;if(_t(t))return ln(t);if(typeof t!="string")return t;var n=Yn(t,e);return ln(n)}function ln(t){if(t.length===1)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)r===t.length-2?n[t[r]]=t[r+1]:(n[t[r]]={},n=n[t[r]]);return e}function Et(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++){var s=r[i];n[s]=e(t[s],s,t,i)}return n}function Fr(t,e,n){var r,i,s={};try{for(var o=Q(Object.keys(t)),a=o.next();!a.done;a=o.next()){var c=a.value,u=t[c];n(u)&&(s[c]=e(u,c,t))}}catch(f){r={error:f}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}var oa=function(t){return function(e){var n,r,i=e;try{for(var s=Q(t),o=s.next();!o.done;o=s.next()){var a=o.value;i=i[a]}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}};function aa(t,e){return function(n){var r,i,s=n;try{for(var o=Q(t),a=o.next();!a.done;a=o.next()){var c=a.value;s=s[e][c]}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}}function en(t){if(!t)return[[]];if(te(t))return[[t]];var e=oe(Object.keys(t).map(function(n){var r=t[n];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[n]]:en(t[n]).map(function(i){return[n].concat(i)})}));return e}function oe(t){var e;return(e=[]).concat.apply(e,re([],Z(t),!1))}function Vi(t){return _t(t)?t:[t]}function Oe(t){return t===void 0?[]:Vi(t)}function hn(t,e,n){var r,i;if(ee(t))return t(e,n.data);var s={};try{for(var o=Q(Object.keys(t)),a=o.next();!a.done;a=o.next()){var c=a.value,u=t[c];ee(u)?s[c]=u(e,n.data):s[c]=u}}catch(f){r={error:f}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function ca(t){return/^(done|error)\./.test(t)}function Nr(t){return!!(t instanceof Promise||t!==null&&(ee(t)||typeof t=="object")&&ee(t.then))}function ua(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function fa(t,e){var n,r,i=Z([[],[]],2),s=i[0],o=i[1];try{for(var a=Q(t),c=a.next();!c.done;c=a.next()){var u=c.value;e(u)?s.push(u):o.push(u)}}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return[s,o]}function Hi(t,e){return Et(t.states,function(n,r){if(n){var i=(te(e)?void 0:e[r])||(n?n.current:void 0);if(i)return{current:i,states:Hi(n,i)}}})}function la(t,e){return{current:e,states:Hi(t,e)}}function Lr(t,e,n,r){var i=t&&n.reduce(function(s,o){var a,c,u=o.assignment,f={state:r,action:o,_event:e},l={};if(ee(u))l=u(s,e.data,f);else try{for(var h=Q(Object.keys(u)),d=h.next();!d.done;d=h.next()){var y=d.value,_=u[y];l[y]=ee(_)?_(s,e.data,f):_}}catch(x){a={error:x}}finally{try{d&&!d.done&&(c=h.return)&&c.call(h)}finally{if(a)throw a.error}}return Object.assign({},s,l)},t);return i}var ha=function(){};function _t(t){return Array.isArray(t)}function ee(t){return typeof t=="function"}function te(t){return typeof t=="string"}function Wi(t,e){if(t)return te(t)?{type:Xn,name:t,predicate:e?e[t]:void 0}:ee(t)?{type:Xn,name:t.name,predicate:t}:t}function da(t){try{return"subscribe"in t&&ee(t.subscribe)}catch{return!1}}var Ke=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();Wt={},Wt[Ke]=function(){return this},Wt[Symbol.observable]=function(){return this};function dt(t){return!!t&&"__xstatenode"in t}function ga(t){return!!t&&typeof t.send=="function"}function Cn(t,e){return te(t)||typeof t=="number"?N({type:t},e):t}function ge(t,e){if(!te(t)&&"$$type"in t&&t.$$type==="scxml")return t;var n=Cn(t);return N({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function et(t,e){var n=Vi(e).map(function(r){return typeof r>"u"||typeof r=="string"||dt(r)?{target:r,event:t}:N(N({},r),{event:t})});return n}function pa(t){if(!(t===void 0||t===ia))return Oe(t)}function Ki(t,e,n,r,i){var s=t.options.guards,o={state:i,cond:e,_event:r};if(e.type===Xn)return(s?.[e.name]||e.predicate)(n,r.data,o);var a=s?.[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return a(n,r.data,o)}function Ji(t){return typeof t=="string"?{type:t}:t}function tn(t,e,n){var r=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||r).bind(s),error:((i?t.error:e)||r).bind(s),complete:((i?t.complete:n)||r).bind(s)}}function Kt(t,e){return"".concat(t,":invocation[").concat(e,"]")}function Qn(t){return(t.type===$t||t.type===kn&&t.to===ht.Internal)&&typeof t.delay!="number"}var ut=ge({type:ea});function Zn(t,e){return e&&e[t]||void 0}function Dt(t,e){var n;if(te(t)||typeof t=="number"){var r=Zn(t,e);ee(r)?n={type:t,exec:r}:r?n=r:n={type:t,exec:void 0}}else if(ee(t))n={type:t.name||t.toString(),exec:t};else{var r=Zn(t.type,e);if(ee(r))n=N(N({},t),{exec:r});else if(r){var i=r.type||t.type;n=N(N(N({},r),t),{type:i})}else n=t}return n}var Je=function(t,e){if(!t)return[];var n=_t(t)?t:[t];return n.map(function(r){return Dt(r,e)})};function mr(t){var e=Dt(t);return N(N({id:te(t)?t:e.id},e),{type:e.type})}function ya(t,e){return{type:$t,event:typeof t=="function"?t:Cn(t),delay:e?e.delay:void 0,id:e?.id}}function _a(t,e,n,r){var i={_event:n},s=ge(ee(t.event)?t.event(e,n.data,i):t.event),o;if(te(t.delay)){var a=r&&r[t.delay];o=ee(a)?a(e,n.data,i):a}else o=ee(t.delay)?t.delay(e,n.data,i):t.delay;return N(N({},t),{type:$t,_event:s,delay:o})}function ba(t,e){return{to:e?e.to:void 0,type:kn,event:ee(t)?t:Cn(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:ee(t)?t.name:zi(t)}}function wa(t,e,n,r){var i={_event:n},s=ge(ee(t.event)?t.event(e,n.data,i):t.event),o;if(te(t.delay)){var a=r&&r[t.delay];o=ee(a)?a(e,n.data,i):a}else o=ee(t.delay)?t.delay(e,n.data,i):t.delay;var c=ee(t.to)?t.to(e,n.data,i):t.to;return N(N({},t),{to:c,_event:s,event:s.data,delay:o})}var va=function(t,e,n){return N(N({},t),{value:te(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})},ma=function(t){return{type:Ni,sendId:t}};function xa(t){var e=mr(t);return{type:ne.Start,activity:e,exec:void 0}}function Sa(t){var e=ee(t)?t:mr(t);return{type:ne.Stop,activity:e,exec:void 0}}function Ea(t,e,n){var r=ee(t.activity)?t.activity(e,n.data):t.activity,i=typeof r=="string"?{id:r}:r,s={type:ne.Stop,activity:i};return s}var Aa=function(t){return{type:wr,assignment:t}};function ka(t,e){var n=e?"#".concat(e):"";return"".concat(ne.After,"(").concat(t,")").concat(n)}function Jt(t,e){var n="".concat(ne.DoneState,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function nn(t,e){var n="".concat(ne.DoneInvoke,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function At(t,e){var n="".concat(ne.ErrorPlatform,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}var Ca=function(t){var e,n,r=[];try{for(var i=Q(t),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.actions.length;){if(o.actions[a].type===wr){r.push(o.actions[a]),o.actions.splice(a,1);continue}a++}}catch(c){e={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r};function dn(t,e,n,r,i,s,o){o===void 0&&(o=!1);var a=o?[]:Ca(i),c=a.length?Lr(n,r,a,e):n,u=o?[n]:void 0,f=[];function l(y,_){var x;switch(_.type){case $t:{var A=_a(_,c,r,t.options.delays);return s&&typeof A.delay=="number"&&s(A,c,r),A}case kn:var k=wa(_,c,r,t.options.delays);return s&&k.to!==ht.Internal&&(y==="entry"?f.push(k):s(k,c,r)),k;case Li:{var w=va(_,c,r);return s?.(w,c,r),w}case na:{var P=_,L=(x=P.conds.find(function(j){var O=Wi(j.cond,t.options.guards);return!O||Ki(t,O,c,r,s?void 0:e)}))===null||x===void 0?void 0:x.actions;if(!L)return[];var E=Z(dn(t,e,c,r,[{type:y,actions:Je(Oe(L),t.options.actions)}],s,o),2),I=E[0],U=E[1];return c=U,u?.push(c),I}case ra:{var L=_.get(c,r.data);if(!L)return[];var M=Z(dn(t,e,c,r,[{type:y,actions:Je(Oe(L),t.options.actions)}],s,o),2),$=M[0],z=M[1];return c=z,u?.push(c),$}case br:{var w=Ea(_,c,r);return s?.(w,n,r),w}case wr:{c=Lr(c,r,[_],s?void 0:e),u?.push(c);break}default:var K=Dt(_,t.options.actions),b=K.exec;if(s)s(K,c,r);else if(b&&u){var F=u.length-1,R=N(N({},K),{exec:function(j){for(var O=[],V=1;V<arguments.length;V++)O[V-1]=arguments[V];b.apply(void 0,re([u[F]],Z(O),!1))}});K=R}return K}}function h(y){var _,x,A=[];try{for(var k=Q(y.actions),w=k.next();!w.done;w=k.next()){var P=w.value,L=l(y.type,P);L&&(A=A.concat(L))}}catch(E){_={error:E}}finally{try{w&&!w.done&&(x=k.return)&&x.call(k)}finally{if(_)throw _.error}}return f.forEach(function(E){s(E,c,r)}),f.length=0,A}var d=oe(i.map(h));return[d,c]}var Br=[],st=function(t,e){Br.push(t);var n=e(t);return Br.pop(),n};function Gi(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[Ke]=function(){return this},e}function Oa(t,e,n,r){var i,s=Ji(t.src),o=(i=e?.options.services)===null||i===void 0?void 0:i[s.type],a=t.data?hn(t.data,n,r):void 0,c=o?qi(o,t.id,a):Gi(t.id);return c.meta=t,c}function qi(t,e,n){var r=Gi(e);if(r.deferred=!0,dt(t)){var i=r.state=st(void 0,function(){return(n?t.withContext(n):t).initialState});r.getSnapshot=function(){return i}}return r}function Ra(t){try{return typeof t.send=="function"}catch{return!1}}function Ia(t){return Ra(t)&&"id"in t}function Ta(t){var e;return N((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[Ke]=function(){return this},e),t)}var gn=function(t){return t.type==="atomic"||t.type==="final"};function Xi(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function Mt(t){return Xi(t).filter(function(e){return e.type!=="history"})}function Yi(t){var e=[t];return gn(t)?e:e.concat(oe(Mt(t).map(Yi)))}function kt(t,e){var n,r,i,s,o,a,c,u,f=new Set(t),l=er(f),h=new Set(e);try{for(var d=Q(h),y=d.next();!y.done;y=d.next())for(var _=y.value,x=_.parent;x&&!h.has(x);)h.add(x),x=x.parent}catch(M){n={error:M}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var A=er(h);try{for(var k=Q(h),w=k.next();!w.done;w=k.next()){var _=w.value;if(_.type==="compound"&&(!A.get(_)||!A.get(_).length))l.get(_)?l.get(_).forEach(function($){return h.add($)}):_.initialStateNodes.forEach(function($){return h.add($)});else if(_.type==="parallel")try{for(var P=(o=void 0,Q(Mt(_))),L=P.next();!L.done;L=P.next()){var E=L.value;h.has(E)||(h.add(E),l.get(E)?l.get(E).forEach(function($){return h.add($)}):E.initialStateNodes.forEach(function($){return h.add($)}))}}catch($){o={error:$}}finally{try{L&&!L.done&&(a=P.return)&&a.call(P)}finally{if(o)throw o.error}}}}catch(M){i={error:M}}finally{try{w&&!w.done&&(s=k.return)&&s.call(k)}finally{if(i)throw i.error}}try{for(var I=Q(h),U=I.next();!U.done;U=I.next())for(var _=U.value,x=_.parent;x&&!h.has(x);)h.add(x),x=x.parent}catch(M){c={error:M}}finally{try{U&&!U.done&&(u=I.return)&&u.call(I)}finally{if(c)throw c.error}}return h}function Qi(t,e){var n=e.get(t);if(!n)return{};if(t.type==="compound"){var r=n[0];if(r){if(gn(r))return r.key}else return{}}var i={};return n.forEach(function(s){i[s.key]=Qi(s,e)}),i}function er(t){var e,n,r=new Map;try{for(var i=Q(t),s=i.next();!s.done;s=i.next()){var o=s.value;r.has(o)||r.set(o,[]),o.parent&&(r.has(o.parent)||r.set(o.parent,[]),r.get(o.parent).push(o))}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function ja(t,e){var n=kt([t],e);return Qi(t,er(n))}function Ct(t,e){return Array.isArray(t)?t.some(function(n){return n===e}):t instanceof Set?t.has(e):!1}function Ua(t){return re([],Z(new Set(oe(re([],Z(t.map(function(e){return e.ownEvents})),!1)))),!1)}function rn(t,e){return e.type==="compound"?Mt(e).some(function(n){return n.type==="final"&&Ct(t,n)}):e.type==="parallel"?Mt(e).every(function(n){return rn(t,n)}):!1}function Da(t){return t===void 0&&(t=[]),t.reduce(function(e,n){return n.meta!==void 0&&(e[n.id]=n.meta),e},{})}function $r(t){return new Set(oe(t.map(function(e){return e.tags})))}function Zi(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(te(t)||te(e))return t===e;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(function(i){return Zi(t[i],e[i])})}function Ma(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function Pa(t,e){var n=t.exec,r=N(N({},t),{exec:n!==void 0?function(){return n(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return r}var De=function(){function t(e){var n=this,r;this.actions=[],this.activities=Pr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Pr,this.meta=Da(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Ua(n.configuration)}})}return t.from=function(e,n){if(e instanceof t)return e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=ut;return new t({value:e,context:n,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var r=ut;return new t({value:e.value,context:n,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(e,n){var r=this;if(e===void 0&&(e=this.value),n===void 0&&(n="."),te(e))return[e];var i=Object.keys(e);return i.concat.apply(i,re([],Z(i.map(function(s){return r.toStrings(e[s],n).map(function(o){return s+n+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var n=e.tags;e.machine;var r=_r(e,["configuration","transitions","tags","machine"]);return N(N({},r),{tags:Array.from(n)})},t.prototype.matches=function(e){return vr(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var n;ha(!!this.machine);var r=(n=this.machine)===null||n===void 0?void 0:n.getTransitionData(this,e);return!!r?.transitions.length&&r.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),Fa={deferEvents:!1},zr=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=N(N({},Fa),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(n){throw this.clear(),n}finally{this.processingEvent=!1}},t}(),Un=new Map,Na=0,bt={bookId:function(){return"x:".concat(Na++)},register:function(t,e){return Un.set(t,e),t},get:function(t){return Un.get(t)},free:function(t){Un.delete(t)}};function xr(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function La(){var t=xr();if(t&&"__xstate__"in t)return t.__xstate__}function Ba(t){if(xr()){var e=La();e&&e.register(t)}}function $a(t,e){e===void 0&&(e={});var n=t.initialState,r=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var u=i.shift();n=t.transition(n,u,c),r.forEach(function(f){return f.next(n)})}s=!1}},a=Ta({id:e.id,send:function(u){i.push(u),o()},getSnapshot:function(){return n},subscribe:function(u,f,l){var h=tn(u,f,l);return r.add(h),h.next(n),{unsubscribe:function(){r.delete(h)}}}}),c={parent:e.parent,self:a,id:e.id||"anonymous",observers:r};return n=t.start?t.start(c):n,a}var za={sync:!1,autoForward:!1},le;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(le||(le={}));var Va=function(){function t(e,n){n===void 0&&(n=t.defaultOptions);var r=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=le.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(f,l){if(_t(f))return r.batch(f),r.state;var h=ge(Cn(f,l));if(r.status===le.Stopped)return r.state;if(r.status!==le.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(h.name,'" was sent to uninitialized service "').concat(r.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(h.data)));return r.scheduler.schedule(function(){r.forward(h);var d=r._nextState(h);r.update(d,h)}),r._state},this.sendTo=function(f,l,h){var d=r.parent&&(l===ht.Parent||r.parent.id===l),y=d?r.parent:te(l)?l===ht.Internal?r:r.children.get(l)||bt.get(l):ga(l)?l:void 0;if(!y){if(!d)throw new Error("Unable to send event to child '".concat(l,"' from service '").concat(r.id,"'."));return}if("machine"in y){if(r.status!==le.Stopped||r.parent!==y||r.state.done){var _=N(N({},f),{name:f.name===ta?"".concat(At(r.id)):f.name,origin:r.sessionId});!h&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([y,_]):y.send(_)}}else!h&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([y,f.data]):y.send(f.data)},this._exec=function(f,l,h,d){d===void 0&&(d=r.machine.options.actions);var y=f.exec||Zn(f.type,d),_=ee(y)?y:y?y.exec:f.exec;if(_)try{return _(l,h.data,r.machine.config.predictableActionArguments?{action:f,_event:h}:{action:f,state:r.state,_event:h})}catch(F){throw r.parent&&r.parent.send({type:"xstate.error",data:F}),F}switch(f.type){case $t:{var x=f;r.defer(x);break}case kn:var A=f;if(typeof A.delay=="number"){r.defer(A);return}else A.to?r.sendTo(A._event,A.to,h===ut):r.send(A._event);break;case Ni:r.cancel(f.sendId);break;case Gn:{if(r.status!==le.Running)return;var k=f.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[k.id||k.type])break;if(k.type===ne.Invoke){var w=Ji(k.src),P=r.machine.options.services?r.machine.options.services[w.type]:void 0,L=k.id,E=k.data,I="autoForward"in k?k.autoForward:!!k.forward;if(!P)return;var U=E?hn(E,l,h):void 0;if(typeof P=="string")return;var M=ee(P)?P(l,h.data,{data:U,src:w,meta:k.meta}):P;if(!M)return;var $=void 0;dt(M)&&(M=U?M.withContext(U):M,$={autoForward:I}),r.spawn(M,L,$)}else r.spawnActivity(k);break}case br:{r.stopChild(f.activity.id);break}case Li:var z=f,K=z.label,b=z.value;K?r.logger(K,b):r.logger(b);break}};var i=N(N({},t.defaultOptions),n),s=i.clock,o=i.logger,a=i.parent,c=i.id,u=c!==void 0?c:e.id;this.id=u,this.logger=o,this.clock=s,this.parent=a,this.options=i,this.scheduler=new zr({deferEvents:this.options.deferEvents}),this.sessionId=bt.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:st(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,n){var r,i;try{for(var s=Q(e.actions),o=s.next();!o.done;o=s.next()){var a=o.value;this.exec(a,e,n)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},t.prototype.update=function(e,n){var r,i,s,o,a,c,u,f,l=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||n===ut)&&this.options.execute)this.execute(this.state);else for(var h=void 0;h=this._outgoingQueue.shift();)h[0].send(h[1]);if(this.children.forEach(function(M){l.state.children[M.id]=M}),this.devTools&&this.devTools.send(n.data,e),e.event)try{for(var d=Q(this.eventListeners),y=d.next();!y.done;y=d.next()){var _=y.value;_(e.event)}}catch(M){r={error:M}}finally{try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}try{for(var x=Q(this.listeners),A=x.next();!A.done;A=x.next()){var _=A.value;_(e,e.event)}}catch(M){s={error:M}}finally{try{A&&!A.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}try{for(var k=Q(this.contextListeners),w=k.next();!w.done;w=k.next()){var P=w.value;P(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(M){a={error:M}}finally{try{w&&!w.done&&(c=k.return)&&c.call(k)}finally{if(a)throw a.error}}if(this.state.done){var L=e.configuration.find(function(M){return M.type==="final"&&M.parent===l.machine}),E=L&&L.doneData?hn(L.doneData,e.context,n):void 0;this._doneEvent=nn(this.id,E);try{for(var I=Q(this.doneListeners),U=I.next();!U.done;U=I.next()){var _=U.value;_(this._doneEvent)}}catch(M){u={error:M}}finally{try{U&&!U.done&&(f=I.return)&&f.call(I)}finally{if(u)throw u.error}}this._stop(),this._stopChildren(),bt.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===le.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,n,r){var i=this,s=tn(e,n,r);this.listeners.add(s.next),this.status!==le.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===le.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===le.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var n=this;if(this.status===le.Running)return this;this.machine._init(),bt.register(this.sessionId,this),this.initialized=!0,this.status=le.Running;var r=e===void 0?this.initialState:st(this,function(){return Ma(e)?n.machine.resolveState(e):n.machine.resolveState(De.from(e,n.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){n.update(r,ut)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){ee(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,n,r,i,s,o,a,c,u,f;try{for(var l=Q(this.listeners),h=l.next();!h.done;h=l.next()){var d=h.value;this.listeners.delete(d)}}catch(I){e={error:I}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}try{for(var y=Q(this.stopListeners),_=y.next();!_.done;_=y.next()){var d=_.value;d(),this.stopListeners.delete(d)}}catch(I){r={error:I}}finally{try{_&&!_.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}try{for(var x=Q(this.contextListeners),A=x.next();!A.done;A=x.next()){var d=A.value;this.contextListeners.delete(d)}}catch(I){s={error:I}}finally{try{A&&!A.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}try{for(var k=Q(this.doneListeners),w=k.next();!w.done;w=k.next()){var d=w.value;this.doneListeners.delete(d)}}catch(I){a={error:I}}finally{try{w&&!w.done&&(c=k.return)&&c.call(k)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.initialized=!1,this.status=le.Stopped,this._initialState=void 0;try{for(var P=Q(Object.keys(this.delayedEventsMap)),L=P.next();!L.done;L=P.next()){var E=L.value;this.clock.clearTimeout(this.delayedEventsMap[E])}}catch(I){u={error:I}}finally{try{L&&!L.done&&(f=P.return)&&f.call(P)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new zr({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,n=this.scheduler;return this._stop(),n.schedule(function(){var r=ge({type:"xstate.stop"}),i=st(e,function(){var s=oe(re([],Z(e.state.configuration),!1).sort(function(f,l){return l.order-f.order}).map(function(f){return Je(f.onExit,e.machine.options.actions)})),o=Z(dn(e.machine,e.state,e.state.context,r,[{type:"exit",actions:s}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),a=o[0],c=o[1],u=new De({value:e.state.value,context:c,_event:r,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:a.filter(function(f){return!Qn(f)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return u.changed=!0,u});e.update(i,r),e._stopChildren(),bt.free(e.sessionId)}),this},t.prototype.batch=function(e){var n=this;if(!(this.status===le.NotStarted&&this.options.deferEvents)){if(this.status!==le.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}if(e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=n.state,a=!1,c=[],u=function(d){var y=ge(d);n.forward(y),o=st(n,function(){return n.machine.transition(o,y,void 0,r||void 0)}),c.push.apply(c,re([],Z(n.machine.config.predictableActionArguments?o.actions:o.actions.map(function(_){return Pa(_,o)})),!1)),a=a||!!o.changed};try{for(var f=Q(e),l=f.next();!l.done;l=f.next()){var h=l.value;u(h)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}o.changed=a,o.actions=c,n.update(o,ge(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,n){var r=this;n===void 0&&(n=!!this.machine.config.predictableActionArguments&&this._exec);var i=ge(e);if(i.name.indexOf(Mr)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(Mr)===0}))throw i.data.data;var s=st(this,function(){return r.machine.transition(r.state,i,void 0,n||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var n,r;try{for(var i=Q(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.defer=function(e){var n=this,r=this.clock.setTimeout(function(){"to"in e&&e.to?n.sendTo(e._event,e.to,!0):n.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=r)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,n,r){r===void 0&&(r=this.machine.options.actions),this._exec(e,n.context,n._event,r)},t.prototype.removeChild=function(e){var n;this.children.delete(e),this.forwardTo.delete(e),(n=this.state)===null||n===void 0||delete n.children[e]},t.prototype.stopChild=function(e){var n=this.children.get(e);n&&(this.removeChild(e),ee(n.stop)&&n.stop())},t.prototype.spawn=function(e,n,r){if(this.status!==le.Running)return qi(e,n);if(Nr(e))return this.spawnPromise(Promise.resolve(e),n);if(ee(e))return this.spawnCallback(e,n);if(Ia(e))return this.spawnActor(e,n);if(da(e))return this.spawnObservable(e,n);if(dt(e))return this.spawnMachine(e,N(N({},r),{id:n}));if(ua(e))return this.spawnBehavior(e,n);throw new Error('Unable to spawn entity "'.concat(n,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,n){var r=this;n===void 0&&(n={});var i=new t(e,N(N({},this.options),{parent:this,id:n.id||e.id})),s=N(N({},za),n);s.sync&&i.onTransition(function(a){r.send(Bi,{state:a,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(a){r.removeChild(i.id),r.send(ge(a,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,n){var r=$a(e,{id:n,parent:this});return this.children.set(n,r),r},t.prototype.spawnPromise=function(e,n){var r,i=this,s=!1,o;e.then(function(c){s||(o=c,i.removeChild(n),i.send(ge(nn(n,c),{origin:n})))},function(c){if(!s){i.removeChild(n);var u=At(n,c);try{i.send(ge(u,{origin:n}))}catch{i.devTools&&i.devTools.send(u,i.state),i.machine.strict&&i.stop()}}});var a=(r={id:n,send:function(){},subscribe:function(c,u,f){var l=tn(c,u,f),h=!1;return e.then(function(d){h||(l.next(d),!h&&l.complete())},function(d){h||l.error(d)}),{unsubscribe:function(){return h=!0}}},stop:function(){s=!0},toJSON:function(){return{id:n}},getSnapshot:function(){return o}},r[Ke]=function(){return this},r);return this.children.set(n,a),a},t.prototype.spawnCallback=function(e,n){var r,i=this,s=!1,o=new Set,a=new Set,c,u=function(h){c=h,a.forEach(function(d){return d(h)}),!s&&i.send(ge(h,{origin:n}))},f;try{f=e(u,function(h){o.add(h)})}catch(h){this.send(At(n,h))}if(Nr(f))return this.spawnPromise(f,n);var l=(r={id:n,send:function(h){return o.forEach(function(d){return d(h)})},subscribe:function(h){var d=tn(h);return a.add(d.next),{unsubscribe:function(){a.delete(d.next)}}},stop:function(){s=!0,ee(f)&&f()},toJSON:function(){return{id:n}},getSnapshot:function(){return c}},r[Ke]=function(){return this},r);return this.children.set(n,l),l},t.prototype.spawnObservable=function(e,n){var r,i=this,s,o=e.subscribe(function(c){s=c,i.send(ge(c,{origin:n}))},function(c){i.removeChild(n),i.send(ge(At(n,c),{origin:n}))},function(){i.removeChild(n),i.send(ge(nn(n),{origin:n}))}),a=(r={id:n,send:function(){},subscribe:function(c,u,f){return e.subscribe(c,u,f)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:n}}},r[Ke]=function(){return this},r);return this.children.set(n,a),a},t.prototype.spawnActor=function(e,n){return this.children.set(n,e),e},t.prototype.spawnActivity=function(e){var n=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(n){var r=n(this.state.context,e);this.spawnEffect(e.id,r)}},t.prototype.spawnEffect=function(e,n){var r;this.children.set(e,(r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:n||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},r[Ke]=function(){return this},r))},t.prototype.attachDev=function(){var e=xr();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var n=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(N(N({name:this.id,autoPause:!0,stateSanitizer:function(r){return{value:r.value,context:r.context,actions:r.actions}}},n),{features:N({jump:!1,skip:!1},n?n.features:void 0)}),this.machine),this.devTools.init(this.state)}Ba(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Ke]=function(){return this},t.prototype.getSnapshot=function(){return this.status===le.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,n){return setTimeout(e,n)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=es,t}();function es(t,e){var n=new Va(t,e);return n}function Ha(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function Gt(t){return N(N({type:qn},t),{toJSON:function(){t.onDone,t.onError;var e=_r(t,["onDone","onError"]);return N(N({},e),{type:qn,src:Ha(t.src)})}})}var qt="",tr="#",Dn="*",tt={},nt=function(t){return t[0]===tr},Wa=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Ka=function(){function t(e,n,r,i){r===void 0&&(r="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Wa(),n),this.parent=i?.parent,this.key=this.config.key||i?.key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:$i),this.id=this.config.id||re([this.machine.key],Z(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?Et(this.config.states,function(u,f){var l,h=new t(u,{},void 0,{parent:s,key:f});return Object.assign(s.idMap,N((l={},l[h.id]=h,l),h.idMap)),h}):tt;var a=0;function c(u){var f,l;u.order=a++;try{for(var h=Q(Xi(u)),d=h.next();!d.done;d=h.next()){var y=d.value;c(y)}}catch(_){f={error:_}}finally{try{d&&!d.done&&(l=h.return)&&l.call(h)}finally{if(f)throw f.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var f=u.event;return f===qt}):qt in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=Oe(this.config.entry||this.config.onEntry).map(function(u){return Dt(u)}),this.onExit=Oe(this.config.exit||this.config.onExit).map(function(u){return Dt(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=Oe(this.config.invoke).map(function(u,f){var l,h;if(dt(u)){var d=Kt(s.id,f);return s.machine.options.services=N((l={},l[d]=u,l),s.machine.options.services),Gt({src:d,id:d})}else if(te(u.src)){var d=u.id||Kt(s.id,f);return Gt(N(N({},u),{id:d,src:u.src}))}else if(dt(u.src)||ee(u.src)){var d=u.id||Kt(s.id,f);return s.machine.options.services=N((h={},h[d]=u.src,h),s.machine.options.services),Gt(N(N({id:d},u),{src:d}))}else{var y=u.src;return Gt(N(N({id:Kt(s.id,f)},u),{src:y}))}}),this.activities=Oe(this.config.activities).concat(this.invoke).map(function(u){return mr(u)}),this.transition=this.transition.bind(this),this.tags=Oe(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Yi(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,n){var r=this.options,i=r.actions,s=r.activities,o=r.guards,a=r.services,c=r.delays;return new t(this.config,{actions:N(N({},i),e.actions),activities:N(N({},s),e.activities),guards:N(N({},o),e.guards),services:N(N({},a),e.services),delays:N(N({},c),e.delays)},n??this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return ee(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Et(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(n,r){return n[r.eventType]=n[r.eventType]||[],n[r.eventType].push(r),n},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var n=e===qt,r=this.transitions.filter(function(i){var s=i.eventType===e;return n?s:s||i.eventType===Dn});return this.__cache.candidates[e]=r,r},t.prototype.getDelayedTransitions=function(){var e=this,n=this.config.after;if(!n)return[];var r=function(s,o){var a=ee(s)?"".concat(e.id,":delay[").concat(o,"]"):s,c=ka(a,e.id);return e.onEntry.push(ba(c,{delay:s})),e.onExit.push(ma(c)),c},i=_t(n)?n.map(function(s,o){var a=r(s.delay,o);return N(N({},s),{event:a})}):oe(Object.keys(n).map(function(s,o){var a=n[s],c=te(a)?{target:a}:a,u=isNaN(+s)?s:+s,f=r(u,o);return Oe(c).map(function(l){return N(N({},l),{event:f,delay:u})})}));return i.map(function(s){var o=s.delay;return N(N({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var n,r=this;if(!e)return[];var i=e instanceof De?e.value:Tt(e,this.delimiter);if(te(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((n={},n[i]=s,n)):[this,this.states[i]]}var o=Object.keys(i),a=[this];return a.push.apply(a,re([],Z(oe(o.map(function(c){return r.getStateNode(c).getStateNodes(i[c])}))),!1)),a},t.prototype.handles=function(e){var n=zi(e);return this.events.includes(n)},t.prototype.resolveState=function(e){var n=e instanceof De?e:De.create(e),r=Array.from(kt([],this.getStateNodes(n.value)));return new De(N(N({},n),{value:this.resolve(n.value),configuration:r,done:rn(r,this),tags:$r(r),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,n,r){var i=this.getStateNode(e),s=i.next(n,r);return!s||!s.transitions.length?this.next(n,r):s},t.prototype.transitionCompoundNode=function(e,n,r){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],n,r);return!o||!o.transitions.length?this.next(n,r):o},t.prototype.transitionParallelNode=function(e,n,r){var i,s,o={};try{for(var a=Q(Object.keys(e)),c=a.next();!c.done;c=a.next()){var u=c.value,f=e[u];if(f){var l=this.getStateNode(u),h=l._transition(f,n,r);h&&(o[u]=h)}}}catch(A){i={error:A}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}var d=Object.keys(o).map(function(A){return o[A]}),y=oe(d.map(function(A){return A.transitions})),_=d.some(function(A){return A.transitions.length>0});if(!_)return this.next(n,r);var x=oe(Object.keys(o).map(function(A){return o[A].configuration}));return{transitions:y,exitSet:oe(d.map(function(A){return A.exitSet})),configuration:x,source:n,actions:oe(Object.keys(o).map(function(A){return o[A].actions}))}},t.prototype._transition=function(e,n,r){return te(e)?this.transitionLeafNode(e,n,r):Object.keys(e).length===1?this.transitionCompoundNode(e,n,r):this.transitionParallelNode(e,n,r)},t.prototype.getTransitionData=function(e,n){return this._transition(e.value,e,ge(n))},t.prototype.next=function(e,n){var r,i,s=this,o=n.name,a=[],c=[],u;try{for(var f=Q(this.getCandidates(o)),l=f.next();!l.done;l=f.next()){var h=l.value,d=h.cond,y=h.in,_=e.context,x=y?te(y)&&nt(y)?e.matches(Tt(this.getStateNodeById(y).path,this.delimiter)):vr(Tt(y,this.delimiter),oa(this.path.slice(0,-2))(e.value)):!0,A=!1;try{A=!d||Ki(this.machine,d,_,n,e)}catch(P){throw new Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(P.message))}if(A&&x){h.target!==void 0&&(c=h.target),a.push.apply(a,re([],Z(h.actions),!1)),u=h;break}}}catch(P){r={error:P}}finally{try{l&&!l.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}if(u){if(!c.length)return{transitions:[u],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var k=oe(c.map(function(P){return s.getRelativeStateNodes(P,e.historyValue)})),w=!!u.internal;return{transitions:[u],exitSet:w?[]:oe(c.map(function(P){return s.getPotentiallyReenteringNodes(P)})),configuration:k,source:e,actions:a}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var n=[],r=this,i=e;r&&r!==i;)n.push(r),r=r.parent;return r!==i?[]:(n.push(i),n)},t.prototype.getActions=function(e,n,r,i,s,o,a){var c,u,f,l,h=this,d=o?kt([],this.getStateNodes(o.value)):[],y=new Set;try{for(var _=Q(Array.from(e).sort(function(z,K){return z.order-K.order})),x=_.next();!x.done;x=_.next()){var A=x.value;(!Ct(d,A)||Ct(r.exitSet,A)||A.parent&&y.has(A.parent))&&y.add(A)}}catch(z){c={error:z}}finally{try{x&&!x.done&&(u=_.return)&&u.call(_)}finally{if(c)throw c.error}}try{for(var k=Q(d),w=k.next();!w.done;w=k.next()){var A=w.value;(!Ct(e,A)||Ct(r.exitSet,A.parent))&&r.exitSet.push(A)}}catch(z){f={error:z}}finally{try{w&&!w.done&&(l=k.return)&&l.call(k)}finally{if(f)throw f.error}}r.exitSet.sort(function(z,K){return K.order-z.order});var P=Array.from(y).sort(function(z,K){return z.order-K.order}),L=new Set(r.exitSet),E=oe(P.map(function(z){var K=[];if(z.type!=="final")return K;var b=z.parent;if(!b.parent)return K;K.push(Jt(z.id,z.doneData),Jt(b.id,z.doneData?hn(z.doneData,i,s):void 0));var F=b.parent;return F.type==="parallel"&&Mt(F).every(function(R){return rn(r.configuration,R)})&&K.push(Jt(F.id)),K})),I=P.map(function(z){var K=z.onEntry,b=z.activities.map(function(F){return xa(F)});return{type:"entry",actions:Je(a?re(re([],Z(K),!1),Z(b),!1):re(re([],Z(b),!1),Z(K),!1),h.machine.options.actions)}}).concat({type:"state_done",actions:E.map(function(z){return ya(z)})}),U=Array.from(L).map(function(z){return{type:"exit",actions:Je(re(re([],Z(z.onExit),!1),Z(z.activities.map(function(K){return Sa(K)})),!1),h.machine.options.actions)}}),M=U.concat({type:"transition",actions:Je(r.actions,this.machine.options.actions)}).concat(I);if(n){var $=Je(oe(re([],Z(e),!1).sort(function(z,K){return K.order-z.order}).map(function(z){return z.onExit})),this.machine.options.actions).filter(function(z){return!Qn(z)});return M.concat({type:"stop",actions:$})}return M},t.prototype.transition=function(e,n,r,i){e===void 0&&(e=this.initialState);var s=ge(n),o;if(e instanceof De)o=r===void 0?e:this.resolveState(De.from(e,r));else{var a=te(e)?this.resolve(ln(this.getResolvedPath(e))):this.resolve(e),c=r??this.machine.context;o=this.resolveState(De.from(a,c))}if(this.strict&&!this.events.includes(s.name)&&!ca(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(o.value,o,s)||{transitions:[],configuration:[],exitSet:[],source:o,actions:[]},f=kt([],this.getStateNodes(o.value)),l=u.configuration.length?kt(f,u.configuration):f;return u.configuration=re([],Z(l),!1),this.resolveTransition(u,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,n,r,i){var s,o=e.actions;return e=this.transition(e,n,void 0,i),e._event=r,e.event=r.data,(s=e.actions).unshift.apply(s,re([],Z(o),!1)),e},t.prototype.resolveTransition=function(e,n,r,i,s){var o,a,c,u,f=this;s===void 0&&(s=ut);var l=e.configuration,h=!n||e.transitions.length>0,d=h?e.configuration:n?n.configuration:[],y=rn(d,this),_=h?ja(this.machine,l):void 0,x=n?n.historyValue?n.historyValue:e.source?this.machine.historyValue(n.value):void 0:void 0,A=this.getActions(new Set(d),y,e,r,s,n,i),k=n?N({},n.activities):{};try{for(var w=Q(A),P=w.next();!P.done;P=w.next()){var L=P.value;try{for(var E=(c=void 0,Q(L.actions)),I=E.next();!I.done;I=E.next()){var U=I.value;U.type===Gn?k[U.activity.id||U.activity.type]=U:U.type===br&&(k[U.activity.id||U.activity.type]=!1)}}catch(Ce){c={error:Ce}}finally{try{I&&!I.done&&(u=E.return)&&u.call(E)}finally{if(c)throw c.error}}}}catch(Ce){o={error:Ce}}finally{try{P&&!P.done&&(a=w.return)&&a.call(w)}finally{if(o)throw o.error}}var M=Z(dn(this,n,r,s,A,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),$=M[0],z=M[1],K=Z(fa($,Qn),2),b=K[0],F=K[1],R=$.filter(function(Ce){var Ze;return Ce.type===Gn&&((Ze=Ce.activity)===null||Ze===void 0?void 0:Ze.type)===qn}),j=R.reduce(function(Ce,Ze){return Ce[Ze.activity.id]=Oa(Ze.activity,f.machine,z,s),Ce},n?N({},n.children):{}),O=new De({value:_||n.value,context:z,_event:s,_sessionid:n?n._sessionid:null,historyValue:_?x?la(x,_):void 0:n?n.historyValue:void 0,history:!_||e.source?n:void 0,actions:_?F:[],activities:_?k:n?n.activities:{},events:[],configuration:d,transitions:e.transitions,children:j,done:y,tags:$r(d),machine:this}),V=r!==z;O.changed=s.name===Bi||V;var H=O.history;H&&delete H.history;var J=!y&&(this._transient||l.some(function(Ce){return Ce._transient}));if(!h&&(!J||s.name===qt))return O;var W=O;if(!y)for(J&&(W=this.resolveRaisedTransition(W,{type:Zo},s,i));b.length;){var q=b.shift();W=this.resolveRaisedTransition(W,q._event,s,i)}var Vt=W.changed||(H?!!W.actions.length||V||typeof H.value!=typeof W.value||!Zi(W.value,H.value):void 0);return W.changed=Vt,W.history=H,W},t.prototype.getStateNode=function(e){if(nt(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var n=this.states[e];if(!n)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return n},t.prototype.getStateNodeById=function(e){var n=nt(e)?e.slice(tr.length):e;if(n===this.id)return this;var r=this.machine.idMap[n];if(!r)throw new Error("Child state node '#".concat(n,"' does not exist on machine '").concat(this.id,"'"));return r},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&nt(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var n=Yn(e,this.delimiter).slice(),r=this;n.length;){var i=n.shift();if(!i.length)break;r=r.getStateNode(i)}return r},t.prototype.resolve=function(e){var n,r=this;if(!e)return this.initialStateValue||tt;switch(this.type){case"parallel":return Et(this.initialStateValue,function(s,o){return s?r.getStateNode(o).resolve(e[o]||s):tt});case"compound":if(te(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(n={},n[e]=i.initialStateValue,n):e}return Object.keys(e).length?Et(e,function(s,o){return s?r.getStateNode(o).resolve(s):tt}):this.initialStateValue||{};default:return e||tt}},t.prototype.getResolvedPath=function(e){if(nt(e)){var n=this.machine.idMap[e.slice(tr.length)];if(!n)throw new Error("Unable to find state node '".concat(e,"'"));return n.path}return Yn(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var n;if(this.type==="parallel")n=Fr(this.states,function(r){return r.initialStateValue||tt},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));n=gn(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else n={};return this.__cache.initialStateValue=n,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,n){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,n??this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var n=this.config;te(n.target)?e=nt(n.target)?ln(this.machine.getStateNodeById(n.target).path.slice(this.path.length-1)):n.target:e=n.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,n,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(n):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(gn(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var n=en(this.initialStateValue);return oe(n.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var n=Z(e),r=n[0],i=n.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var s=this.getStateNode(r);if(s.type==="history")return s.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Fr(this.states,function(n,r){if(!e)return n.historyValue();var i=te(e)?void 0:e[r];return n.historyValue(i||n.initialStateValue)},function(n){return!n.history})}},t.prototype.resolveHistory=function(e){var n=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var i=this.target;return i?oe(en(i).map(function(o){return r.getFromRelativePath(o)})):r.initialStateNodes}var s=aa(r.path,"states")(e).current;return te(s)?[r.getStateNode(s)]:oe(en(s).map(function(o){return n.history==="deep"?r.getFromRelativePath(o):[r.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,n=oe(Object.keys(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,n,r,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var a=Q(Object.keys(s)),c=a.next();!c.done;c=a.next()){var u=c.value,f=s[u];if(f.states)try{for(var l=(r=void 0,Q(f.events)),h=l.next();!h.done;h=l.next()){var d=h.value;o.add("".concat(d))}}catch(y){r={error:y}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(y){e={error:y}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(n){return!(!n.target&&!n.actions.length&&n.internal)}).map(function(n){return n.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var n=this;if(e!==void 0)return e.map(function(r){if(!te(r))return r;var i=r[0]===n.delimiter;if(i&&!n.parent)return n.getStateNodeByPath(r.slice(1));var s=i?n.key+r:r;if(n.parent)try{var o=n.parent.getStateNodeByPath(s);return o}catch(a){throw new Error("Invalid transition definition for state node '".concat(n.id,`':
`).concat(a.message))}else return n.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var n=this,r=pa(e.target),i="internal"in e?e.internal:r?r.some(function(c){return te(c)&&c[0]===n.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(r),a=N(N({},e),{actions:Je(Oe(e.actions)),cond:Wi(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return N(N({},a),{target:a.target?a.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(n.id)})}});return a},t.prototype.formatTransitions=function(){var e,n,r=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=Dn,a=s[o],c=a===void 0?[]:a,u=_r(s,[typeof o=="symbol"?o:o+""]);i=oe(Object.keys(u).map(function(k){var w=et(k,u[k]);return w}).concat(et(Dn,c)))}var f=this.config.always?et("",this.config.always):[],l=this.config.onDone?et(String(Jt(this.id)),this.config.onDone):[],h=oe(this.invoke.map(function(k){var w=[];return k.onDone&&w.push.apply(w,re([],Z(et(String(nn(k.id)),k.onDone)),!1)),k.onError&&w.push.apply(w,re([],Z(et(String(At(k.id)),k.onError)),!1)),w})),d=this.after,y=oe(re(re(re(re([],Z(l),!1),Z(h),!1),Z(i),!1),Z(f),!1).map(function(k){return Oe(k).map(function(w){return r.formatTransition(w)})}));try{for(var _=Q(d),x=_.next();!x.done;x=_.next()){var A=x.value;y.push(A)}}catch(k){e={error:k}}finally{try{x&&!x.done&&(n=_.return)&&n.call(_)}finally{if(e)throw e.error}}return y},t}();function Ja(t,e){return new Ka(t,e)}var Mn=Aa,ts={},ns={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */t.__assign=function(){return t.__assign=Object.assign||function(o){for(var a,c=1,u=arguments.length;c<u;c++){a=arguments[c];for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(o[f]=a[f])}return o},t.__assign.apply(this,arguments)};function e(s,o){var a={};for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&o.indexOf(c)<0&&(a[c]=s[c]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,c=Object.getOwnPropertySymbols(s);u<c.length;u++)o.indexOf(c[u])<0&&Object.prototype.propertyIsEnumerable.call(s,c[u])&&(a[c[u]]=s[c[u]]);return a}function n(s){var o=typeof Symbol=="function"&&Symbol.iterator,a=o&&s[o],c=0;if(a)return a.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&c>=s.length&&(s=void 0),{value:s&&s[c++],done:!s}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function r(s,o){var a=typeof Symbol=="function"&&s[Symbol.iterator];if(!a)return s;var c=a.call(s),u,f=[],l;try{for(;(o===void 0||o-- >0)&&!(u=c.next()).done;)f.push(u.value)}catch(h){l={error:h}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(l)throw l.error}}return f}function i(s,o,a){if(a||arguments.length===2)for(var c=0,u=o.length,f;c<u;c++)(f||!(c in o))&&(f||(f=Array.prototype.slice.call(o,0,c)),f[c]=o[c]);return s.concat(f||Array.prototype.slice.call(o))}t.__read=r,t.__rest=e,t.__spreadArray=i,t.__values=n})(ns);Object.defineProperty(ts,"__esModule",{value:!0});var Vr=ns,Ga={timeout:1e4};function qa(t,e,n){var r=Vr.__assign(Vr.__assign({},Ga),n);return new Promise(function(i,s){var o=!1,a=r.timeout===1/0?void 0:setTimeout(function(){u.unsubscribe(),s(new Error("Timeout of ".concat(r.timeout," ms exceeded")))},r.timeout),c=function(){clearTimeout(a),o=!0,u?.unsubscribe()},u=t.subscribe({next:function(f){e(f)&&(c(),i(f))},error:function(f){c(),s(f)},complete:function(){c(),s(new Error("Actor terminated without satisfying predicate"))}});o&&u.unsubscribe()})}var Xa=ts.waitFor=qa,gt={},On={},be={};Object.defineProperty(be,"__esModule",{value:!0});be.output=be.exists=be.hash=be.bytes=be.bool=be.number=void 0;function pn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}be.number=pn;function rs(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}be.bool=rs;function Sr(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}be.bytes=Sr;function is(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");pn(t.outputLen),pn(t.blockLen)}be.hash=is;function ss(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}be.exists=ss;function os(t,e){Sr(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}be.output=os;const Ya={number:pn,bool:rs,bytes:Sr,hash:is,exists:ss,output:os};be.default=Ya;var Er={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.crypto=void 0;Rn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=Rn,n=E=>E instanceof Uint8Array,r=E=>new Uint8Array(E.buffer,E.byteOffset,E.byteLength);t.u8=r;const i=E=>new Uint32Array(E.buffer,E.byteOffset,Math.floor(E.byteLength/4));t.u32=i;const s=E=>new DataView(E.buffer,E.byteOffset,E.byteLength);t.createView=s;const o=(E,I)=>E<<32-I|E>>>I;if(t.rotr=o,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const a=Array.from({length:256},(E,I)=>I.toString(16).padStart(2,"0"));function c(E){if(!n(E))throw new Error("Uint8Array expected");let I="";for(let U=0;U<E.length;U++)I+=a[E[U]];return I}t.bytesToHex=c;function u(E){if(typeof E!="string")throw new Error("hex string expected, got "+typeof E);const I=E.length;if(I%2)throw new Error("padded hex string expected, got unpadded hex of length "+I);const U=new Uint8Array(I/2);for(let M=0;M<U.length;M++){const $=M*2,z=E.slice($,$+2),K=Number.parseInt(z,16);if(Number.isNaN(K)||K<0)throw new Error("Invalid byte sequence");U[M]=K}return U}t.hexToBytes=u;const f=async()=>{};t.nextTick=f;async function l(E,I,U){let M=Date.now();for(let $=0;$<E;$++){U($);const z=Date.now()-M;z>=0&&z<I||(await(0,t.nextTick)(),M+=z)}}t.asyncLoop=l;function h(E){if(typeof E!="string")throw new Error(`utf8ToBytes expected string, got ${typeof E}`);return new Uint8Array(new TextEncoder().encode(E))}t.utf8ToBytes=h;function d(E){if(typeof E=="string"&&(E=h(E)),!n(E))throw new Error(`expected Uint8Array, got ${typeof E}`);return E}t.toBytes=d;function y(...E){const I=new Uint8Array(E.reduce((M,$)=>M+$.length,0));let U=0;return E.forEach(M=>{if(!n(M))throw new Error("Uint8Array expected");I.set(M,U),U+=M.length}),I}t.concatBytes=y;class _{clone(){return this._cloneInto()}}t.Hash=_;const x={}.toString;function A(E,I){if(I!==void 0&&x.call(I)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(E,I)}t.checkOpts=A;function k(E){const I=M=>E().update(d(M)).digest(),U=E();return I.outputLen=U.outputLen,I.blockLen=U.blockLen,I.create=()=>E(),I}t.wrapConstructor=k;function w(E){const I=(M,$)=>E($).update(d(M)).digest(),U=E({});return I.outputLen=U.outputLen,I.blockLen=U.blockLen,I.create=M=>E(M),I}t.wrapConstructorWithOpts=w;function P(E){const I=(M,$)=>E($).update(d(M)).digest(),U=E({});return I.outputLen=U.outputLen,I.blockLen=U.blockLen,I.create=M=>E(M),I}t.wrapXOFConstructorWithOpts=P;function L(E=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(E));throw new Error("crypto.getRandomValues must be defined")}t.randomBytes=L})(Er);Object.defineProperty(On,"__esModule",{value:!0});On.SHA2=void 0;const Pn=be,wt=Er;function Qa(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}class Za extends wt.Hash{constructor(e,n,r,i){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,wt.createView)(this.buffer)}update(e){(0,Pn.exists)(this);const{view:n,buffer:r,blockLen:i}=this;e=(0,wt.toBytes)(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=(0,wt.createView)(e);for(;i<=s-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,Pn.exists)(this),(0,Pn.output)(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let l=o;l<i;l++)n[l]=0;Qa(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=(0,wt.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,f[l],s)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%n&&e.buffer.set(r),e}}On.SHA2=Za;Object.defineProperty(gt,"__esModule",{value:!0});gt.sha224=gt.sha256=void 0;const ec=On,xe=Er,tc=(t,e,n)=>t&e^~t&n,nc=(t,e,n)=>t&e^t&n^e&n,rc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ve=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64);class as extends ec.SHA2{constructor(){super(64,32,8,!1),this.A=Ve[0]|0,this.B=Ve[1]|0,this.C=Ve[2]|0,this.D=Ve[3]|0,this.E=Ve[4]|0,this.F=Ve[5]|0,this.G=Ve[6]|0,this.H=Ve[7]|0}get(){const{A:e,B:n,C:r,D:i,E:s,F:o,G:a,H:c}=this;return[e,n,r,i,s,o,a,c]}set(e,n,r,i,s,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let l=0;l<16;l++,n+=4)He[l]=e.getUint32(n,!1);for(let l=16;l<64;l++){const h=He[l-15],d=He[l-2],y=(0,xe.rotr)(h,7)^(0,xe.rotr)(h,18)^h>>>3,_=(0,xe.rotr)(d,17)^(0,xe.rotr)(d,19)^d>>>10;He[l]=_+He[l-7]+y+He[l-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:c,G:u,H:f}=this;for(let l=0;l<64;l++){const h=(0,xe.rotr)(a,6)^(0,xe.rotr)(a,11)^(0,xe.rotr)(a,25),d=f+h+tc(a,c,u)+rc[l]+He[l]|0,_=((0,xe.rotr)(r,2)^(0,xe.rotr)(r,13)^(0,xe.rotr)(r,22))+nc(r,i,s)|0;f=u,u=c,c=a,a=o+d|0,o=s,s=i,i=r,r=d+_|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(r,i,s,o,a,c,u,f)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class ic extends as{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}gt.sha256=(0,xe.wrapConstructor)(()=>new as);gt.sha224=(0,xe.wrapConstructor)(()=>new ic);function sc(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var i=t.charAt(r),s=i.charCodeAt(0);if(e[s]!==255)throw new TypeError(i+" is ambiguous");e[s]=r}var o=t.length,a=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function f(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var y=0,_=0,x=0,A=d.length;x!==A&&d[x]===0;)x++,y++;for(var k=(A-x)*u+1>>>0,w=new Uint8Array(k);x!==A;){for(var P=d[x],L=0,E=k-1;(P!==0||L<_)&&E!==-1;E--,L++)P+=256*w[E]>>>0,w[E]=P%o>>>0,P=P/o>>>0;if(P!==0)throw new Error("Non-zero carry");_=L,x++}for(var I=k-_;I!==k&&w[I]===0;)I++;for(var U=a.repeat(y);I<k;++I)U+=t.charAt(w[I]);return U}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;for(var y=0,_=0,x=0;d[y]===a;)_++,y++;for(var A=(d.length-y)*c+1>>>0,k=new Uint8Array(A);d[y];){var w=e[d.charCodeAt(y)];if(w===255)return;for(var P=0,L=A-1;(w!==0||P<x)&&L!==-1;L--,P++)w+=o*k[L]>>>0,k[L]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");x=P,y++}for(var E=A-x;E!==A&&k[E]===0;)E++;for(var I=new Uint8Array(_+(A-E)),U=_;E!==A;)I[U++]=k[E++];return I}function h(d){var y=l(d);if(y)return y;throw new Error("Non-base"+o+" character")}return{encode:f,decodeUnsafe:l,decode:h}}var oc=sc;const ac=oc,cc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var uc=ac(cc),Fn=uc,fc=function(t){function e(s){var o=Uint8Array.from(s),a=t(o),c=o.length+4,u=new Uint8Array(c);return u.set(o,0),u.set(a.subarray(0,4),o.length),Fn.encode(u,c)}function n(s){var o=s.slice(0,-4),a=s.slice(-4),c=t(o);if(!(a[0]^c[0]|a[1]^c[1]|a[2]^c[2]|a[3]^c[3]))return o}function r(s){var o=Fn.decodeUnsafe(s);if(o)return n(o)}function i(s){var o=Fn.decode(s),a=n(o);if(!a)throw new Error("Invalid checksum");return a}return{encode:e,decode:i,decodeUnsafe:r}},{sha256:Hr}=gt,lc=fc;function hc(t){return Hr(Hr(t))}var dc=lc(hc);const cs=yr(dc),yn="automerge:",Nn=t=>{const{binaryDocumentId:e,documentId:n}=us(t);if(!e)throw new Error("Invalid document URL: "+t);return{binaryDocumentId:e,documentId:n}},In=({documentId:t})=>{if(t instanceof Uint8Array)return yn+yc(t);if(typeof t=="string")return yn+t;throw new Error("Invalid documentId: "+t)},Wr=t=>{if(!t.startsWith(yn))return!1;const{binaryDocumentId:e}=us(t);return!!e},gc=()=>In({documentId:ci(null,new Uint8Array(16))}),pc=t=>cs.decodeUnsafe(t),yc=t=>cs.encode(t),_c=t=>{if(ai(t)){const e=Ts(t);return In({documentId:e})}},us=t=>{const e=new RegExp(`^${yn}(\\w+)$`),[n,r]=t.match(e)||[],i=r;return{binaryDocumentId:pc(i),documentId:i}};let nr;try{nr=new TextDecoder}catch{}let B,qe,C=0;const bc=105,wc=57342,vc=57343,Kr=57337,Jr=6,rt={};let Y={},ae,_n,bn=0,Pt=0,fe,Re,ce=[],rr=[],we,_e,Ot,Gr={useRecords:!1,mapsAsObjects:!0},Ft=!1,fs=2;try{new Function("")}catch{fs=1/0}class Nt{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,i]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,i);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,i]of Object.entries(this._keyMap))this._mapKey.set(i,r)}let n={};return e.forEach((r,i)=>n[Ee(this._mapKey.has(i)?this._mapKey.get(i):i)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(i=>this.decodeKeys(i))}return r}decode(e,n){if(B)return gs(()=>(ar(),this?this.decode(e,n):Nt.prototype.decode.call(Gr,e,n)));qe=n>-1?n:e.length,C=0,Pt=0,_n=null,fe=null,B=e;try{_e=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw B=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Nt){if(Y=this,we=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return ae=this.structures,Xt();(!ae||ae.length>0)&&(ae=[])}else Y=Gr,(!ae||ae.length>0)&&(ae=[]),we=null;return Xt()}decodeMultiple(e,n){let r,i=0;try{let s=e.length;Ft=!0;let o=this?this.decode(e,s):Cr.decode(e,s);if(n){if(n(o)===!1)return;for(;C<s;)if(i=C,n(Xt())===!1)return}else{for(r=[o];C<s;)i=C,r.push(Xt());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{Ft=!1,ar()}}}function Xt(){try{let t=X();if(fe){if(C>=fe.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}C=fe.postBundlePosition,fe=null}if(C==qe)ae=null,B=null,Re&&(Re=null);else if(C>qe){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!Ft)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw ar(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function X(){let t=B[C++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=B[C++];break;case 25:if(e==7)return Ec();t=_e.getUint16(C),C+=2;break;case 26:if(e==7){let n=_e.getFloat32(C);if(Y.useFloat32>2){let r=kr[(B[C]&127)<<1|B[C+1]>>7];return C+=4,(r*n+(n>0?.5:-.5)>>0)/r}return C+=4,n}t=_e.getUint32(C),C+=4;break;case 27:if(e==7){let n=_e.getFloat64(C);return C+=8,n}if(e>1){if(_e.getUint32(C)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=_e.getUint32(C+4)}else Y.int64AsNumber?(t=_e.getUint32(C)*4294967296,t+=_e.getUint32(C+4)):t=_e.getBigUint64(C);C+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,i=0;for(;(r=X())!=rt;)n[i++]=r;return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let s;if(Y.mapsAsObjects){let o={};if(Y.keyMap)for(;(s=X())!=rt;)o[Ee(Y.decodeKey(s))]=X();else for(;(s=X())!=rt;)o[Ee(s)]=X();return o}else{Ot&&(Y.mapsAsObjects=!0,Ot=!1);let o=new Map;if(Y.keyMap)for(;(s=X())!=rt;)o.set(Y.decodeKey(s),X());else for(;(s=X())!=rt;)o.set(s,X());return o}case 7:return rt;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return Sc(t);case 3:if(Pt>=C)return _n.slice(C-bn,(C+=t)-bn);if(Pt==0&&qe<140&&t<32){let i=t<16?ls(t):xc(t);if(i!=null)return i}return mc(t);case 4:let n=new Array(t);for(let i=0;i<t;i++)n[i]=X();return n;case 5:if(Y.mapsAsObjects){let i={};if(Y.keyMap)for(let s=0;s<t;s++)i[Ee(Y.decodeKey(X()))]=X();else for(let s=0;s<t;s++)i[Ee(X())]=X();return i}else{Ot&&(Y.mapsAsObjects=!0,Ot=!1);let i=new Map;if(Y.keyMap)for(let s=0;s<t;s++)i.set(Y.decodeKey(X()),X());else for(let s=0;s<t;s++)i.set(X(),X());return i}case 6:if(t>=Kr){let i=ae[t&8191];if(i)return i.read||(i.read=ir(i)),i.read();if(t<65536){if(t==vc){let s=at(),o=X(),a=X();or(o,a);let c={};if(Y.keyMap)for(let u=2;u<s;u++){let f=Y.decodeKey(a[u-2]);c[Ee(f)]=X()}else for(let u=2;u<s;u++){let f=a[u-2];c[Ee(f)]=X()}return c}else if(t==wc){let s=at(),o=X();for(let a=2;a<s;a++)or(o++,X());return X()}else if(t==Kr)return Ic();if(Y.getShared&&(Ar(),i=ae[t&8191],i))return i.read||(i.read=ir(i)),i.read()}}let r=ce[t];if(r)return r.handlesRead?r(X):r(X());{let i=X();for(let s=0;s<rr.length;s++){let o=rr[s](t,i);if(o!==void 0)return o}return new Xe(i,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(we||Ge())[t];if(i!==void 0)return i;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+t)}}const qr=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ir(t){function e(){let n=B[C++];if(n=n&31,n>23)switch(n){case 24:n=B[C++];break;case 25:n=_e.getUint16(C),C+=2;break;case 26:n=_e.getUint32(C),C+=4;break;default:throw new Error("Expected array header, but got "+B[C-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(X);r=r.next}if(this.slowReads++>=fs){let s=this.length==n?this:this.slice(0,n);return r=Y.keyMap?new Function("r","return {"+s.map(o=>Y.decodeKey(o)).map(o=>qr.test(o)?Ee(o)+":r()":"["+JSON.stringify(o)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(o=>qr.test(o)?Ee(o)+":r()":"["+JSON.stringify(o)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(X)}let i={};if(Y.keyMap)for(let s=0;s<n;s++)i[Ee(Y.decodeKey(this[s]))]=X();else for(let s=0;s<n;s++)i[Ee(this[s])]=X();return i}return t.slowReads=0,e}function Ee(t){return t==="__proto__"?"__proto_":t}let mc=sr;function sr(t){let e;if(t<16&&(e=ls(t)))return e;if(t>64&&nr)return nr.decode(B.subarray(C,C+=t));const n=C+t,r=[];for(e="";C<n;){const i=B[C++];if(!(i&128))r.push(i);else if((i&224)===192){const s=B[C++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=B[C++]&63,o=B[C++]&63;r.push((i&31)<<12|s<<6|o)}else if((i&248)===240){const s=B[C++]&63,o=B[C++]&63,a=B[C++]&63;let c=(i&7)<<18|s<<12|o<<6|a;c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|c&1023),r.push(c)}else r.push(i);r.length>=4096&&(e+=he.apply(String,r),r.length=0)}return r.length>0&&(e+=he.apply(String,r)),e}let he=String.fromCharCode;function xc(t){let e=C,n=new Array(t);for(let r=0;r<t;r++){const i=B[C++];if((i&128)>0){C=e;return}n[r]=i}return he.apply(String,n)}function ls(t){if(t<4)if(t<2){if(t===0)return"";{let e=B[C++];if((e&128)>1){C-=1;return}return he(e)}}else{let e=B[C++],n=B[C++];if((e&128)>0||(n&128)>0){C-=2;return}if(t<3)return he(e,n);let r=B[C++];if((r&128)>0){C-=3;return}return he(e,n,r)}else{let e=B[C++],n=B[C++],r=B[C++],i=B[C++];if((e&128)>0||(n&128)>0||(r&128)>0||(i&128)>0){C-=4;return}if(t<6){if(t===4)return he(e,n,r,i);{let s=B[C++];if((s&128)>0){C-=5;return}return he(e,n,r,i,s)}}else if(t<8){let s=B[C++],o=B[C++];if((s&128)>0||(o&128)>0){C-=6;return}if(t<7)return he(e,n,r,i,s,o);let a=B[C++];if((a&128)>0){C-=7;return}return he(e,n,r,i,s,o,a)}else{let s=B[C++],o=B[C++],a=B[C++],c=B[C++];if((s&128)>0||(o&128)>0||(a&128)>0||(c&128)>0){C-=8;return}if(t<10){if(t===8)return he(e,n,r,i,s,o,a,c);{let u=B[C++];if((u&128)>0){C-=9;return}return he(e,n,r,i,s,o,a,c,u)}}else if(t<12){let u=B[C++],f=B[C++];if((u&128)>0||(f&128)>0){C-=10;return}if(t<11)return he(e,n,r,i,s,o,a,c,u,f);let l=B[C++];if((l&128)>0){C-=11;return}return he(e,n,r,i,s,o,a,c,u,f,l)}else{let u=B[C++],f=B[C++],l=B[C++],h=B[C++];if((u&128)>0||(f&128)>0||(l&128)>0||(h&128)>0){C-=12;return}if(t<14){if(t===12)return he(e,n,r,i,s,o,a,c,u,f,l,h);{let d=B[C++];if((d&128)>0){C-=13;return}return he(e,n,r,i,s,o,a,c,u,f,l,h,d)}}else{let d=B[C++],y=B[C++];if((d&128)>0||(y&128)>0){C-=14;return}if(t<15)return he(e,n,r,i,s,o,a,c,u,f,l,h,d,y);let _=B[C++];if((_&128)>0){C-=15;return}return he(e,n,r,i,s,o,a,c,u,f,l,h,d,y,_)}}}}}function Sc(t){return Y.copyBuffers?Uint8Array.prototype.slice.call(B,C,C+=t):B.subarray(C,C+=t)}let hs=new Float32Array(1),Yt=new Uint8Array(hs.buffer,0,4);function Ec(){let t=B[C++],e=B[C++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return Yt[3]=t&128|(n>>1)+56,Yt[2]=(t&7)<<5|e>>3,Yt[1]=e<<5,Yt[0]=0,hs[0]}new Array(4096);class Xe{constructor(e,n){this.value=e,this.tag=n}}ce[0]=t=>new Date(t);ce[1]=t=>new Date(Math.round(t*1e3));ce[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+e<<BigInt(8);return e};ce[3]=t=>BigInt(-1)-ce[2](t);ce[4]=t=>+(t[1]+"e"+t[0]);ce[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const or=(t,e)=>{t=t-57344;let n=ae[t];n&&n.isShared&&((ae.restoreStructures||(ae.restoreStructures=[]))[t]=n),ae[t]=e,e.read=ir(e)};ce[bc]=t=>{let e=t.length,n=t[1];or(t[0],n);let r={};for(let i=2;i<e;i++){let s=n[i-2];r[Ee(s)]=t[i]}return r};ce[14]=t=>fe?fe[0].slice(fe.position0,fe.position0+=t):new Xe(t,14);ce[15]=t=>fe?fe[1].slice(fe.position1,fe.position1+=t):new Xe(t,15);let Ac={Error,RegExp};ce[27]=t=>(Ac[t[0]]||Error)(t[1],t[2]);const ds=t=>{if(B[C++]!=132)throw new Error("Packed values structure must be followed by a 4 element array");let e=t();return we=we?e.concat(we.slice(e.length)):e,we.prefixes=t(),we.suffixes=t(),t()};ds.handlesRead=!0;ce[51]=ds;ce[Jr]=t=>{if(!we)if(Y.getShared)Ar();else return new Xe(t,Jr);if(typeof t=="number")return we[16+(t>=0?2*t:-2*t-1)];throw new Error("No support for non-integer packed references yet")};ce[28]=t=>{Re||(Re=new Map,Re.id=0);let e=Re.id++,n=B[C],r;n>>5==4?r=[]:r={};let i={target:r};Re.set(e,i);let s=t();return i.used?Object.assign(r,s):(i.target=s,s)};ce[28].handlesRead=!0;ce[29]=t=>{let e=Re.get(t);return e.used=!0,e.target};ce[258]=t=>new Set(t);(ce[259]=t=>(Y.mapsAsObjects&&(Y.mapsAsObjects=!1,Ot=!0),t())).handlesRead=!0;function it(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Ge(){if(!we)if(Y.getShared)Ar();else throw new Error("No packed values available");return we}const kc=1399353956;rr.push((t,e)=>{if(t>=225&&t<=255)return it(Ge().prefixes[t-224],e);if(t>=28704&&t<=32767)return it(Ge().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return it(Ge().prefixes[t-1879048192],e);if(t>=216&&t<=223)return it(e,Ge().suffixes[t-216]);if(t>=27647&&t<=28671)return it(e,Ge().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return it(e,Ge().suffixes[t-1811939328]);if(t==kc)return{packedValues:we,structures:ae.slice(0),version:e};if(t==55799)return e});const Cc=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,Xr=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Oc=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<Xr.length;t++)Rc(Xr[t],Oc[t]);function Rc(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let i=0;i<2;i++){if(!i&&r==1)continue;let s=r==2?1:r==4?2:3;ce[i?e:e-4]=r==1||i==Cc?o=>{if(!t)throw new Error("Could not find typed array for code "+e);return new t(Uint8Array.prototype.slice.call(o,0).buffer)}:o=>{if(!t)throw new Error("Could not find typed array for code "+e);let a=new DataView(o.buffer,o.byteOffset,o.byteLength),c=o.length>>s,u=new t(c),f=a[n];for(let l=0;l<c;l++)u[l]=f.call(a,l<<s,i);return u}}}function Ic(){let t=at(),e=C+X();for(let r=2;r<t;r++){let i=at();C+=i}let n=C;return C=e,fe=[sr(at()),sr(at())],fe.position0=0,fe.position1=0,fe.postBundlePosition=C,C=n,X()}function at(){let t=B[C++]&31;if(t>23)switch(t){case 24:t=B[C++];break;case 25:t=_e.getUint16(C),C+=2;break;case 26:t=_e.getUint32(C),C+=4;break}return t}function Ar(){if(Y.getShared){let t=gs(()=>(B=null,Y.getShared()))||{},e=t.structures||[];Y.sharedVersion=t.version,we=Y.sharedValues=t.packedValues,ae===!0?Y.structures=ae=e:ae.splice.apply(ae,[0,e.length].concat(e))}}function gs(t){let e=qe,n=C,r=bn,i=Pt,s=_n,o=Re,a=fe,c=new Uint8Array(B.slice(0,qe)),u=ae,f=Y,l=Ft,h=t();return qe=e,C=n,bn=r,Pt=i,_n=s,Re=o,fe=a,B=c,Ft=l,ae=u,Y=f,_e=new DataView(B.buffer,B.byteOffset,B.byteLength),h}function ar(){B=null,Re=null,ae=null}const kr=new Array(147);for(let t=0;t<256;t++)kr[t]=+("1e"+Math.floor(45.15-t*.30103));let Cr=new Nt({useRecords:!1});const ps=Cr.decode;Cr.decodeMultiple;let sn;try{sn=new TextEncoder}catch{}let cr,ys;const Tn=typeof globalThis=="object"&&globalThis.Buffer,zt=typeof Tn<"u",Ln=zt?Tn.allocUnsafeSlow:Uint8Array,Yr=zt?Tn:Uint8Array,Qr=256,Zr=zt?4294967296:2144337920;let Bn,v,ie,p=0,We,ue=null;const Tc=61440,jc=/[\u0080-\uFFFF]/,ve=Symbol("record-id");class _s extends Nt{constructor(e){super(e),this.offset=0;let n,r,i,s,o;e=e||{};let a=Yr.prototype.utf8Write?function(b,F,R){return v.utf8Write(b,F,R)}:sn&&sn.encodeInto?function(b,F){return sn.encodeInto(b,v.subarray(F)).written}:!1,c=this,u=e.structures||e.saveStructures,f=e.maxSharedStructures;if(f==null&&(f=u?128:0),f>8190)throw new Error("Maximum maxSharedStructure is 8190");let l=e.sequential;l&&(f=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let h,d,y=e.sharedValues,_;if(y){_=Object.create(null);for(let b=0,F=y.length;b<F;b++)_[y[b]]=b}let x=[],A=0,k=0;this.mapEncode=function(b,F){if(this._keyMap&&!this._mapped)switch(b.constructor.name){case"Array":b=b.map(R=>this.encodeKeys(R));break}return this.encode(b,F)},this.encode=function(b,F){if(v||(v=new Ln(8192),ie=new DataView(v.buffer,0,8192),p=0),We=v.length-10,We-p<2048?(v=new Ln(v.length),ie=new DataView(v.buffer,0,v.length),We=v.length-10,p=0):F===ri&&(p=p+7&2147483640),n=p,c.useSelfDescribedHeader&&(ie.setUint32(p,3654940416),p+=3),o=c.structuredClone?new Map:null,c.bundleStrings&&typeof b!="string"?(ue=[],ue.size=1/0):ue=null,r=c.structures,r){if(r.uninitialized){let j=c.getShared()||{};c.structures=r=j.structures||[],c.sharedVersion=j.version;let O=c.sharedValues=j.packedValues;if(O){_={};for(let V=0,H=O.length;V<H;V++)_[O[V]]=V}}let R=r.length;if(R>f&&!l&&(R=f),!r.transitions){r.transitions=Object.create(null);for(let j=0;j<R;j++){let O=r[j];if(!O)continue;let V,H=r.transitions;for(let J=0,W=O.length;J<W;J++){H[ve]===void 0&&(H[ve]=j);let q=O[J];V=H[q],V||(V=H[q]=Object.create(null)),H=V}H[ve]=j|1048576}}l||(r.nextId=R)}if(i&&(i=!1),s=r||[],d=_,e.pack){let R=new Map;if(R.values=[],R.encoder=c,R.maxValues=e.maxPrivatePackedValues||(_?16:1/0),R.objectMap=_||!1,R.samplingPackedValues=h,on(b,R),R.values.length>0){v[p++]=216,v[p++]=51,Me(4);let j=R.values;w(j),Me(0),Me(0),d=Object.create(_||null);for(let O=0,V=j.length;O<V;O++)d[j[O]]=O}}Bn=F&zn;try{if(Bn)return;if(w(b),ue&&ni(n,w),c.offset=p,o&&o.idsToInsert){p+=o.idsToInsert.length*2,p>We&&L(p),c.offset=p;let R=Mc(v.subarray(n,p),o.idsToInsert);return o=null,R}return F&ri?(v.start=n,v.end=p,v):v.subarray(n,p)}finally{if(r){if(k<10&&k++,r.length>f&&(r.length=f),A>1e4)r.transitions=null,k=0,A=0,x.length>0&&(x=[]);else if(x.length>0&&!l){for(let R=0,j=x.length;R<j;R++)x[R][ve]=void 0;x=[]}}if(i&&c.saveShared){c.structures.length>f&&(c.structures=c.structures.slice(0,f));let R=v.subarray(n,p);return c.updateSharedData()===!1?c.encode(b):R}F&Pc&&(p=n)}},this.findCommonStringsToPack=()=>(h=new Map,_||(_=Object.create(null)),b=>{let F=b&&b.threshold||4,R=this.pack?b.maxPrivatePackedValues||16:0;y||(y=this.sharedValues=[]);for(let[j,O]of h)O.count>F&&(_[j]=R++,y.push(j),i=!0);for(;this.saveShared&&this.updateSharedData()===!1;);h=null});const w=b=>{p>We&&(v=L(p));var F=typeof b,R;if(F==="string"){if(d){let H=d[b];if(H>=0){H<16?v[p++]=H+224:(v[p++]=198,H&1?w(15-H>>1):w(H-16>>1));return}else if(h&&!e.pack){let J=h.get(b);J?J.count++:h.set(b,{count:1})}}let j=b.length;if(ue&&j>=4&&j<1024){if((ue.size+=j)>Tc){let J,W=(ue[0]?ue[0].length*3+ue[1].length:0)+10;p+W>We&&(v=L(p+W)),v[p++]=217,v[p++]=223,v[p++]=249,v[p++]=ue.position?132:130,v[p++]=26,J=p-n,p+=4,ue.position&&ni(n,w),ue=["",""],ue.size=0,ue.position=J}let H=jc.test(b);ue[H?0:1]+=b,v[p++]=H?206:207,w(j);return}let O;j<32?O=1:j<256?O=2:j<65536?O=3:O=5;let V=j*3;if(p+V>We&&(v=L(p+V)),j<64||!a){let H,J,W,q=p+O;for(H=0;H<j;H++)J=b.charCodeAt(H),J<128?v[q++]=J:J<2048?(v[q++]=J>>6|192,v[q++]=J&63|128):(J&64512)===55296&&((W=b.charCodeAt(H+1))&64512)===56320?(J=65536+((J&1023)<<10)+(W&1023),H++,v[q++]=J>>18|240,v[q++]=J>>12&63|128,v[q++]=J>>6&63|128,v[q++]=J&63|128):(v[q++]=J>>12|224,v[q++]=J>>6&63|128,v[q++]=J&63|128);R=q-p-O}else R=a(b,p+O,V);R<24?v[p++]=96|R:R<256?(O<2&&v.copyWithin(p+2,p+1,p+1+R),v[p++]=120,v[p++]=R):R<65536?(O<3&&v.copyWithin(p+3,p+2,p+2+R),v[p++]=121,v[p++]=R>>8,v[p++]=R&255):(O<5&&v.copyWithin(p+5,p+3,p+3+R),v[p++]=122,ie.setUint32(p,R),p+=4),p+=R}else if(F==="number")if(!this.alwaysUseFloat&&b>>>0===b)b<24?v[p++]=b:b<256?(v[p++]=24,v[p++]=b):b<65536?(v[p++]=25,v[p++]=b>>8,v[p++]=b&255):(v[p++]=26,ie.setUint32(p,b),p+=4);else if(!this.alwaysUseFloat&&b>>0===b)b>=-24?v[p++]=31-b:b>=-256?(v[p++]=56,v[p++]=~b):b>=-65536?(v[p++]=57,ie.setUint16(p,~b),p+=2):(v[p++]=58,ie.setUint32(p,~b),p+=4);else{let j;if((j=this.useFloat32)>0&&b<4294967296&&b>=-2147483648){v[p++]=250,ie.setFloat32(p,b);let O;if(j<4||(O=b*kr[(v[p]&127)<<1|v[p+1]>>7])>>0===O){p+=4;return}else p--}v[p++]=251,ie.setFloat64(p,b),p+=8}else if(F==="object")if(!b)v[p++]=246;else{if(o){let O=o.get(b);if(O){if(v[p++]=216,v[p++]=29,v[p++]=25,!O.references){let V=o.idsToInsert||(o.idsToInsert=[]);O.references=[],V.push(O)}O.references.push(p-n),p+=2;return}else o.set(b,{offset:p-n})}let j=b.constructor;if(j===Object)P(b,!0);else if(j===Array){R=b.length,R<24?v[p++]=128|R:Me(R);for(let O=0;O<R;O++)w(b[O])}else if(j===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(v[p++]=217,v[p++]=1,v[p++]=3),R=b.size,R<24?v[p++]=160|R:R<256?(v[p++]=184,v[p++]=R):R<65536?(v[p++]=185,v[p++]=R>>8,v[p++]=R&255):(v[p++]=186,ie.setUint32(p,R),p+=4),c.keyMap)for(let[O,V]of b)w(c.encodeKey(O)),w(V);else for(let[O,V]of b)w(O),w(V);else{for(let O=0,V=cr.length;O<V;O++){let H=ys[O];if(b instanceof H){let J=cr[O],W=J.tag;W==null&&(W=J.getTag&&J.getTag.call(this,b)),W<24?v[p++]=192|W:W<256?(v[p++]=216,v[p++]=W):W<65536?(v[p++]=217,v[p++]=W>>8,v[p++]=W&255):W>-1&&(v[p++]=218,ie.setUint32(p,W),p+=4),J.encode.call(this,b,w,L);return}}if(b[Symbol.iterator]){if(Bn){let O=new Error("Iterable should be serialized as iterator");throw O.iteratorNotHandled=!0,O}v[p++]=159;for(let O of b)w(O);v[p++]=255;return}if(b[Symbol.asyncIterator]||$n(b)){let O=new Error("Iterable/blob should be serialized as iterator");throw O.iteratorNotHandled=!0,O}if(this.useToJSON&&b.toJSON){const O=b.toJSON();if(O!==b)return w(O)}P(b,!b.hasOwnProperty)}}else if(F==="boolean")v[p++]=b?245:244;else if(F==="bigint"){if(b<BigInt(1)<<BigInt(64)&&b>=0)v[p++]=27,ie.setBigUint64(p,b);else if(b>-(BigInt(1)<<BigInt(64))&&b<0)v[p++]=59,ie.setBigUint64(p,-b-BigInt(1));else if(this.largeBigIntToFloat)v[p++]=251,ie.setFloat64(p,Number(b));else throw new RangeError(b+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");p+=8}else if(F==="undefined")v[p++]=247;else throw new Error("Unknown type: "+F)},P=this.useRecords===!1?this.variableMapSize?b=>{let F=Object.keys(b),R=Object.values(b),j=F.length;if(j<24?v[p++]=160|j:j<256?(v[p++]=184,v[p++]=j):j<65536?(v[p++]=185,v[p++]=j>>8,v[p++]=j&255):(v[p++]=186,ie.setUint32(p,j),p+=4),c.keyMap)for(let O=0;O<j;O++)w(c.encodeKey(F[O])),w(R[O]);else for(let O=0;O<j;O++)w(F[O]),w(R[O])}:(b,F)=>{v[p++]=185;let R=p-n;p+=2;let j=0;if(c.keyMap)for(let O in b)(F||b.hasOwnProperty(O))&&(w(c.encodeKey(O)),w(b[O]),j++);else for(let O in b)(F||b.hasOwnProperty(O))&&(w(O),w(b[O]),j++);v[R+++n]=j>>8,v[R+n]=j&255}:(b,F)=>{let R,j=s.transitions||(s.transitions=Object.create(null)),O=0,V=0,H,J;if(this.keyMap){J=Object.keys(b).map(q=>this.encodeKey(q)),V=J.length;for(let q=0;q<V;q++){let Vt=J[q];R=j[Vt],R||(R=j[Vt]=Object.create(null),O++),j=R}}else for(let q in b)(F||b.hasOwnProperty(q))&&(R=j[q],R||(j[ve]&1048576&&(H=j[ve]&65535),R=j[q]=Object.create(null),O++),j=R,V++);let W=j[ve];if(W!==void 0)W&=65535,v[p++]=217,v[p++]=W>>8|224,v[p++]=W&255;else if(J||(J=j.__keys__||(j.__keys__=Object.keys(b))),H===void 0?(W=s.nextId++,W||(W=0,s.nextId=1),W>=Qr&&(s.nextId=(W=f)+1)):W=H,s[W]=J,W<f){v[p++]=217,v[p++]=W>>8|224,v[p++]=W&255,j=s.transitions;for(let q=0;q<V;q++)(j[ve]===void 0||j[ve]&1048576)&&(j[ve]=W),j=j[J[q]];j[ve]=W|1048576,i=!0}else{if(j[ve]=W,ie.setUint32(p,3655335680),p+=3,O&&(A+=k*O),x.length>=Qr-f&&(x.shift()[ve]=void 0),x.push(j),Me(V+2),w(57344+W),w(J),F===null)return;for(let q in b)(F||b.hasOwnProperty(q))&&w(b[q]);return}if(V<24?v[p++]=128|V:Me(V),F!==null)for(let q in b)(F||b.hasOwnProperty(q))&&w(b[q])},L=b=>{let F;if(b>16777216){if(b-n>Zr)throw new Error("Encoded buffer would be larger than maximum buffer size");F=Math.min(Zr,Math.round(Math.max((b-n)*(b>67108864?1.25:2),4194304)/4096)*4096)}else F=(Math.max(b-n<<2,v.length-1)>>12)+1<<12;let R=new Ln(F);return ie=new DataView(R.buffer,0,F),v.copy?v.copy(R,0,n,b):R.set(v.slice(n,b)),p-=n,n=0,We=R.length-10,v=R};let E=100,I=1e3;this.encodeAsIterable=function(b,F){return z(b,F,U)},this.encodeAsAsyncIterable=function(b,F){return z(b,F,K)};function*U(b,F,R){let j=b.constructor;if(j===Object){let O=c.useRecords!==!1;O?P(b,null):ei(Object.keys(b).length,160);for(let V in b){let H=b[V];O||w(V),H&&typeof H=="object"?F[V]?yield*U(H,F[V]):yield*M(H,F,V):w(H)}}else if(j===Array){let O=b.length;Me(O);for(let V=0;V<O;V++){let H=b[V];H&&(typeof H=="object"||p-n>E)?F.element?yield*U(H,F.element):yield*M(H,F,"element"):w(H)}}else if(b[Symbol.iterator]){v[p++]=159;for(let O of b)O&&(typeof O=="object"||p-n>E)?F.element?yield*U(O,F.element):yield*M(O,F,"element"):w(O);v[p++]=255}else $n(b)?(ei(b.size,64),yield v.subarray(n,p),yield b,$()):b[Symbol.asyncIterator]?(v[p++]=159,yield v.subarray(n,p),yield b,$(),v[p++]=255):w(b);R&&p>n?yield v.subarray(n,p):p-n>E&&(yield v.subarray(n,p),$())}function*M(b,F,R){let j=p-n;try{w(b),p-n>E&&(yield v.subarray(n,p),$())}catch(O){if(O.iteratorNotHandled)F[R]={},p=n+j,yield*U.call(this,b,F[R]);else throw O}}function $(){E=I,c.encode(null,zn)}function z(b,F,R){return F&&F.chunkThreshold?E=I=F.chunkThreshold:E=100,b&&typeof b=="object"?(c.encode(null,zn),R(b,c.iterateProperties||(c.iterateProperties={}),!0)):[c.encode(b)]}async function*K(b,F){for(let R of U(b,F,!0)){let j=R.constructor;if(j===Yr||j===Uint8Array)yield R;else if($n(R)){let O=R.stream().getReader(),V;for(;!(V=await O.read()).done;)yield V.value}else if(R[Symbol.asyncIterator])for await(let O of R)$(),O?yield*K(O,F.async||(F.async={})):yield c.encode(O);else yield R}}}useBuffer(e){v=e,ie=new DataView(v.buffer,v.byteOffset,v.byteLength),p=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new bs(n,this.sharedValues,this.sharedVersion),i=this.saveShared(r,s=>(s&&s.version||0)==e);return i===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((s,o)=>this.structures[o]=s),i}}function ei(t,e){t<24?v[p++]=e|t:t<256?(v[p++]=e|24,v[p++]=t):t<65536?(v[p++]=e|25,v[p++]=t>>8,v[p++]=t&255):(v[p++]=e|26,ie.setUint32(p,t),p+=4)}class bs{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function Me(t){t<24?v[p++]=128|t:t<256?(v[p++]=152,v[p++]=t):t<65536?(v[p++]=153,v[p++]=t>>8,v[p++]=t&255):(v[p++]=154,ie.setUint32(p,t),p+=4)}const Uc=typeof Blob>"u"?function(){}:Blob;function $n(t){if(t instanceof Uc)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function on(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(t);i?i.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,i=t.length;r<i;r++)on(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&on(n,e),on(t[n],e))}break;case"function":console.log(t)}}const Dc=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;ys=[Date,Set,Error,RegExp,Xe,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,bs];cr=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(v[p++]=26,ie.setUint32(p,n),p+=4):(v[p++]=251,ie.setFloat64(p,n),p+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){ti(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||zt&&this.tagUint8Array!==!1))return 64},encode(t,e,n){ti(t,n)}},Ue(68,1),Ue(69,2),Ue(70,4),Ue(71,8),Ue(72,1),Ue(77,2),Ue(78,4),Ue(79,8),Ue(85,4),Ue(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){v[p++]=216,v[p++]=51,Me(4);let i=n.values;e(i),Me(0),Me(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,o=i.length;s<o;s++)packedObjectMap[i[s]]=s}if(r){ie.setUint32(p,3655335424),p+=3;let i=r.slice(0);i.unshift(57344),i.push(new Xe(t.version,1399353956)),e(i)}else e(new Xe(t.version,1399353956))}}];function Ue(t,e){return!Dc&&e>1&&(t-=4),{tag:t,encode:function(r,i){let s=r.byteLength,o=r.byteOffset||0,a=r.buffer||r;i(zt?Tn.from(a,o,s):new Uint8Array(a,o,s))}}}function ti(t,e){let n=t.byteLength;n<24?v[p++]=64+n:n<256?(v[p++]=88,v[p++]=n):n<65536?(v[p++]=89,v[p++]=n>>8,v[p++]=n&255):(v[p++]=90,ie.setUint32(p,n),p+=4),p+n>=v.length&&e(p+n),v.set(t.buffer?t:new Uint8Array(t),p),p+=n}function Mc(t,e){let n,r=e.length*2,i=t.length-r;e.sort((s,o)=>s.offset>o.offset?1:-1);for(let s=0;s<e.length;s++){let o=e[s];o.id=s;for(let a of o.references)t[a++]=s>>8,t[a]=s&255}for(;n=e.pop();){let s=n.offset;t.copyWithin(s+r,s,i),r-=2;let o=s+r;t[o++]=216,t[o++]=28,i=s}return t}function ni(t,e){ie.setUint32(ue.position+t,p-ue.position-t+1);let n=ue;ue=null,e(n[0]),e(n[1])}let Or=new _s({useRecords:!1});Or.encode;Or.encodeAsIterable;Or.encodeAsAsyncIterable;const ri=512,Pc=1024,zn=2048;function Fc(t){return new _s({tagUint8Array:!1}).encode(t)}function yu(t){return ps(t)}const Nc=(t,e)=>t.length===e.length&&t.every((n,r)=>n===e[r]),ws=(t,e)=>Nc(t,e),Lc=async(t,e)=>{let n;const r=new Promise((i,s)=>{n=setTimeout(()=>s(new Bc(`withTimeout: timed out after ${e}ms`)),e)});try{return await Promise.race([t,r])}finally{clearTimeout(n)}};class Bc extends Error{constructor(e){super(e),this.name="TimeoutError"}}class $c extends Qe{documentId;#t;#e;#n;get url(){return In({documentId:this.documentId})}constructor(e,{isNew:n=!1,timeoutDelay:r=6e4}={}){super(),this.documentId=e,this.#n=r,this.#t=Ye(`automerge-repo:dochandle:${this.documentId.slice(0,5)}`);let i=En();n&&(i=mi(i,{})),this.#e=es(Ja({predictableActionArguments:!0,id:"docHandle",initial:Vc,context:{documentId:this.documentId,doc:i},states:{idle:{on:{CREATE:{target:Pe},FIND:{target:Vn},DELETE:{actions:"onDelete",target:vt}}},loading:{on:{UPDATE:{actions:"onUpdate",target:Pe},REQUEST:{target:ct},AWAIT_NETWORK:{target:ii},DELETE:{actions:"onDelete",target:vt}},after:[{delay:this.#n,target:si}]},awaitingNetwork:{on:{NETWORK_READY:{target:ct}}},requesting:{on:{MARK_UNAVAILABLE:{target:wn,actions:"onUnavailable"},UPDATE:{actions:"onUpdate"},REQUEST_COMPLETE:{target:Pe},DELETE:{actions:"onDelete",target:vt}},after:[{delay:this.#n,target:si}]},ready:{on:{UPDATE:{actions:"onUpdate",target:Pe},DELETE:{actions:"onDelete",target:vt}}},failed:{type:"final"},deleted:{type:"final"},unavailable:{on:{UPDATE:{actions:"onUpdate"},REQUEST_COMPLETE:{target:Pe},DELETE:{actions:"onDelete",target:vt}}}}},{actions:{onUpdate:Mn((s,{payload:o})=>{const{doc:a}=s,{callback:c}=o;return{doc:c(a)}}),onDelete:Mn(()=>(this.emit("delete",{handle:this}),{doc:void 0})),onUnavailable:Mn(s=>{const{doc:o}=s;return this.emit("unavailable",{handle:this}),{doc:o}})}})).onTransition(({value:s,history:o,context:a},c)=>{const u=o?.context?.doc,f=a.doc;if(this.#t(`${o?.value}: ${c.type} → ${s}`,f),f&&u&&!ws(ke(f),ke(u))){this.emit("heads-changed",{handle:this,doc:f});const h=Ci(f,ke(u),ke(f));if(h.length>0){const d="change";this.emit("change",{handle:this,doc:f,patches:h,patchInfo:{before:u,after:f,source:d}})}this.isReady()||this.#e.send(Gc)}}).start(),this.#e.send(n?Hc:Wc)}get#s(){return this.#e?.getSnapshot().context.doc}get#r(){return this.#e?.getSnapshot().value}#i(e){return Array.isArray(e)||(e=[e]),Promise.any(e.map(n=>Xa(this.#e,r=>r.matches(n),{timeout:this.#n*2e3})))}isReady=()=>this.inState([an.READY]);isDeleted=()=>this.inState([an.DELETED]);isUnavailable=()=>this.inState([an.UNAVAILABLE]);inState=e=>e.some(this.#e?.getSnapshot().matches);get state(){return this.#e?.getSnapshot().value}async whenReady(e=[Pe]){await Lc(this.#i(e),this.#n)}async doc(e=[Pe,wn]){try{await this.#i(e)}catch{return}return this.isUnavailable()?void 0:this.#s}docSync(){if(this.isReady())return this.#s}update(e){this.#e.send(Hn,{payload:{callback:e}})}change(e,n={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);this.#e.send(Hn,{payload:{callback:r=>wi(r,n,e)}})}changeAt(e,n,r={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);let i;return this.#e.send(Hn,{payload:{callback:s=>{const o=vi(s,e,r,n);return i=o.newHeads,o.newDoc}}}),i}merge(e){if(!this.isReady()||!e.isReady())throw new Error("Both handles must be ready to merge");const n=e.docSync();if(!n)throw new Error("The document to be merged in is null, aborting.");this.update(r=>Si(r,n))}unavailable(){this.#e.send(qc)}request(){this.#r===Vn&&this.#e.send(Kc)}awaitNetwork(){this.#r===Vn&&this.#e.send(Xc)}networkReady(){this.#r===ii&&this.#e.send(Yc)}delete(){this.#e.send(Jc)}broadcast(e){this.emit("ephemeral-message-outbound",{handle:this,data:Fc(e)})}}const an={IDLE:"idle",LOADING:"loading",AWAITING_NETWORK:"awaitingNetwork",REQUESTING:"requesting",READY:"ready",FAILED:"failed",DELETED:"deleted",UNAVAILABLE:"unavailable"},zc={CREATE:"CREATE",FIND:"FIND",REQUEST:"REQUEST",REQUEST_COMPLETE:"REQUEST_COMPLETE",AWAIT_NETWORK:"AWAIT_NETWORK",NETWORK_READY:"NETWORK_READY",UPDATE:"UPDATE",TIMEOUT:"TIMEOUT",DELETE:"DELETE",MARK_UNAVAILABLE:"MARK_UNAVAILABLE"},{IDLE:Vc,LOADING:Vn,AWAITING_NETWORK:ii,REQUESTING:ct,READY:Pe,FAILED:si,DELETED:vt,UNAVAILABLE:wn}=an,{CREATE:Hc,FIND:Wc,REQUEST:Kc,UPDATE:Hn,TIMEOUT:_u,DELETE:Jc,REQUEST_COMPLETE:Gc,MARK_UNAVAILABLE:qc,AWAIT_NETWORK:Xc,NETWORK_READY:Yc}=zc,vs=(t,e)=>{let n=Date.now(),r,i;return function(...s){r=n+e-Date.now(),clearTimeout(i),i=setTimeout(()=>{t.apply(null,s),n=Date.now()},r)}},Qc=t=>typeof t=="object"&&typeof t.type=="string"&&typeof t.senderId=="string"&&(eu(t)||xs(t)||ms(t)||Zc(t)),Zc=t=>t.type==="doc-unavailable",ms=t=>t.type==="request",eu=t=>t.type==="sync",xs=t=>t.type==="ephemeral",tu=t=>`${t.senderId}:${t.sessionId}`;class nu extends Qe{peerId;#t;#e={};#n=0;#s=Math.random().toString(36).slice(2);#r={};#i=0;#o=[];constructor(e,n=ru()){super(),this.peerId=n,this.#t=Ye(`automerge-repo:network:${this.peerId}`),e.forEach(r=>this.addNetworkAdapter(r))}addNetworkAdapter(e){this.#o.push(e),e.once("ready",()=>{this.#i++,this.#t("Adapters ready: ",this.#i,"/",this.#o.length),this.#i===this.#o.length&&this.emit("ready")}),e.on("peer-candidate",({peerId:n})=>{this.#t(`peer candidate: ${n} `),this.#e[n]||(this.#e[n]=e),this.emit("peer",{peerId:n})}),e.on("peer-disconnected",({peerId:n})=>{this.#t(`peer disconnected: ${n} `),delete this.#e[n],this.emit("peer-disconnected",{peerId:n})}),e.on("message",n=>{if(!Qc(n)){this.#t(`invalid message: ${JSON.stringify(n)}`);return}if(this.#t(`message from ${n.senderId}`),xs(n)){const r=tu(n);(this.#r[r]===void 0||n.count>this.#r[r])&&(this.#r[r]=n.count,this.emit("message",n));return}this.emit("message",n)}),e.on("close",()=>{this.#t("adapter closed"),Object.entries(this.#e).forEach(([n,r])=>{r===e&&delete this.#e[n]})}),e.connect(this.peerId)}send(e){const n=this.#e[e.targetId];if(!n){this.#t(`Tried to send message but peer not found: ${e.targetId}`);return}const i=(s=>s.type==="ephemeral"?"count"in s?s:{...s,count:++this.#n,sessionId:this.#s,senderId:this.peerId}:{...s,senderId:this.peerId})(e);this.#t("sending message",i),n.send(i)}isReady=()=>this.#i===this.#o.length;whenReady=async()=>{if(!this.isReady())return new Promise(e=>{this.once("ready",()=>{e()})})}}function ru(){return`user-${Math.round(Math.random()*1e5)}`}var Ss={exports:{}};(function(t){(function(e,n){var r={};n(r);var i=r.default;for(var s in r)i[s]=r[s];t.exports=i})(Jo,function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(h,d,y,_,x){for(var A,k,w,P,L,E,I,U,M,$,z,K,b;x>=64;){for(A=d[0],k=d[1],w=d[2],P=d[3],L=d[4],E=d[5],I=d[6],U=d[7],$=0;$<16;$++)z=_+$*4,h[$]=(y[z]&255)<<24|(y[z+1]&255)<<16|(y[z+2]&255)<<8|y[z+3]&255;for($=16;$<64;$++)M=h[$-2],K=(M>>>17|M<<32-17)^(M>>>19|M<<32-19)^M>>>10,M=h[$-15],b=(M>>>7|M<<32-7)^(M>>>18|M<<32-18)^M>>>3,h[$]=(K+h[$-7]|0)+(b+h[$-16]|0);for($=0;$<64;$++)K=(((L>>>6|L<<32-6)^(L>>>11|L<<32-11)^(L>>>25|L<<32-25))+(L&E^~L&I)|0)+(U+(n[$]+h[$]|0)|0)|0,b=((A>>>2|A<<32-2)^(A>>>13|A<<32-13)^(A>>>22|A<<32-22))+(A&k^A&w^k&w)|0,U=I,I=E,E=L,L=P+K|0,P=w,w=k,k=A,A=K+b|0;d[0]+=A,d[1]+=k,d[2]+=w,d[3]+=P,d[4]+=L,d[5]+=E,d[6]+=I,d[7]+=U,_+=64,x-=64}return _}var i=function(){function h(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return h.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},h.prototype.clean=function(){for(var d=0;d<this.buffer.length;d++)this.buffer[d]=0;for(var d=0;d<this.temp.length;d++)this.temp[d]=0;this.reset()},h.prototype.update=function(d,y){if(y===void 0&&(y=d.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this.bytesHashed+=y,this.bufferLength>0){for(;this.bufferLength<64&&y>0;)this.buffer[this.bufferLength++]=d[_++],y--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(y>=64&&(_=r(this.temp,this.state,d,_,y),y%=64);y>0;)this.buffer[this.bufferLength++]=d[_++],y--;return this},h.prototype.finish=function(d){if(!this.finished){var y=this.bytesHashed,_=this.bufferLength,x=y/536870912|0,A=y<<3,k=y%64<56?64:128;this.buffer[_]=128;for(var w=_+1;w<k-8;w++)this.buffer[w]=0;this.buffer[k-8]=x>>>24&255,this.buffer[k-7]=x>>>16&255,this.buffer[k-6]=x>>>8&255,this.buffer[k-5]=x>>>0&255,this.buffer[k-4]=A>>>24&255,this.buffer[k-3]=A>>>16&255,this.buffer[k-2]=A>>>8&255,this.buffer[k-1]=A>>>0&255,r(this.temp,this.state,this.buffer,0,k),this.finished=!0}for(var w=0;w<8;w++)d[w*4+0]=this.state[w]>>>24&255,d[w*4+1]=this.state[w]>>>16&255,d[w*4+2]=this.state[w]>>>8&255,d[w*4+3]=this.state[w]>>>0&255;return this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h.prototype._saveState=function(d){for(var y=0;y<this.state.length;y++)d[y]=this.state[y]},h.prototype._restoreState=function(d,y){for(var _=0;_<this.state.length;_++)this.state[_]=d[_];this.bytesHashed=y,this.finished=!1,this.bufferLength=0},h}();e.Hash=i;var s=function(){function h(d){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var y=new Uint8Array(this.blockSize);if(d.length>this.blockSize)new i().update(d).finish(y).clean();else for(var _=0;_<d.length;_++)y[_]=d[_];for(var _=0;_<y.length;_++)y[_]^=54;this.inner.update(y);for(var _=0;_<y.length;_++)y[_]^=106;this.outer.update(y),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var _=0;_<y.length;_++)y[_]=0}return h.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},h.prototype.clean=function(){for(var d=0;d<this.istate.length;d++)this.ostate[d]=this.istate[d]=0;this.inner.clean(),this.outer.clean()},h.prototype.update=function(d){return this.inner.update(d),this},h.prototype.finish=function(d){return this.outer.finished?this.outer.finish(d):(this.inner.finish(d),this.outer.update(d,this.digestLength).finish(d)),this},h.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},h}();e.HMAC=s;function o(h){var d=new i().update(h),y=d.digest();return d.clean(),y}e.hash=o,e.default=o;function a(h,d){var y=new s(h).update(d),_=y.digest();return y.clean(),_}e.hmac=a;function c(h,d,y,_){var x=_[0];if(x===0)throw new Error("hkdf: cannot expand more");d.reset(),x>1&&d.update(h),y&&d.update(y),d.update(_),d.finish(h),_[0]++}var u=new Uint8Array(e.digestLength);function f(h,d,y,_){d===void 0&&(d=u),_===void 0&&(_=32);for(var x=new Uint8Array([1]),A=a(d,h),k=new s(A),w=new Uint8Array(k.digestLength),P=w.length,L=new Uint8Array(_),E=0;E<_;E++)P===w.length&&(c(w,k,y,x),P=0),L[E]=w[P++];return k.clean(),w.fill(0),x.fill(0),L}e.hkdf=f;function l(h,d,y,_){for(var x=new s(h),A=x.digestLength,k=new Uint8Array(4),w=new Uint8Array(A),P=new Uint8Array(A),L=new Uint8Array(_),E=0;E*A<_;E++){var I=E+1;k[0]=I>>>24&255,k[1]=I>>>16&255,k[2]=I>>>8&255,k[3]=I>>>0&255,x.reset(),x.update(d),x.update(k),x.finish(P);for(var U=0;U<A;U++)w[U]=P[U];for(var U=2;U<=y;U++){x.reset(),x.update(P).finish(P);for(var M=0;M<A;M++)w[M]^=P[M]}for(var U=0;U<A&&E*A+U<_;U++)L[E*A+U]=w[U]}for(var E=0;E<A;E++)w[E]=P[E]=0;for(var E=0;E<4;E++)k[E]=0;return x.clean(),L}e.pbkdf2=l})})(Ss);var iu=Ss.exports;function Es(t){let e=0;t.forEach(i=>{e+=i.length});const n=new Uint8Array(e);let r=0;return t.forEach(i=>{n.set(i,r),r+=i.length}),n}function As(t){const e=iu.hash(t);return Array.from(new Uint8Array(e)).map(i=>("00"+i.toString(16)).slice(-2)).join("")}function su(t){const e=new TextEncoder,n=Es(t.map(r=>e.encode(r)));return As(n)}class ou{#t;#e=new Map;#n=new Map;#s=Ye("automerge-repo:storage-subsystem");#r=!1;constructor(e){this.#t=e}async#i(e,n){const r=Mi(n,this.#n.get(e)??[]);if(r&&r.length>0){const i=[e,"incremental",As(r)];this.#s(`Saving incremental ${i} for document ${e}`),await this.#t.save(i,r),this.#e.has(e)||this.#e.set(e,[]),this.#e.get(e).push({key:i,type:"incremental",size:r.length}),this.#n.set(e,ke(n))}else return Promise.resolve()}async#o(e,n,r){this.#r=!0;const i=xi(n),s=su(ke(n)),o=[e,"snapshot",s],a=new Set(r.map(u=>u.key).filter(u=>u[2]!==s));this.#s(`Saving snapshot ${o} for document ${e}`),this.#s(`deleting old chunks ${Array.from(a)}`),await this.#t.save(o,i);for(const u of a)await this.#t.remove(u);const c=this.#e.get(e)?.filter(u=>!a.has(u.key))??[];c.push({key:o,type:"snapshot",size:i.length}),this.#e.set(e,c),this.#r=!1}async loadDoc(e){const n=await this.#t.loadRange([e]),r=[],i=[];for(const a of n){const c=au(a.key);c!=null&&(i.push({key:a.key,type:c,size:a.data.length}),r.push(a.data))}this.#e.set(e,i);const s=Es(r);if(s.length===0)return null;const o=pr(En(),s);return this.#n.set(e,ke(o)),o}async saveDoc(e,n){if(!this.#c(e,n))return;const r=this.#e.get(e)??[];this.#u(r)?this.#o(e,n,r):this.#i(e,n),this.#n.set(e,ke(n))}async remove(e){this.#t.removeRange([e,"snapshot"]),this.#t.removeRange([e,"incremental"])}#c(e,n){const r=this.#n.get(e);if(!r)return!0;const i=ke(n);return!ws(i,r)}#u(e){if(this.#r)return!1;let n=0,r=0;for(const i of e)i.type==="snapshot"?n+=i.size:r+=i.size;return r>=n}}function au(t){if(t.length<2)return null;const e=t[t.length-2];return e==="snapshot"||e==="incremental"?e:null}class ks extends Qe{}class cu extends ks{handle;#t;syncDebounceRate=100;#e=[];#n={};#s={};#r=[];#i=!1;constructor(e){super(),this.handle=e;const n=e.documentId.slice(0,5);this.#t=Ye(`automerge-repo:docsync:${n}`),e.on("change",vs(()=>this.#o(),this.syncDebounceRate)),e.on("ephemeral-message-outbound",r=>this.#c(r)),(async()=>(await e.doc([Pe,ct]),this.#g()))()}get peerStates(){return this.#n}get documentId(){return this.handle.documentId}async#o(){this.#t("syncWithPeers");const e=await this.handle.doc();e!==void 0&&this.#e.forEach(n=>this.#h(n,e))}async#c({data:e}){this.#t("broadcastToPeers",this.#e),this.#e.forEach(n=>this.#u(n,e))}#u(e,n){this.#t(`sendEphemeralMessage ->${e}`);const r={type:"ephemeral",targetId:e,documentId:this.handle.documentId,data:n};this.emit("message",r)}#f(e){return this.#e.includes(e)||(this.#t("adding a new peer",e),this.#e.push(e)),e in this.#n||(this.#n[e]="unknown"),this.#s[e]??ji()}#l(e,n){this.#s[e]=n}#h(e,n){this.#t(`sendSyncMessage ->${e}`);const r=this.#f(e),[i,s]=Ii(n,r);if(this.#l(e,i),s){const o=ke(n).length===0;!this.handle.isReady()&&o&&i.sharedHeads.length===0&&!Object.values(this.#n).includes("has")&&this.#n[e]==="unknown"?this.emit("message",{type:"request",targetId:e,documentId:this.handle.documentId,data:s}):this.emit("message",{type:"sync",targetId:e,data:s,documentId:this.handle.documentId}),o||(this.#n[e]="has")}}hasPeer(e){return this.#e.includes(e)}beginSync(e){const n=new Set(e.filter(r=>!this.#e.includes(r)));this.#t(`beginSync: ${e.join(", ")}`),e.forEach(r=>{const i=this.#f(r),s=Ri(Oi(i));this.#l(r,s)}),this.handle.doc([Pe,ct,wn]).then(r=>{if(this.#i=!0,this.#a(),r===void 0&&n.size==0)return;const s=r??En();e.forEach(o=>{this.#h(o,s)})})}endSync(e){this.#t(`removing peer ${e}`),this.#e=this.#e.filter(n=>n!==e)}receiveMessage(e){switch(e.type){case"sync":case"request":this.receiveSyncMessage(e);break;case"ephemeral":this.receiveEphemeralMessage(e);break;case"doc-unavailable":this.#n[e.senderId]="unavailable",this.#a();break;default:throw new Error(`unknown message type: ${e}`)}}receiveEphemeralMessage(e){if(e.documentId!==this.handle.documentId)throw new Error("channelId doesn't match documentId");const{senderId:n,data:r}=e,i=ps(new Uint8Array(r));this.handle.emit("ephemeral-message",{handle:this.handle,senderId:n,message:i}),this.#e.forEach(s=>{s!==n&&this.emit("message",{...e,targetId:s})})}receiveSyncMessage(e){if(e.documentId!==this.handle.documentId)throw new Error("channelId doesn't match documentId");if(!this.handle.inState([Pe,ct,wn])){this.#r.push(e);return}this.#g(),this.#d(e)}#d(e){ms(e)&&(this.#n[e.senderId]="wants"),this.#a(),Di(e.data).heads.length>0&&(this.#n[e.senderId]="has"),this.handle.update(n=>{const[r,i]=Ti(n,this.#f(e.senderId),e.data);return this.#l(e.senderId,i),this.#h(e.senderId,n),r}),this.#a()}#a(){this.#i&&this.handle.inState([ct])&&this.#e.every(e=>this.#n[e]==="unavailable"||this.#n[e]==="wants")&&(this.#e.filter(e=>this.#n[e]==="wants").forEach(e=>{const n={type:"doc-unavailable",documentId:this.handle.documentId,targetId:e};this.emit("message",n)}),this.handle.unavailable())}#g(){for(const e of this.#r)this.#d(e);this.#r=[]}}const Wn=Ye("automerge-repo:collectionsync");class uu extends ks{repo;#t=new Set;#e={};#n={};constructor(e){super(),this.repo=e}#s(e){if(!this.#e[e]){const n=this.repo.find(In({documentId:e}));this.#e[e]=this.#r(n)}return this.#e[e]}#r(e){const n=new cu(e);return n.on("message",r=>this.emit("message",r)),n}async#i(e){const n=Array.from(this.#t),r=[];for(const i of n)await this.repo.sharePolicy(i,e)&&r.push(i);return r}async receiveMessage(e){Wn(`onSyncMessage: ${e.senderId}, ${e.documentId}, ${"data"in e?e.data.byteLength+"bytes":""}`);const n=e.documentId;if(!n)throw new Error("received a message with an invalid documentId");this.#n[n]=!0;const r=this.#s(n);r.receiveMessage(e);const i=await this.#i(n);r.beginSync(i.filter(s=>!r.hasPeer(s)))}addDocument(e){if(this.#n[e])return;const n=this.#s(e);this.#i(e).then(r=>{n.beginSync(r)})}removeDocument(e){throw new Error("not implemented")}addPeer(e){if(Wn(`adding ${e} & synchronizing with them`),!this.#t.has(e)){this.#t.add(e);for(const n of Object.values(this.#e)){const{documentId:r}=n;this.repo.sharePolicy(e,r).then(i=>{i&&n.beginSync([e])})}}}removePeer(e){Wn(`removing peer ${e}`),this.#t.delete(e);for(const n of Object.values(this.#e))n.endSync(e)}}class bu extends Qe{#t;networkSubsystem;storageSubsystem;saveDebounceRate=100;#e={};sharePolicy=async()=>!0;constructor({storage:e,network:n,peerId:r,sharePolicy:i}){super(),this.#t=Ye("automerge-repo:repo"),this.sharePolicy=i??this.sharePolicy,this.on("document",async({handle:c,isNew:u})=>{if(o){const f=({handle:l,doc:h})=>{o.saveDoc(l.documentId,h)};if(c.on("heads-changed",vs(f,this.saveDebounceRate)),u)await o.saveDoc(c.documentId,c.docSync());else{const l=await o.loadDoc(c.documentId);l&&c.update(()=>l)}}c.on("unavailable",()=>{this.#t("document unavailable",{documentId:c.documentId}),this.emit("unavailable-document",{documentId:c.documentId})}),this.networkSubsystem.isReady()?c.request():(c.awaitNetwork(),this.networkSubsystem.whenReady().then(()=>{c.networkReady()}).catch(f=>{this.#t("error waiting for network",{err:f})})),s.addDocument(c.documentId)}),this.on("delete-document",({documentId:c})=>{o&&o.remove(c).catch(u=>{this.#t("error deleting document",{documentId:c,err:u})})});const s=new uu(this);s.on("message",c=>{this.#t(`sending ${c.type} message to ${c.targetId}`),a.send(c)});const o=e?new ou(e):void 0;this.storageSubsystem=o;const a=new nu(n,r);this.networkSubsystem=a,a.on("peer",async({peerId:c})=>{this.#t("peer connected",{peerId:c}),s.addPeer(c)}),a.on("peer-disconnected",({peerId:c})=>{s.removePeer(c)}),a.on("message",async c=>{await s.receiveMessage(c)})}#n(e,n){if(this.#e[e])return this.#e[e];if(!e)throw new Error(`Invalid documentId ${e}`);const r=new $c(e,{isNew:n});return this.#e[e]=r,r}get handles(){return this.#e}create(){const{documentId:e}=Nn(gc()),n=this.#n(e,!0);return this.emit("document",{handle:n,isNew:!0}),n}clone(e){if(!e.isReady())throw new Error(`Cloned handle is not yet in ready state.
        (Try await handle.waitForReady() first.)`);const n=e.docSync();if(!n)throw new Error("Cloned handle doesn't have a document.");const r=this.create();return r.update(()=>Pi(n)),r}find(e){if(!Wr(e)){const i=_c(e);if(i)console.warn("Legacy UUID document ID detected, converting to AutomergeUrl. This will be removed in a future version."),e=i;else throw new Error(`Invalid AutomergeUrl: '${e}'`)}const{documentId:n}=Nn(e);if(this.#e[n])return this.#e[n].isUnavailable()&&setTimeout(()=>{this.#e[n].emit("unavailable",{handle:this.#e[n]})}),this.#e[n];const r=this.#n(n,!1);return this.emit("document",{handle:r,isNew:!1}),r}delete(e){Wr(e)&&(e=Nn(e).documentId),this.#n(e,!1).delete(),delete this.#e[e],this.emit("delete-document",{documentId:e})}}class fu extends Qe{peerId}class lu{}class wu extends lu{database;store;dbPromise;constructor(e="automerge",n="documents"){super(),this.database=e,this.store=n,this.dbPromise=this.createDatabasePromise()}createDatabasePromise(){return new Promise((e,n)=>{const r=indexedDB.open(this.database,1);r.onerror=()=>{n(r.error)},r.onupgradeneeded=i=>{i.target.result.createObjectStore(this.store)},r.onsuccess=i=>{const s=i.target.result;e(s)}})}async load(e){const r=(await this.dbPromise).transaction(this.store),s=r.objectStore(this.store).get(e);return new Promise((o,a)=>{r.onerror=()=>{a(s.error)},s.onsuccess=c=>{const u=c.target.result;u&&typeof u=="object"&&"binary"in u?o(u.binary):o(void 0)}})}async save(e,n){const i=(await this.dbPromise).transaction(this.store,"readwrite");return i.objectStore(this.store).put({key:e,binary:n},e),new Promise((o,a)=>{i.onerror=()=>{a(i.error)},i.oncomplete=()=>{o()}})}async remove(e){const r=(await this.dbPromise).transaction(this.store,"readwrite");return r.objectStore(this.store).delete(e),new Promise((s,o)=>{r.onerror=()=>{o(r.error)},r.oncomplete=()=>{s()}})}async loadRange(e){const n=await this.dbPromise,r=e,i=[...e,"￿"],s=IDBKeyRange.bound(r,i),o=n.transaction(this.store),c=o.objectStore(this.store).openCursor(s),u=[];return new Promise((f,l)=>{o.onerror=()=>{l(c.error)},c.onsuccess=h=>{const d=h.target.result;d?(u.push({data:d.value.binary,key:d.key}),d.continue()):f(u)}})}async removeRange(e){const n=await this.dbPromise,r=e,i=[...e,"￿"],s=IDBKeyRange.bound(r,i),o=n.transaction(this.store,"readwrite");return o.objectStore(this.store).delete(s),new Promise((c,u)=>{o.onerror=()=>{u(o.error)},o.oncomplete=()=>{c()}})}}class hu extends Qe{port;constructor(e){e.addEventListener("message",n=>{this.emit("message",n)}),super(),this.port=e}postMessage(e,n){this.port.postMessage(e,n)}start(){this.port.start()}isAlive(){return!0}}class du extends Qe{weakRef;isDisconnected=!1;constructor(e){super(),this.weakRef=new WeakRef(e),e.addEventListener("message",n=>{this.emit("message",n)})}postMessage(e,n){const r=this.weakRef.deref();if(!r){this.disconnnect();return}try{r.postMessage(e,n)}catch{this.disconnnect()}}start(){const e=this.weakRef.deref();if(!e){this.disconnnect();return}try{e.start()}catch{this.disconnnect()}}disconnnect(){this.isDisconnected||(this.emit("close"),this.isDisconnected=!0)}isAlive(){return this.isDisconnected?!1:this.weakRef.deref()?!0:(this.disconnnect(),!1)}}const oi=Ye("automerge-repo:messagechannel");class vu extends fu{channels={};messagePortRef;#t=!1;constructor(e,n={}){super();const r=n.useWeakRef??!1;this.messagePortRef=r?new du(e):new hu(e)}connect(e){oi("messageport connecting"),this.peerId=e,this.messagePortRef.start(),this.messagePortRef.addListener("message",n=>{oi("message port received",n.data);const r=n.data;if("targetId"in r&&r.targetId!==this.peerId)throw new Error("MessagePortNetwork should never receive messages for a different peer.");const{senderId:i,type:s}=r;switch(s){case"arrive":this.messagePortRef.postMessage({senderId:this.peerId,targetId:i,type:"welcome"}),this.announceConnection(i);break;case"welcome":this.announceConnection(i);break;default:"data"in r?this.emit("message",{...r,data:new Uint8Array(r.data)}):this.emit("message",r);break}}),this.messagePortRef.addListener("close",()=>{this.emit("close")}),this.messagePortRef.postMessage({senderId:this.peerId,type:"arrive"}),setTimeout(()=>{this.#t||(this.#t=!0,this.emit("ready",{network:this}))},100)}send(e){if("data"in e){const n=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength);this.messagePortRef.postMessage({...e,data:n},[n])}else this.messagePortRef.postMessage(e)}announceConnection(e){this.#t||(this.#t=!0,this.emit("ready",{network:this})),this.emit("peer-candidate",{peerId:e})}disconnect(){throw new Error("Unimplemented: leave on MessagePortNetworkAdapter")}}export{ho as $,jo as A,Ei as B,Lt as C,Sn as D,ji as E,zs as F,po as G,Mo as H,Bs as I,So as J,pr as K,Si as L,pu as M,Ti as N,xi as O,Eo as P,Mi as Q,Do as R,_o as S,Be as T,$s as U,fi as V,wo as W,lo as X,bu as Y,wu as Z,vu as _,ki as a,Ye as a0,Fc as a1,yu as a2,Qc as a3,fu as a4,Wr as a5,Jo as a6,vi as b,wi as c,vo as d,Ui as e,Di as f,Ri as g,yo as h,Ci as i,Uo as j,mi as k,Io as l,To as m,Oi as n,fn as o,mo as p,xo as q,Ii as r,Ao as s,Ai as t,bo as u,Co as v,gu as w,ke as x,Oo as y,ko as z};
