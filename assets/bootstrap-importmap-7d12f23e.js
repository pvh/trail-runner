import{_ as Fe,R as un}from"./index-195180a9.js";import{g as dn}from"./_commonjsHelpers-de833af9.js";var Be={};const Vs=/^([~\^])?(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?$/,rs=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-([\da-z-]+(?:\.[\da-z-]+)*))?(\+[\da-z-]+)?$/i;Be.semverRegEx=rs;Be.shortSemverRegEx=Vs;const te=Symbol("major"),J=Symbol("minor"),se=Symbol("patch"),_=Symbol("pre"),qe=Symbol("build"),H=Symbol("tag");let ks=/^\d+$/,re=class Oe{constructor(e){let t=e.match(rs);if(!t){this[H]=e;return}this[te]=parseInt(t[1],10),this[J]=parseInt(t[2],10),this[se]=parseInt(t[3],10),this[_]=t[4]&&t[4].split("."),this[qe]=t[5]}get major(){return this[te]}get minor(){return this[J]}get patch(){return this[se]}get pre(){return this[_]}get build(){return this[qe]}get tag(){return this[H]}gt(e){return Oe.compare(this,e)===1}lt(e){return Oe.compare(this,e)===-1}eq(e){if(e instanceof Oe||(e=new Oe(e)),this[H]&&e[H])return this[H]===e[H];if(this[H]||e[H]||this[te]!==e[te]||this[J]!==e[J]||this[se]!==e[se])return!1;if(this[_]===void 0&&e[_]===void 0)return!0;if(this[_]===void 0||e[_]===void 0||this[_].length!==e[_].length)return!1;for(let t=0;t<this[_].length;t++)if(this[_][t]!==e[_][t])return!1;return this[qe]===e[qe]}matches(e,t=!1){return e instanceof as||(e=new as(e)),e.has(this,t)}toString(){return this[H]?this[H]:this[te]+"."+this[J]+"."+this[se]+(this[_]?"-"+this[_].join("."):"")+(this[qe]?this[qe]:"")}toJSON(){return this.toString()}static isValid(e){let t=e.match(rs);return t&&t[2]!==void 0&&t[3]!==void 0}static compare(e,t){return e instanceof Oe||(e=new Oe(e)),t instanceof Oe||(t=new Oe(t)),e[H]&&t[H]?0:e[H]?-1:t[H]?1:e[te]!==t[te]?e[te]>t[te]?1:-1:e[J]!==t[J]?e[J]>t[J]?1:-1:e[se]!==t[se]?e[se]>t[se]?1:-1:!e[_]&&!t[_]?0:e[_]?t[_]?Hs(e[_],t[_]):-1:1}};var ht=Be.Semver=re;function Hs(s,e){for(let t=0,n=Math.min(s.length,e.length);t<n;t++)if(s[t]!==e[t]){let i=s[t].match(ks),r=e[t].match(ks);return i&&!r?-1:r&&!i?1:i&&r?parseInt(s[t],10)>parseInt(e[t],10)?1:-1:s[t]>e[t]?1:-1}return s.length===e.length?0:s.length>e.length?1:-1}const ie=0,ve=1,_e=2,fe=3,P=Symbol("type"),U=Symbol("version");let as=class le{constructor(e){if(e==="*"||e===""){this[P]=ie;return}let t=e.match(Vs);t?(t[1]&&(e=e.substr(1)),t[3]===void 0?(this[U]=new re(e+".0.0"),this[P]=ve):(this[U]=new re(e+".0"),t[1]==="^"&&t[2]!=="0"?this[P]=ve:this[P]=_e),this[U][_]=this[U][_]||[]):e.startsWith("^^")?(this[U]=new re(e.substr(2)),this[P]=ve):e[0]==="^"?(this[U]=new re(e.substr(1)),this[U][te]===0?this[U][J]===0?this[P]=fe:this[P]=_e:this[P]=ve):e[0]==="~"?(this[U]=new re(e.substr(1)),this[P]=_e):(this[U]=new re(e),this[P]=fe),this[U][H]&&this[P]!==fe&&(this[P]=fe)}get isExact(){return this[P]===fe}get isExactSemver(){return this[P]===fe&&this.version[H]===void 0}get isExactTag(){return this[P]===fe&&this.version[H]!==void 0}get isStable(){return this[P]===_e}get isMajor(){return this[P]===ve}get isWildcard(){return this[P]===ie}get type(){switch(this[P]){case ie:return"wildcard";case ve:return"major";case _e:return"stable";case fe:return"exact"}}get version(){return this[U]}gt(e){return le.compare(this,e)===1}lt(e){return le.compare(this,e)===-1}eq(e){return le.compare(this,e)===0}has(e,t=!1){return e instanceof re||(e=new re(e)),this[P]===ie?t||!e[_]&&!e[H]:this[P]===fe?this[U].eq(e):e[H]||this[U][te]!==e[te]||(this[P]===ve?this[U][J]>e[J]:this[U][J]!==e[J])||(this[P]!==ve||this[U][J]===e[J])&&this[U][se]>e[se]?!1:e[_]===void 0||e[_].length===0?!0:this[U][_]===void 0||this[U][_].length===0?t:t===!1&&(this[U][J]!==e[J]||this[U][se]!==e[se])?!1:Hs(this[U][_],e[_])!==1}contains(e){return e instanceof le||(e=new le(e)),this[P]===ie?!0:e[P]===ie?!1:e[P]>=this[P]&&this.has(e[U],!0)}intersect(e){if(e instanceof le||(e=new le(e)),this[P]===ie&&e[P]===ie)return this;if(this[P]===ie)return e;if(e[P]===ie)return this;if(this[P]===fe)return e.has(this[U],!0)?this:void 0;if(e[P]===fe)return this.has(e[U],!0)?e:void 0;let t,n,i;if(e[U].gt(this[U])?(t=e,n=this,i=!0):(t=this,n=e,i=!1),!n.has(t[U],!0))return;if(n[P]===ve)return i?e:this;let r=new le(t[U].toString());return r[P]=_e,r}bestMatch(e,t=!1){let n;return e.forEach(i=>{i instanceof re||(i=new re(i)),this.has(i,t)&&(n?re.compare(i,n)===1&&(n=i):n=i)}),n}toString(){let e=this[U];switch(this[P]){case ie:return"*";case ve:return e[te]===0&&e[J]===0&&e[se]===0?"0":e[_]&&e[_].length===0&&e[se]===0?"^"+e[te]+"."+e[J]:"^"+e.toString();case _e:return e[_]&&e[_].length===0&&e[se]===0||e[te]===0&&e[J]===0?e[te]+"."+e[J]:"~"+e.toString();case fe:return e.toString()}}toJSON(){return this.toString()}static match(e,t,n=!1){return t instanceof re||(t=new re(t)),t.matches(e,n)}static isValid(e){let t=new le(e);return t[P]!==fe||t[U][H]===void 0}static compare(e,t){if(e instanceof le||(e=new le(e)),t instanceof le||(t=new le(t)),e[P]===ie&&t[P]===ie)return 0;if(e[P]===ie)return 1;if(t[P]===ie)return-1;let n=re.compare(e[U],t[U]);return n!==0?n:e[P]===t[P]?0:e[P]>t[P]?1:-1}};var Te=Be.SemverRange=as,os={exports:{}};(function(s,e){e=s.exports=R;var t;typeof process=="object"&&{}&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?t=function(){var a=Array.prototype.slice.call(arguments,0);a.unshift("SEMVER"),console.log.apply(console,a)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,c=e.re=[],f=e.src=[],h=e.tokens={},p=0;function d(a){h[a]=p++}d("NUMERICIDENTIFIER"),f[h.NUMERICIDENTIFIER]="0|[1-9]\\d*",d("NUMERICIDENTIFIERLOOSE"),f[h.NUMERICIDENTIFIERLOOSE]="[0-9]+",d("NONNUMERICIDENTIFIER"),f[h.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",d("MAINVERSION"),f[h.MAINVERSION]="("+f[h.NUMERICIDENTIFIER]+")\\.("+f[h.NUMERICIDENTIFIER]+")\\.("+f[h.NUMERICIDENTIFIER]+")",d("MAINVERSIONLOOSE"),f[h.MAINVERSIONLOOSE]="("+f[h.NUMERICIDENTIFIERLOOSE]+")\\.("+f[h.NUMERICIDENTIFIERLOOSE]+")\\.("+f[h.NUMERICIDENTIFIERLOOSE]+")",d("PRERELEASEIDENTIFIER"),f[h.PRERELEASEIDENTIFIER]="(?:"+f[h.NUMERICIDENTIFIER]+"|"+f[h.NONNUMERICIDENTIFIER]+")",d("PRERELEASEIDENTIFIERLOOSE"),f[h.PRERELEASEIDENTIFIERLOOSE]="(?:"+f[h.NUMERICIDENTIFIERLOOSE]+"|"+f[h.NONNUMERICIDENTIFIER]+")",d("PRERELEASE"),f[h.PRERELEASE]="(?:-("+f[h.PRERELEASEIDENTIFIER]+"(?:\\."+f[h.PRERELEASEIDENTIFIER]+")*))",d("PRERELEASELOOSE"),f[h.PRERELEASELOOSE]="(?:-?("+f[h.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+f[h.PRERELEASEIDENTIFIERLOOSE]+")*))",d("BUILDIDENTIFIER"),f[h.BUILDIDENTIFIER]="[0-9A-Za-z-]+",d("BUILD"),f[h.BUILD]="(?:\\+("+f[h.BUILDIDENTIFIER]+"(?:\\."+f[h.BUILDIDENTIFIER]+")*))",d("FULL"),d("FULLPLAIN"),f[h.FULLPLAIN]="v?"+f[h.MAINVERSION]+f[h.PRERELEASE]+"?"+f[h.BUILD]+"?",f[h.FULL]="^"+f[h.FULLPLAIN]+"$",d("LOOSEPLAIN"),f[h.LOOSEPLAIN]="[v=\\s]*"+f[h.MAINVERSIONLOOSE]+f[h.PRERELEASELOOSE]+"?"+f[h.BUILD]+"?",d("LOOSE"),f[h.LOOSE]="^"+f[h.LOOSEPLAIN]+"$",d("GTLT"),f[h.GTLT]="((?:<|>)?=?)",d("XRANGEIDENTIFIERLOOSE"),f[h.XRANGEIDENTIFIERLOOSE]=f[h.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",d("XRANGEIDENTIFIER"),f[h.XRANGEIDENTIFIER]=f[h.NUMERICIDENTIFIER]+"|x|X|\\*",d("XRANGEPLAIN"),f[h.XRANGEPLAIN]="[v=\\s]*("+f[h.XRANGEIDENTIFIER]+")(?:\\.("+f[h.XRANGEIDENTIFIER]+")(?:\\.("+f[h.XRANGEIDENTIFIER]+")(?:"+f[h.PRERELEASE]+")?"+f[h.BUILD]+"?)?)?",d("XRANGEPLAINLOOSE"),f[h.XRANGEPLAINLOOSE]="[v=\\s]*("+f[h.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+f[h.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+f[h.XRANGEIDENTIFIERLOOSE]+")(?:"+f[h.PRERELEASELOOSE]+")?"+f[h.BUILD]+"?)?)?",d("XRANGE"),f[h.XRANGE]="^"+f[h.GTLT]+"\\s*"+f[h.XRANGEPLAIN]+"$",d("XRANGELOOSE"),f[h.XRANGELOOSE]="^"+f[h.GTLT]+"\\s*"+f[h.XRANGEPLAINLOOSE]+"$",d("COERCE"),f[h.COERCE]="(^|[^\\d])(\\d{1,"+r+"})(?:\\.(\\d{1,"+r+"}))?(?:\\.(\\d{1,"+r+"}))?(?:$|[^\\d])",d("COERCERTL"),c[h.COERCERTL]=new RegExp(f[h.COERCE],"g"),d("LONETILDE"),f[h.LONETILDE]="(?:~>?)",d("TILDETRIM"),f[h.TILDETRIM]="(\\s*)"+f[h.LONETILDE]+"\\s+",c[h.TILDETRIM]=new RegExp(f[h.TILDETRIM],"g");var l="$1~";d("TILDE"),f[h.TILDE]="^"+f[h.LONETILDE]+f[h.XRANGEPLAIN]+"$",d("TILDELOOSE"),f[h.TILDELOOSE]="^"+f[h.LONETILDE]+f[h.XRANGEPLAINLOOSE]+"$",d("LONECARET"),f[h.LONECARET]="(?:\\^)",d("CARETTRIM"),f[h.CARETTRIM]="(\\s*)"+f[h.LONECARET]+"\\s+",c[h.CARETTRIM]=new RegExp(f[h.CARETTRIM],"g");var b="$1^";d("CARET"),f[h.CARET]="^"+f[h.LONECARET]+f[h.XRANGEPLAIN]+"$",d("CARETLOOSE"),f[h.CARETLOOSE]="^"+f[h.LONECARET]+f[h.XRANGEPLAINLOOSE]+"$",d("COMPARATORLOOSE"),f[h.COMPARATORLOOSE]="^"+f[h.GTLT]+"\\s*("+f[h.LOOSEPLAIN]+")$|^$",d("COMPARATOR"),f[h.COMPARATOR]="^"+f[h.GTLT]+"\\s*("+f[h.FULLPLAIN]+")$|^$",d("COMPARATORTRIM"),f[h.COMPARATORTRIM]="(\\s*)"+f[h.GTLT]+"\\s*("+f[h.LOOSEPLAIN]+"|"+f[h.XRANGEPLAIN]+")",c[h.COMPARATORTRIM]=new RegExp(f[h.COMPARATORTRIM],"g");var I="$1$2$3";d("HYPHENRANGE"),f[h.HYPHENRANGE]="^\\s*("+f[h.XRANGEPLAIN]+")\\s+-\\s+("+f[h.XRANGEPLAIN]+")\\s*$",d("HYPHENRANGELOOSE"),f[h.HYPHENRANGELOOSE]="^\\s*("+f[h.XRANGEPLAINLOOSE]+")\\s+-\\s+("+f[h.XRANGEPLAINLOOSE]+")\\s*$",d("STAR"),f[h.STAR]="(<|>)?=?\\s*\\*";for(var v=0;v<p;v++)t(v,f[v]),c[v]||(c[v]=new RegExp(f[v]));e.parse=E;function E(a,u){if((!u||typeof u!="object")&&(u={loose:!!u,includePrerelease:!1}),a instanceof R)return a;if(typeof a!="string"||a.length>n)return null;var m=u.loose?c[h.LOOSE]:c[h.FULL];if(!m.test(a))return null;try{return new R(a,u)}catch{return null}}e.valid=$;function $(a,u){var m=E(a,u);return m?m.version:null}e.clean=A;function A(a,u){var m=E(a.trim().replace(/^[=v]+/,""),u);return m?m.version:null}e.SemVer=R;function R(a,u){if((!u||typeof u!="object")&&(u={loose:!!u,includePrerelease:!1}),a instanceof R){if(a.loose===u.loose)return a;a=a.version}else if(typeof a!="string")throw new TypeError("Invalid Version: "+a);if(a.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof R))return new R(a,u);t("SemVer",a,u),this.options=u,this.loose=!!u.loose;var m=a.trim().match(u.loose?c[h.LOOSE]:c[h.FULL]);if(!m)throw new TypeError("Invalid Version: "+a);if(this.raw=a,this.major=+m[1],this.minor=+m[2],this.patch=+m[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");m[4]?this.prerelease=m[4].split(".").map(function(w){if(/^[0-9]+$/.test(w)){var g=+w;if(g>=0&&g<i)return g}return w}):this.prerelease=[],this.build=m[5]?m[5].split("."):[],this.format()}R.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},R.prototype.toString=function(){return this.version},R.prototype.compare=function(a){return t("SemVer.compare",this.version,this.options,a),a instanceof R||(a=new R(a,this.options)),this.compareMain(a)||this.comparePre(a)},R.prototype.compareMain=function(a){return a instanceof R||(a=new R(a,this.options)),k(this.major,a.major)||k(this.minor,a.minor)||k(this.patch,a.patch)},R.prototype.comparePre=function(a){if(a instanceof R||(a=new R(a,this.options)),this.prerelease.length&&!a.prerelease.length)return-1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;var u=0;do{var m=this.prerelease[u],w=a.prerelease[u];if(t("prerelease compare",u,m,w),m===void 0&&w===void 0)return 0;if(w===void 0)return 1;if(m===void 0)return-1;if(m===w)continue;return k(m,w)}while(++u)},R.prototype.compareBuild=function(a){a instanceof R||(a=new R(a,this.options));var u=0;do{var m=this.build[u],w=a.build[u];if(t("prerelease compare",u,m,w),m===void 0&&w===void 0)return 0;if(w===void 0)return 1;if(m===void 0)return-1;if(m===w)continue;return k(m,w)}while(++u)},R.prototype.inc=function(a,u){switch(a){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",u);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",u);break;case"prepatch":this.prerelease.length=0,this.inc("patch",u),this.inc("pre",u);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",u),this.inc("pre",u);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var m=this.prerelease.length;--m>=0;)typeof this.prerelease[m]=="number"&&(this.prerelease[m]++,m=-2);m===-1&&this.prerelease.push(0)}u&&(this.prerelease[0]===u?isNaN(this.prerelease[1])&&(this.prerelease=[u,0]):this.prerelease=[u,0]);break;default:throw new Error("invalid increment argument: "+a)}return this.format(),this.raw=this.version,this},e.inc=x;function x(a,u,m,w){typeof m=="string"&&(w=m,m=void 0);try{return new R(a,m).inc(u,w).version}catch{return null}}e.diff=T;function T(a,u){if(be(a,u))return null;var m=E(a),w=E(u),g="";if(m.prerelease.length||w.prerelease.length){g="pre";var O="prerelease"}for(var L in m)if((L==="major"||L==="minor"||L==="patch")&&m[L]!==w[L])return g+L;return O}e.compareIdentifiers=k;var y=/^[0-9]+$/;function k(a,u){var m=y.test(a),w=y.test(u);return m&&w&&(a=+a,u=+u),a===u?0:m&&!w?-1:w&&!m?1:a<u?-1:1}e.rcompareIdentifiers=Y;function Y(a,u){return k(u,a)}e.major=K;function K(a,u){return new R(a,u).major}e.minor=ye;function ye(a,u){return new R(a,u).minor}e.patch=$e;function $e(a,u){return new R(a,u).patch}e.compare=me;function me(a,u,m){return new R(a,m).compare(new R(u,m))}e.compareLoose=Ye;function Ye(a,u){return me(a,u,!0)}e.compareBuild=Z;function Z(a,u,m){var w=new R(a,m),g=new R(u,m);return w.compare(g)||w.compareBuild(g)}e.rcompare=Ge;function Ge(a,u,m){return me(u,a,m)}e.sort=Lt;function Lt(a,u){return a.sort(function(m,w){return e.compareBuild(m,w,u)})}e.rsort=ot;function ot(a,u){return a.sort(function(m,w){return e.compareBuild(w,m,u)})}e.gt=xe;function xe(a,u,m){return me(a,u,m)>0}e.lt=B;function B(a,u,m){return me(a,u,m)<0}e.eq=be;function be(a,u,m){return me(a,u,m)===0}e.neq=lt;function lt(a,u,m){return me(a,u,m)!==0}e.gte=Re;function Re(a,u,m){return me(a,u,m)>=0}e.lte=Ne;function Ne(a,u,m){return me(a,u,m)<=0}e.cmp=je;function je(a,u,m,w){switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof m=="object"&&(m=m.version),a===m;case"!==":return typeof a=="object"&&(a=a.version),typeof m=="object"&&(m=m.version),a!==m;case"":case"=":case"==":return be(a,m,w);case"!=":return lt(a,m,w);case">":return xe(a,m,w);case">=":return Re(a,m,w);case"<":return B(a,m,w);case"<=":return Ne(a,m,w);default:throw new TypeError("Invalid operator: "+u)}}e.Comparator=G;function G(a,u){if((!u||typeof u!="object")&&(u={loose:!!u,includePrerelease:!1}),a instanceof G){if(a.loose===!!u.loose)return a;a=a.value}if(!(this instanceof G))return new G(a,u);t("comparator",a,u),this.options=u,this.loose=!!u.loose,this.parse(a),this.semver===Pe?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var Pe={};G.prototype.parse=function(a){var u=this.options.loose?c[h.COMPARATORLOOSE]:c[h.COMPARATOR],m=a.match(u);if(!m)throw new TypeError("Invalid comparator: "+a);this.operator=m[1]!==void 0?m[1]:"",this.operator==="="&&(this.operator=""),m[2]?this.semver=new R(m[2],this.options.loose):this.semver=Pe},G.prototype.toString=function(){return this.value},G.prototype.test=function(a){if(t("Comparator.test",a,this.options.loose),this.semver===Pe||a===Pe)return!0;if(typeof a=="string")try{a=new R(a,this.options)}catch{return!1}return je(a,this.operator,this.semver,this.options)},G.prototype.intersects=function(a,u){if(!(a instanceof G))throw new TypeError("a Comparator is required");(!u||typeof u!="object")&&(u={loose:!!u,includePrerelease:!1});var m;if(this.operator==="")return this.value===""?!0:(m=new F(a.value,u),Je(this.value,m,u));if(a.operator==="")return a.value===""?!0:(m=new F(this.value,u),Je(a.semver,m,u));var w=(this.operator===">="||this.operator===">")&&(a.operator===">="||a.operator===">"),g=(this.operator==="<="||this.operator==="<")&&(a.operator==="<="||a.operator==="<"),O=this.semver.version===a.semver.version,L=(this.operator===">="||this.operator==="<=")&&(a.operator===">="||a.operator==="<="),M=je(this.semver,"<",a.semver,u)&&(this.operator===">="||this.operator===">")&&(a.operator==="<="||a.operator==="<"),S=je(this.semver,">",a.semver,u)&&(this.operator==="<="||this.operator==="<")&&(a.operator===">="||a.operator===">");return w||g||O&&L||M||S},e.Range=F;function F(a,u){if((!u||typeof u!="object")&&(u={loose:!!u,includePrerelease:!1}),a instanceof F)return a.loose===!!u.loose&&a.includePrerelease===!!u.includePrerelease?a:new F(a.raw,u);if(a instanceof G)return new F(a.value,u);if(!(this instanceof F))return new F(a,u);if(this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease,this.raw=a,this.set=a.split(/\s*\|\|\s*/).map(function(m){return this.parseRange(m.trim())},this).filter(function(m){return m.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+a);this.format()}F.prototype.format=function(){return this.range=this.set.map(function(a){return a.join(" ").trim()}).join("||").trim(),this.range},F.prototype.toString=function(){return this.range},F.prototype.parseRange=function(a){var u=this.options.loose;a=a.trim();var m=u?c[h.HYPHENRANGELOOSE]:c[h.HYPHENRANGE];a=a.replace(m,De),t("hyphen replace",a),a=a.replace(c[h.COMPARATORTRIM],I),t("comparator trim",a,c[h.COMPARATORTRIM]),a=a.replace(c[h.TILDETRIM],l),a=a.replace(c[h.CARETTRIM],b),a=a.split(/\s+/).join(" ");var w=u?c[h.COMPARATORLOOSE]:c[h.COMPARATOR],g=a.split(" ").map(function(O){return Me(O,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(g=g.filter(function(O){return!!O.match(w)})),g=g.map(function(O){return new G(O,this.options)},this),g},F.prototype.intersects=function(a,u){if(!(a instanceof F))throw new TypeError("a Range is required");return this.set.some(function(m){return Ce(m,u)&&a.set.some(function(w){return Ce(w,u)&&m.every(function(g){return w.every(function(O){return g.intersects(O,u)})})})})};function Ce(a,u){for(var m=!0,w=a.slice(),g=w.pop();m&&w.length;)m=w.every(function(O){return g.intersects(O,u)}),g=w.pop();return m}e.toComparators=ct;function ct(a,u){return new F(a,u).set.map(function(m){return m.map(function(w){return w.value}).join(" ").trim().split(" ")})}function Me(a,u){return t("comp",a,u),a=$t(a,u),t("caret",a),a=It(a,u),t("tildes",a),a=Pt(a,u),t("xrange",a),a=ne(a,u),t("stars",a),a}function Q(a){return!a||a.toLowerCase()==="x"||a==="*"}function It(a,u){return a.trim().split(/\s+/).map(function(m){return Tt(m,u)}).join(" ")}function Tt(a,u){var m=u.loose?c[h.TILDELOOSE]:c[h.TILDE];return a.replace(m,function(w,g,O,L,M){t("tilde",a,w,g,O,L,M);var S;return Q(g)?S="":Q(O)?S=">="+g+".0.0 <"+(+g+1)+".0.0":Q(L)?S=">="+g+"."+O+".0 <"+g+"."+(+O+1)+".0":M?(t("replaceTilde pr",M),S=">="+g+"."+O+"."+L+"-"+M+" <"+g+"."+(+O+1)+".0"):S=">="+g+"."+O+"."+L+" <"+g+"."+(+O+1)+".0",t("tilde return",S),S})}function $t(a,u){return a.trim().split(/\s+/).map(function(m){return jt(m,u)}).join(" ")}function jt(a,u){t("caret",a,u);var m=u.loose?c[h.CARETLOOSE]:c[h.CARET];return a.replace(m,function(w,g,O,L,M){t("caret",a,w,g,O,L,M);var S;return Q(g)?S="":Q(O)?S=">="+g+".0.0 <"+(+g+1)+".0.0":Q(L)?g==="0"?S=">="+g+"."+O+".0 <"+g+"."+(+O+1)+".0":S=">="+g+"."+O+".0 <"+(+g+1)+".0.0":M?(t("replaceCaret pr",M),g==="0"?O==="0"?S=">="+g+"."+O+"."+L+"-"+M+" <"+g+"."+O+"."+(+L+1):S=">="+g+"."+O+"."+L+"-"+M+" <"+g+"."+(+O+1)+".0":S=">="+g+"."+O+"."+L+"-"+M+" <"+(+g+1)+".0.0"):(t("no pr"),g==="0"?O==="0"?S=">="+g+"."+O+"."+L+" <"+g+"."+O+"."+(+L+1):S=">="+g+"."+O+"."+L+" <"+g+"."+(+O+1)+".0":S=">="+g+"."+O+"."+L+" <"+(+g+1)+".0.0"),t("caret return",S),S})}function Pt(a,u){return t("replaceXRanges",a,u),a.split(/\s+/).map(function(m){return St(m,u)}).join(" ")}function St(a,u){a=a.trim();var m=u.loose?c[h.XRANGELOOSE]:c[h.XRANGE];return a.replace(m,function(w,g,O,L,M,S){t("xRange",a,w,g,O,L,M,S);var ae=Q(O),oe=ae||Q(L),N=oe||Q(M),D=N;return g==="="&&D&&(g=""),S=u.includePrerelease?"-0":"",ae?g===">"||g==="<"?w="<0.0.0-0":w="*":g&&D?(oe&&(L=0),M=0,g===">"?(g=">=",oe?(O=+O+1,L=0,M=0):(L=+L+1,M=0)):g==="<="&&(g="<",oe?O=+O+1:L=+L+1),w=g+O+"."+L+"."+M+S):oe?w=">="+O+".0.0"+S+" <"+(+O+1)+".0.0"+S:N&&(w=">="+O+"."+L+".0"+S+" <"+O+"."+(+L+1)+".0"+S),t("xRange return",w),w})}function ne(a,u){return t("replaceStars",a,u),a.trim().replace(c[h.STAR],"")}function De(a,u,m,w,g,O,L,M,S,ae,oe,N,D){return Q(m)?u="":Q(w)?u=">="+m+".0.0":Q(g)?u=">="+m+"."+w+".0":u=">="+u,Q(S)?M="":Q(ae)?M="<"+(+S+1)+".0.0":Q(oe)?M="<"+S+"."+(+ae+1)+".0":N?M="<="+S+"."+ae+"."+oe+"-"+N:M="<="+M,(u+" "+M).trim()}F.prototype.test=function(a){if(!a)return!1;if(typeof a=="string")try{a=new R(a,this.options)}catch{return!1}for(var u=0;u<this.set.length;u++)if(Ue(this.set[u],a,this.options))return!0;return!1};function Ue(a,u,m){for(var w=0;w<a.length;w++)if(!a[w].test(u))return!1;if(u.prerelease.length&&!m.includePrerelease){for(w=0;w<a.length;w++)if(t(a[w].semver),a[w].semver!==Pe&&a[w].semver.prerelease.length>0){var g=a[w].semver;if(g.major===u.major&&g.minor===u.minor&&g.patch===u.patch)return!0}return!1}return!0}e.satisfies=Je;function Je(a,u,m){try{u=new F(u,m)}catch{return!1}return u.test(a)}e.maxSatisfying=At;function At(a,u,m){var w=null,g=null;try{var O=new F(u,m)}catch{return null}return a.forEach(function(L){O.test(L)&&(!w||g.compare(L)===-1)&&(w=L,g=new R(w,m))}),w}e.minSatisfying=ft;function ft(a,u,m){var w=null,g=null;try{var O=new F(u,m)}catch{return null}return a.forEach(function(L){O.test(L)&&(!w||g.compare(L)===1)&&(w=L,g=new R(w,m))}),w}e.minVersion=xt;function xt(a,u){a=new F(a,u);var m=new R("0.0.0");if(a.test(m)||(m=new R("0.0.0-0"),a.test(m)))return m;m=null;for(var w=0;w<a.set.length;++w){var g=a.set[w];g.forEach(function(O){var L=new R(O.semver.version);switch(O.operator){case">":L.prerelease.length===0?L.patch++:L.prerelease.push(0),L.raw=L.format();case"":case">=":(!m||xe(m,L))&&(m=L);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+O.operator)}})}return m&&a.test(m)?m:null}e.validRange=Nt;function Nt(a,u){try{return new F(a,u).range||"*"}catch{return null}}e.ltr=Ct;function Ct(a,u,m){return Ke(a,u,"<",m)}e.gtr=Mt;function Mt(a,u,m){return Ke(a,u,">",m)}e.outside=Ke;function Ke(a,u,m,w){a=new R(a,w),u=new F(u,w);var g,O,L,M,S;switch(m){case">":g=xe,O=Ne,L=B,M=">",S=">=";break;case"<":g=B,O=Re,L=xe,M="<",S="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Je(a,u,w))return!1;for(var ae=0;ae<u.set.length;++ae){var oe=u.set[ae],N=null,D=null;if(oe.forEach(function(Se){Se.semver===Pe&&(Se=new G(">=0.0.0")),N=N||Se,D=D||Se,g(Se.semver,N.semver,w)?N=Se:L(Se.semver,D.semver,w)&&(D=Se)}),N.operator===M||N.operator===S||(!D.operator||D.operator===M)&&O(a,D.semver))return!1;if(D.operator===S&&L(a,D.semver))return!1}return!0}e.prerelease=Dt;function Dt(a,u){var m=E(a,u);return m&&m.prerelease.length?m.prerelease:null}e.intersects=Ut;function Ut(a,u,m){return a=new F(a,m),u=new F(u,m),a.intersects(u)}e.coerce=o;function o(a,u){if(a instanceof R)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;u=u||{};var m=null;if(!u.rtl)m=a.match(c[h.COERCE]);else{for(var w;(w=c[h.COERCERTL].exec(a))&&(!m||m.index+m[0].length!==a.length);)(!m||w.index+w[0].length!==m.index+m[0].length)&&(m=w),c[h.COERCERTL].lastIndex=w.index+w[1].length+w[2].length;c[h.COERCERTL].lastIndex=-1}return m===null?null:E(m[2]+"."+(m[3]||"0")+"."+(m[4]||"0"),u)}})(os,os.exports);var pn=os.exports;const mn=pn,{Semver:Ls,SemverRange:ue}=Be;var wn=function(e){let t=mn.validRange(e);if(!t)return new ue(e);if(t==="*")return new ue(t);try{let i=new ue(e);if(!i.version.tag)return i}catch(i){if(i.code!=="ENOTSEMVER")throw i}let n;for(let i of t.split("||")){let r,c,f,h;for(let b of i.split(" ")){let I=b[0]==="<",v=b[0]===">";if(!I&&!v){r=b,f=!0;break}let E=b[1]==="=";if(v){if(!I){let $=b[1]==="=",A=new Ls(b.substr(1+$));(!c||c.lt(A))&&(c=A,h=$)}}else{let $=new Ls(b.substr(1+E));(!r||r.gt($))&&(r=$,f=E)}}if(!r){n=new ue("*");continue}if(c&&r&&c.gt(r)){let b=new ue(c.toString());(!n||!n.contains(b)&&(b.gt(n)||b.contains(n)))&&(n=b);continue}let p;if(r){if(f){let $=new ue(r.toString());(!n||!n.contains($)&&($.gt(n)||$.contains(n)))&&(n=$);continue}let b=0,I=0,v=0,E="";if(r.pre&&c.major===r.major&&c.minor===r.minor&&c.patch===r.patch){n=new ue("~"+c.toString());continue}else r.patch===0?r.minor===0?r.major>0&&(b=r.major-1,E="^"):(b=r.major,I=r.minor-1,E="~"):(b=r.major,I=r.minor,v=0,E="~");b===0&&E==="^"?p=new ue("0"):p=new ue(E+b+"."+I+"."+v)}if(!c){n=p;continue}let d;h?d=new ue("^^"+c.toString()):c.pre?d=new ue("^^"+c.major+"."+c.minor+"."+c.patch+"-"+[...c.pre,1].join(".")):d=new ue("^^"+c.major+"."+c.minor+"."+(c.patch+1));let l=p?d.intersect(p)||p:d;(!n||!n.contains(l)&&(l.gt(n)||l.contains(n)))&&(n=l)}return n};const Is=dn(wn);function gn(s){return async function(e,...t){let n=0;for(;;)try{return await s(e,...t)}catch(i){if(n++>3)throw i}}}let ls=[],Ys=0;function yn(){if(++Ys>100)return new Promise(s=>ls.push(s))}function bn(){Ys--,ls.length&&ls.shift()()}const ce=gn(async function(e,t){const n=yn();n&&await n;try{return await globalThis.fetch(e,t)}catch(i){if(i instanceof TypeError)return{status:401,async text(){return""},async json(){throw new Error("Not JSON")},arrayBuffer(){return new ArrayBuffer(0)}}}finally{bn()}});var _t;let it;if(typeof Deno<"u")it=new URL("file://"+Deno.cwd()+"/");else if(typeof process<"u"&&(!((_t=process.versions)===null||_t===void 0)&&_t.node))it=new URL("file://"+process.cwd()+"/");else if(typeof document<"u"){const s=document.querySelector("base[href]");s?it=new URL(s.href+(s.href.endsWith("/")?"":"/")):typeof location<"u"&&(it=new URL("../",new URL(location.href)))}function Ts(s,e){if(s.startsWith(e))return e;if(e.startsWith(s))return s;const t=s.split("/"),n=e.split("/");let i=0;for(;t[i]===n[i];)i++;return t.slice(0,i).join("/")+"/"}function cs(s,e){return s.protocol===e.protocol&&s.host===e.host&&s.port===e.port&&s.username===e.username&&s.password===e.password}function V(s,e,t){return s.startsWith("/")?t?new URL("."+s.slice(s[1]==="/"?1:0),t).href:s:new URL(s,e).href}function ee(s,e,t=null){let n;if(s.startsWith("/")||s.startsWith("//")){if(t===null)return s;n=new URL(s,t)}else n=new URL(s,e);return t&&n.href.startsWith(t.href)?n.href.slice(t.href.length-1):t&&t.href.startsWith(n.href)?"/"+$s(n,t):cs(n,e)?$s(n,e):n.href}function $s(s,e){const t=e.pathname,n=s.pathname,i=Math.min(t.length,n.length);let r=-1;for(let f=0;f<i&&t[f]===n[f];f++)n[f]==="/"&&(r=f);const c=t.slice(r+1).split("/").length-1;return(c?"../".repeat(c):"./")+n.slice(r+1)+s.search+s.hash}function gt(s){try{if(s[0]==="#")return!1;new URL(s)}catch{return!1}return!0}function Qe(s){return!vn(s)&&!gt(s)}function vn(s){return s.startsWith("./")||s.startsWith("../")||s.startsWith("/")}function We(s){const e={};for(const t of Object.keys(s).sort())e[t]=s[t];return e}class Ve{clone(){return new Ve({mapUrl:this.mapUrl,rootUrl:this.rootUrl}).extend(this)}extend(e,t=!1){if(Object.assign(this.imports,e.imports),t)Object.assign(this.scopes,e.scopes);else if(e.scopes)for(const n of Object.keys(e.scopes))Object.assign(this.scopes[n]=this.scopes[n]||Object.create(null),e.scopes[n]);return this.rebase(),this}sort(){this.imports=We(this.imports),this.scopes=We(this.scopes);for(const e of Object.keys(this.scopes))this.scopes[e]=We(this.scopes[e]);return this}set(e,t,n){return n?(this.scopes[n]=this.scopes[n]||Object.create(null),this.scopes[n][e]=t):this.imports[e]=t,this}replace(e,t){const n=e.endsWith("/");if(!gt(e))throw new Error("URL remapping only supports URLs");const i=ee(t,this.mapUrl,this.rootUrl);for(const r of Object.keys(this.imports)){const c=this.imports[r];(n&&c.startsWith(e)||c===e)&&(this.imports[r]=i+c.slice(e.length))}for(const r of Object.keys(this.scopes)){const c=this.scopes[r],f=V(r,this.mapUrl,this.rootUrl);if(n&&f.startsWith(e)||f===e){const h=i+f.slice(e.length);delete this.scopes[r],this.scopes[h]=c}for(const h of Object.keys(c)){const p=c[h];(n&&p.startsWith(e)||p===e)&&(c[h]=i+p.slice(e.length))}}return this}combineSubpaths(){const e=t=>{let n=Object.create(null);for(let i of Object.keys(t)){const r=t[i];let c;if(Qe(i)?c=he(i,n):c=he(i=ee(i,this.mapUrl,this.rootUrl),n)||this.rootUrl&&he(i=ee(i,this.mapUrl,null),n)||void 0,c&&i.slice(c.length)===V(r,this.mapUrl,this.rootUrl).slice(V(n[c],this.mapUrl,this.rootUrl).length))continue;let f=!1;const h=t[i].split("/"),p=i.split("/");for(let d=p.length-1;d>0;d--){const l=p.slice(d).join("/"),b=h.slice(h.length-(p.length-d)).join("/");if(l!==b){n[i]=t[i];break}const I=p.slice(0,d).join("/")+"/";if(n[I])continue;const v=h.slice(0,h.length-(p.length-d)).join("/")+"/";for(let E of Object.keys(n)){const $=n[E];let A=!1;Qe(E)?A=E.startsWith(I):A=(E=ee(E,this.mapUrl,this.rootUrl)).startsWith(I)||(E=ee(E,this.mapUrl,this.rootUrl)).startsWith(I),A&&E.slice(I.length)===V($,this.mapUrl,this.rootUrl).slice(V(v,this.mapUrl,this.rootUrl).length)&&(f=!0,delete n[E])}if(f){n[I]=v;break}}f||(n[i]=r)}return n};for(const t of Object.keys(this.scopes))this.scopes[t]=e(this.scopes[t]);return this}flatten(){let e=null;for(const n of Object.keys(this.scopes)){const i=V(n,this.mapUrl,this.rootUrl);if(gt(i)){const r=new URL(i);cs(r,this.mapUrl)&&(e?e=Ts(r.href,e):e=r.href)}else e?e=Ts(i,e):e=i}const t=e?ee(e,this.mapUrl,this.rootUrl):null;for(const n of Object.keys(this.scopes)){const i=this.scopes[n];let r;const c=V(n,this.mapUrl,this.rootUrl);if(gt(c)){const p=new URL(c);cs(p,this.mapUrl)?r=t:r=p.protocol+"//"+p.hostname+(p.port?":"+p.port:"")+"/"}else r=t;let f=this.scopes[r]||Object.create(null);f===i&&(f=null);let h=!0;for(const p of Object.keys(i)){const d=i[p];this.imports[p]&&V(this.imports[p],this.mapUrl,this.rootUrl)===V(d,this.mapUrl,this.rootUrl)?delete i[p]:f&&(!f[p]||V(f[p],this.mapUrl,this.rootUrl)===V(d,this.mapUrl,this.rootUrl))?(f[p]=ee(d,this.mapUrl,this.rootUrl),delete i[p],this.scopes[r]=We(f)):h=!1}h&&delete this.scopes[n]}return this}rebase(e=this.mapUrl,t){typeof e=="string"&&(e=new URL(e)),t===void 0?e.href===this.mapUrl.href?t=this.rootUrl:t=this.rootUrl===null||e.protocol!=="https:"&&e.protocol!=="http:"?null:new URL("/",e):typeof t=="string"&&(t=new URL(t));let n=!1;for(const r of Object.keys(this.imports)){const c=this.imports[r];if(this.imports[r]=ee(V(c,this.mapUrl,this.rootUrl),e,t),!Qe(r)){const f=ee(V(r,this.mapUrl,this.rootUrl),e,t);f!==r&&(n=!0,this.imports[f]=this.imports[r],delete this.imports[r])}}n&&(this.imports=We(this.imports));let i=!1;for(const r of Object.keys(this.scopes)){const c=this.scopes[r];let f=!1;for(const p of Object.keys(c)){const d=c[p];if(c[p]=ee(V(d,this.mapUrl,this.rootUrl),e,t),!Qe(p)){const l=ee(V(p,this.mapUrl,this.rootUrl),e,t);l!==p&&(f=!0,c[l]=c[p],delete c[p])}}f&&(this.scopes[r]=We(c));const h=ee(V(r,this.mapUrl,this.rootUrl),e,t);r!==h&&(i=!0,delete this.scopes[r],this.scopes[h]=c)}return i&&(this.scopes=We(this.scopes)),this.mapUrl=e,this.rootUrl=t,this}resolve(e,t=this.mapUrl){typeof t!="string"&&(t=t.toString()),t=V(t,this.mapUrl,this.rootUrl);let n;Qe(e)||(n=new URL(e,t),e=n.href);const i=Ks(t,this.scopes,this.mapUrl,this.rootUrl);for(const[c]of i){let f=he(e,this.scopes[c]);if(!f&&n&&(f=he(e=ee(e,this.mapUrl,this.rootUrl),this.scopes[c])||this.rootUrl&&he(e=ee(e,this.mapUrl,null),this.scopes[c])||void 0),f){const h=this.scopes[c][f];return V(h+e.slice(f.length),this.mapUrl,this.rootUrl)}}let r=he(e,this.imports);if(!r&&n&&(r=he(e=ee(e,this.mapUrl,this.rootUrl),this.imports)||this.rootUrl&&he(e=ee(e,this.mapUrl,null),this.imports)||void 0),r){const c=this.imports[r];return V(c+e.slice(r.length),this.mapUrl,this.rootUrl)}if(n)return n.href;throw new Error(`Unable to resolve ${e} in ${t}`)}toJSON(){const e={};return Object.keys(this.imports).length&&(e.imports=this.imports),Object.keys(this.scopes).length&&(e.scopes=this.scopes),JSON.parse(JSON.stringify(e))}constructor(e){this.imports=Object.create(null),this.scopes=Object.create(null);let{map:t,mapUrl:n=it,rootUrl:i}=e instanceof URL||typeof e=="string"||typeof e>"u"?{mapUrl:e,map:void 0,rootUrl:void 0}:e;typeof n=="string"&&(n=new URL(n)),this.mapUrl=n,i===void 0&&(this.mapUrl.protocol==="http:"||this.mapUrl.protocol==="https:")?i=new URL("/",this.mapUrl):typeof i=="string"&&(i=new URL(i)),this.rootUrl=i||null,t&&this.extend(t)}}function Ks(s,e,t,n){let i=Object.keys(e).map(r=>[r,V(r,t,n)]);return i=i.sort(([,r],[,c])=>r.length<c.length?1:-1),i.filter(([,r])=>r===s||r.endsWith("/")&&s.startsWith(r))}function he(s,e){if(s in e)return s;let t;for(const n of Object.keys(e)){const i=n.endsWith("*");!n.endsWith("/")&&!i||s.startsWith(i?n.slice(0,-1):n)&&(!t||n.length>t.length)&&(t=n)}return t}const Qs={},fs=Object.freeze(Object.defineProperty({__proto__:null,default:Qs},Symbol.toStringTag,{value:"Module"}));let X,ut,Wt,Ze=2<<19;const js=new Uint8Array(new Uint16Array([1]).buffer)[0]===1?function(s,e){const t=s.length;let n=0;for(;n<t;)e[n]=s.charCodeAt(n++)}:function(s,e){const t=s.length;let n=0;for(;n<t;){const i=s.charCodeAt(n);e[n++]=(255&i)<<8|i>>>8}},En="xportmportlassetaromsyncunctionssertvoyiedelecontininstantybreareturdebuggeawaithrwhileforifcatcfinallels";let q,Zs,z;function hs(s,e="@"){q=s,Zs=e;const t=2*q.length+(2<<18);if(t>Ze||!X){for(;t>Ze;)Ze*=2;ut=new ArrayBuffer(Ze),js(En,new Uint16Array(ut,16,105)),X=function(c,f,h){var p=new c.Int8Array(h),d=new c.Int16Array(h),l=new c.Int32Array(h),b=new c.Uint8Array(h),I=new c.Uint16Array(h),v=1024;function E(){var o=0,a=0,u=0,m=0,w=0,g=0,O=0;O=v,v=v+10240|0,p[795]=1,d[395]=0,d[396]=0,l[67]=l[2],p[796]=0,l[66]=0,p[794]=0,l[68]=O+2048,l[69]=O,p[797]=0,o=(l[3]|0)+-2|0,l[70]=o,a=o+(l[64]<<1)|0,l[71]=a;e:for(;;){if(u=o+2|0,l[70]=u,o>>>0>=a>>>0){w=18;break}s:do switch(d[u>>1]|0){case 9:case 10:case 11:case 12:case 13:case 32:break;case 101:{if(!(d[396]|0)&&Me(u)|0&&!(Z(o+4|0,16,10)|0)&&($(),(p[795]|0)==0)){w=9;break e}else w=17;break}case 105:{Me(u)|0&&!(Z(o+4|0,26,10)|0)&&A(),w=17;break}case 59:{w=17;break}case 47:switch(d[o+4>>1]|0){case 47:{je();break s}case 42:{Ye(1);break s}default:{w=16;break e}}default:{w=16;break e}}while(0);(w|0)==17&&(w=0,l[67]=l[70]),o=l[70]|0,a=l[71]|0}(w|0)==9?(o=l[70]|0,l[67]=o,w=19):(w|0)==16?(p[795]=0,l[70]=o,w=19):(w|0)==18&&(p[794]|0?o=0:(o=u,w=19));do if((w|0)==19){e:for(;;){if(a=o+2|0,l[70]=a,m=a,o>>>0>=(l[71]|0)>>>0){w=82;break}s:do switch(d[a>>1]|0){case 9:case 10:case 11:case 12:case 13:case 32:break;case 101:{!(d[396]|0)&&Me(a)|0&&!(Z(o+4|0,16,10)|0)&&$(),w=81;break}case 105:{Me(a)|0&&!(Z(o+4|0,26,10)|0)&&A(),w=81;break}case 99:{Me(a)|0&&!(Z(o+4|0,36,8)|0)&&De(d[o+12>>1]|0)|0&&(p[797]=1),w=81;break}case 40:{m=l[68]|0,a=d[396]|0,w=a&65535,l[m+(w<<3)>>2]=1,u=l[67]|0,d[396]=a+1<<16>>16,l[m+(w<<3)+4>>2]=u,w=81;break}case 41:{if(a=d[396]|0,!(a<<16>>16)){w=36;break e}a=a+-1<<16>>16,d[396]=a,u=d[395]|0,u<<16>>16&&(g=l[(l[69]|0)+((u&65535)+-1<<2)>>2]|0,(l[g+20>>2]|0)==(l[(l[68]|0)+((a&65535)<<3)+4>>2]|0))&&(a=g+4|0,l[a>>2]|0||(l[a>>2]=m),l[g+12>>2]=o+4,d[395]=u+-1<<16>>16),w=81;break}case 123:{w=l[67]|0,m=l[61]|0,o=w;do if((d[w>>1]|0)==41&(m|0)!=0&&(l[m+4>>2]|0)==(w|0))if(a=l[62]|0,l[61]=a,a){l[a+28>>2]=0;break}else{l[57]=0;break}while(0);m=l[68]|0,u=d[396]|0,w=u&65535,l[m+(w<<3)>>2]=p[797]|0?6:2,d[396]=u+1<<16>>16,l[m+(w<<3)+4>>2]=o,p[797]=0,w=81;break}case 125:{if(o=d[396]|0,!(o<<16>>16)){w=49;break e}m=l[68]|0,w=o+-1<<16>>16,d[396]=w,(l[m+((w&65535)<<3)>>2]|0)==4&&T(),w=81;break}case 39:{k(39),w=81;break}case 34:{k(34),w=81;break}case 47:switch(d[o+4>>1]|0){case 47:{je();break s}case 42:{Ye(1);break s}default:{o=l[67]|0,m=d[o>>1]|0;t:do if(Lt(m)|0)switch(m<<16>>16){case 46:if(((d[o+-2>>1]|0)+-48&65535)<10){w=66;break t}else{w=69;break t}case 43:if((d[o+-2>>1]|0)==43){w=66;break t}else{w=69;break t}case 45:if((d[o+-2>>1]|0)==45){w=66;break t}else{w=69;break t}default:{w=69;break t}}else{switch(m<<16>>16){case 41:if(F(l[(l[68]|0)+(I[396]<<3)+4>>2]|0)|0){w=69;break t}else{w=66;break t}case 125:break;default:{w=66;break t}}a=l[68]|0,u=I[396]|0,!(me(l[a+(u<<3)+4>>2]|0)|0)&&(l[a+(u<<3)>>2]|0)!=6?w=66:w=69}while(0);t:do if((w|0)==66)if(w=0,x(o)|0)w=69;else{switch(m<<16>>16){case 0:{w=69;break t}case 47:{if(p[796]|0){w=69;break t}break}default:}u=l[3]|0,a=m;do{if(o>>>0<=u>>>0)break;o=o+-2|0,l[67]=o,a=d[o>>1]|0}while(!(Ne(a)|0));if(Ce(a)|0){do{if(o>>>0<=u>>>0)break;o=o+-2|0,l[67]=o}while(Ce(d[o>>1]|0)|0);if(lt(o)|0){$e(),p[796]=0,w=81;break s}else o=1}else o=1}while(0);(w|0)==69&&($e(),o=0),p[796]=o,w=81;break s}}case 96:{m=l[68]|0,u=d[396]|0,w=u&65535,l[m+(w<<3)+4>>2]=l[67],d[396]=u+1<<16>>16,l[m+(w<<3)>>2]=3,T(),w=81;break}default:w=81}while(0);(w|0)==81&&(w=0,l[67]=l[70]),o=l[70]|0}if((w|0)==36){ne(),o=0;break}else if((w|0)==49){ne(),o=0;break}else if((w|0)==82){o=p[794]|0?0:(d[395]|d[396])<<16>>16==0;break}}while(0);return v=O,o|0}function $(){var o=0,a=0,u=0,m=0,w=0,g=0,O=0,L=0,M=0,S=0,ae=0,oe=0,N=0,D=0;L=l[70]|0,M=l[63]|0,D=L+12|0,l[70]=D,u=y(1)|0,o=l[70]|0,(o|0)==(D|0)&&!(Ge(u)|0)||(N=3);e:do if((N|0)==3){s:do switch(u<<16>>16){case 123:{for(l[70]=o+2,o=y(1)|0,u=l[70]|0;;){if(Ue(o)|0?(k(o),o=(l[70]|0)+2|0,l[70]=o):(G(o)|0,o=l[70]|0),y(1)|0,o=Y(u,o)|0,o<<16>>16==44&&(l[70]=(l[70]|0)+2,o=y(1)|0),a=u,u=l[70]|0,o<<16>>16==125){N=15;break}if((u|0)==(a|0)){N=12;break}if(u>>>0>(l[71]|0)>>>0){N=14;break}}if((N|0)==12){ne();break e}else if((N|0)==14){ne();break e}else if((N|0)==15){l[70]=u+2;break s}break}case 42:{l[70]=o+2,y(1)|0,D=l[70]|0,Y(D,D)|0;break}default:{switch(p[795]=0,u<<16>>16){case 100:{switch(L=o+14|0,l[70]=L,(y(1)|0)<<16>>16){case 97:{a=l[70]|0,!(Z(a+2|0,56,8)|0)&&(w=a+10|0,Ce(d[w>>1]|0)|0)&&(l[70]=w,y(0)|0,N=22);break}case 102:{N=22;break}case 99:{a=l[70]|0,!(Z(a+2|0,36,8)|0)&&(m=a+10|0,D=d[m>>1]|0,De(D)|0|D<<16>>16==123)&&(l[70]=m,g=y(1)|0,g<<16>>16!=123)&&(oe=g,N=31);break}default:}t:do if((N|0)==22&&(O=l[70]|0,(Z(O+2|0,64,14)|0)==0)){if(u=O+16|0,a=d[u>>1]|0,!(De(a)|0))switch(a<<16>>16){case 40:case 42:break;default:break t}l[70]=u,a=y(1)|0,a<<16>>16==42&&(l[70]=(l[70]|0)+2,a=y(1)|0),a<<16>>16!=40&&(oe=a,N=31)}while(0);if((N|0)==31&&(S=l[70]|0,G(oe)|0,ae=l[70]|0,ae>>>0>S>>>0)){be(o,L,S,ae),l[70]=(l[70]|0)+-2;break e}be(o,L,0,0),l[70]=o+12;break e}case 97:{l[70]=o+10,y(0)|0,o=l[70]|0,N=35;break}case 102:{N=35;break}case 99:{if(!(Z(o+2|0,36,8)|0)&&(a=o+10|0,Ne(d[a>>1]|0)|0)){l[70]=a,D=y(1)|0,N=l[70]|0,G(D)|0,D=l[70]|0,be(N,D,N,D),l[70]=(l[70]|0)+-2;break e}o=o+4|0,l[70]=o;break}case 108:case 118:break;default:break e}if((N|0)==35){l[70]=o+16,o=y(1)|0,o<<16>>16==42&&(l[70]=(l[70]|0)+2,o=y(1)|0),N=l[70]|0,G(o)|0,D=l[70]|0,be(N,D,N,D),l[70]=(l[70]|0)+-2;break e}l[70]=o+6,p[795]=0,u=y(1)|0,o=l[70]|0,u=(G(u)|0|32)<<16>>16==123,m=l[70]|0,u&&(l[70]=m+2,D=y(1)|0,o=l[70]|0,G(D)|0);t:for(;a=l[70]|0,(a|0)!=(o|0);){if(be(o,a,o,a),a=y(1)|0,u)switch(a<<16>>16){case 93:case 125:break e;default:}if(o=l[70]|0,a<<16>>16!=44){N=51;break}switch(l[70]=o+2,a=y(1)|0,o=l[70]|0,a<<16>>16){case 91:case 123:{N=51;break t}default:}G(a)|0}if((N|0)==51&&(l[70]=o+-2),!u)break e;l[70]=m+-2;break e}}while(0);if(D=(y(1)|0)<<16>>16==102,o=l[70]|0,D&&!(Z(o+2|0,50,6)|0))for(l[70]=o+8,R(L,y(1)|0),o=M|0?M+16|0:232;;){if(o=l[o>>2]|0,!o)break e;l[o+12>>2]=0,l[o+8>>2]=0,o=o+16|0}l[70]=o+-2}while(0)}function A(){var o=0,a=0,u=0,m=0,w=0,g=0;w=l[70]|0,o=w+12|0,l[70]=o;e:do switch((y(1)|0)<<16>>16){case 40:{if(a=l[68]|0,g=d[396]|0,u=g&65535,l[a+(u<<3)>>2]=5,o=l[70]|0,d[396]=g+1<<16>>16,l[a+(u<<3)+4>>2]=o,(d[l[67]>>1]|0)!=46){switch(l[70]=o+2,g=y(1)|0,K(w,l[70]|0,0,o),a=l[61]|0,u=l[69]|0,w=d[395]|0,d[395]=w+1<<16>>16,l[u+((w&65535)<<2)>>2]=a,g<<16>>16){case 39:{k(39);break}case 34:{k(34);break}default:{l[70]=(l[70]|0)+-2;break e}}switch(o=(l[70]|0)+2|0,l[70]=o,(y(1)|0)<<16>>16){case 44:{l[70]=(l[70]|0)+2,y(1)|0,w=l[61]|0,l[w+4>>2]=o,g=l[70]|0,l[w+16>>2]=g,p[w+24>>0]=1,l[70]=g+-2;break e}case 41:{d[396]=(d[396]|0)+-1<<16>>16,g=l[61]|0,l[g+4>>2]=o,l[g+12>>2]=(l[70]|0)+2,p[g+24>>0]=1,d[395]=(d[395]|0)+-1<<16>>16;break e}default:{l[70]=(l[70]|0)+-2;break e}}}break}case 46:{if(l[70]=(l[70]|0)+2,(y(1)|0)<<16>>16==109&&(a=l[70]|0,(Z(a+2|0,44,6)|0)==0)){if(o=l[67]|0,!(ct(o)|0)&&(d[o>>1]|0)==46)break e;K(w,w,a+8|0,2)}break}case 42:case 39:case 34:{m=18;break}case 123:{if(o=l[70]|0,d[396]|0){l[70]=o+-2;break e}for(;!(o>>>0>=(l[71]|0)>>>0);){if(o=y(1)|0,Ue(o)|0)k(o);else if(o<<16>>16==125){m=33;break}o=(l[70]|0)+2|0,l[70]=o}if((m|0)==33&&(l[70]=(l[70]|0)+2),g=(y(1)|0)<<16>>16==102,o=l[70]|0,g&&Z(o+2|0,50,6)|0){ne();break e}if(l[70]=o+8,o=y(1)|0,Ue(o)|0){R(w,o);break e}else{ne();break e}}default:(l[70]|0)==(o|0)?l[70]=w+10:m=18}while(0);do if((m|0)==18){if(d[396]|0){l[70]=(l[70]|0)+-2;break}for(o=l[71]|0,a=l[70]|0;;){if(a>>>0>=o>>>0){m=25;break}if(u=d[a>>1]|0,Ue(u)|0){m=23;break}g=a+2|0,l[70]=g,a=g}if((m|0)==23){R(w,u);break}else if((m|0)==25){ne();break}}while(0)}function R(o,a){o=o|0,a=a|0;var u=0,m=0;switch(u=(l[70]|0)+2|0,a<<16>>16){case 39:{k(39),m=5;break}case 34:{k(34),m=5;break}default:ne()}do if((m|0)==5){if(K(o,u,l[70]|0,1),l[70]=(l[70]|0)+2,a=y(0)|0,o=a<<16>>16==97,o?(u=l[70]|0,Z(u+2|0,78,10)|0&&(m=11)):(u=l[70]|0,a<<16>>16==119&&(d[u+2>>1]|0)==105&&(d[u+4>>1]|0)==116&&(d[u+6>>1]|0)==104||(m=11)),(m|0)==11){l[70]=u+-2;break}if(l[70]=u+((o?6:4)<<1),(y(1)|0)<<16>>16!=123){l[70]=u;break}o=l[70]|0,a=o;e:for(;;){switch(l[70]=a+2,a=y(1)|0,a<<16>>16){case 39:{k(39),l[70]=(l[70]|0)+2,a=y(1)|0;break}case 34:{k(34),l[70]=(l[70]|0)+2,a=y(1)|0;break}default:a=G(a)|0}if(a<<16>>16!=58){m=20;break}switch(l[70]=(l[70]|0)+2,(y(1)|0)<<16>>16){case 39:{k(39);break}case 34:{k(34);break}default:{m=24;break e}}switch(l[70]=(l[70]|0)+2,(y(1)|0)<<16>>16){case 125:{m=29;break e}case 44:break;default:{m=28;break e}}if(l[70]=(l[70]|0)+2,(y(1)|0)<<16>>16==125){m=29;break}a=l[70]|0}if((m|0)==20){l[70]=u;break}else if((m|0)==24){l[70]=u;break}else if((m|0)==28){l[70]=u;break}else if((m|0)==29){m=l[61]|0,l[m+16>>2]=o,l[m+12>>2]=(l[70]|0)+2;break}}while(0)}function x(o){o=o|0;e:do switch(d[o>>1]|0){case 100:switch(d[o+-2>>1]|0){case 105:{o=B(o+-4|0,88,2)|0;break e}case 108:{o=B(o+-4|0,92,3)|0;break e}default:{o=0;break e}}case 101:switch(d[o+-2>>1]|0){case 115:switch(d[o+-4>>1]|0){case 108:{o=Re(o+-6|0,101)|0;break e}case 97:{o=Re(o+-6|0,99)|0;break e}default:{o=0;break e}}case 116:{o=B(o+-4|0,98,4)|0;break e}case 117:{o=B(o+-4|0,106,6)|0;break e}default:{o=0;break e}}case 102:{if((d[o+-2>>1]|0)==111&&(d[o+-4>>1]|0)==101)switch(d[o+-6>>1]|0){case 99:{o=B(o+-8|0,118,6)|0;break e}case 112:{o=B(o+-8|0,130,2)|0;break e}default:{o=0;break e}}else o=0;break}case 107:{o=B(o+-2|0,134,4)|0;break}case 110:{o=o+-2|0,Re(o,105)|0?o=1:o=B(o,142,5)|0;break}case 111:{o=Re(o+-2|0,100)|0;break}case 114:{o=B(o+-2|0,152,7)|0;break}case 116:{o=B(o+-2|0,166,4)|0;break}case 119:switch(d[o+-2>>1]|0){case 101:{o=Re(o+-4|0,110)|0;break e}case 111:{o=B(o+-4|0,174,3)|0;break e}default:{o=0;break e}}default:o=0}while(0);return o|0}function T(){var o=0,a=0,u=0,m=0;a=l[71]|0,u=l[70]|0;e:for(;;){if(o=u+2|0,u>>>0>=a>>>0){a=10;break}switch(d[o>>1]|0){case 96:{a=7;break e}case 36:{if((d[u+4>>1]|0)==123){a=6;break e}break}case 92:{o=u+4|0;break}default:}u=o}(a|0)==6?(o=u+4|0,l[70]=o,a=l[68]|0,m=d[396]|0,u=m&65535,l[a+(u<<3)>>2]=4,d[396]=m+1<<16>>16,l[a+(u<<3)+4>>2]=o):(a|0)==7?(l[70]=o,u=l[68]|0,m=(d[396]|0)+-1<<16>>16,d[396]=m,(l[u+((m&65535)<<3)>>2]|0)!=3&&ne()):(a|0)==10&&(l[70]=o,ne())}function y(o){o=o|0;var a=0,u=0,m=0;u=l[70]|0;e:do{a=d[u>>1]|0;s:do if(a<<16>>16!=47)if(o){if(De(a)|0)break;break e}else{if(Ce(a)|0)break;break e}else switch(d[u+2>>1]|0){case 47:{je();break s}case 42:{Ye(o);break s}default:{a=47;break e}}while(0);m=l[70]|0,u=m+2|0,l[70]=u}while(m>>>0<(l[71]|0)>>>0);return a|0}function k(o){o=o|0;var a=0,u=0,m=0,w=0;for(w=l[71]|0,a=l[70]|0;;){if(m=a+2|0,a>>>0>=w>>>0){a=9;break}if(u=d[m>>1]|0,u<<16>>16==o<<16>>16){a=10;break}if(u<<16>>16==92)u=a+4|0,(d[u>>1]|0)==13?(a=a+6|0,a=(d[a>>1]|0)==10?a:u):a=u;else if(ft(u)|0){a=9;break}else a=m}(a|0)==9?(l[70]=m,ne()):(a|0)==10&&(l[70]=m)}function Y(o,a){o=o|0,a=a|0;var u=0,m=0,w=0,g=0;return u=l[70]|0,m=d[u>>1]|0,g=(o|0)==(a|0),w=g?0:o,g=g?0:a,m<<16>>16==97&&(l[70]=u+4,u=y(1)|0,o=l[70]|0,Ue(u)|0?(k(u),a=(l[70]|0)+2|0,l[70]=a):(G(u)|0,a=l[70]|0),m=y(1)|0,u=l[70]|0),(u|0)!=(o|0)&&be(o,a,w,g),m|0}function K(o,a,u,m){o=o|0,a=a|0,u=u|0,m=m|0;var w=0,g=0;w=l[65]|0,l[65]=w+32,g=l[61]|0,l[(g|0?g+28|0:228)>>2]=w,l[62]=g,l[61]=w,l[w+8>>2]=o,(m|0)==2?o=u:o=(m|0)==1?u+2|0:0,l[w+12>>2]=o,l[w>>2]=a,l[w+4>>2]=u,l[w+16>>2]=0,l[w+20>>2]=m,p[w+24>>0]=(m|0)==1&1,l[w+28>>2]=0}function ye(){var o=0,a=0,u=0;u=l[71]|0,a=l[70]|0;e:for(;;){if(o=a+2|0,a>>>0>=u>>>0){a=6;break}switch(d[o>>1]|0){case 13:case 10:{a=6;break e}case 93:{a=7;break e}case 92:{o=a+4|0;break}default:}a=o}return(a|0)==6?(l[70]=o,ne(),o=0):(a|0)==7&&(l[70]=o,o=93),o|0}function $e(){var o=0,a=0,u=0;e:for(;;){if(o=l[70]|0,a=o+2|0,l[70]=a,o>>>0>=(l[71]|0)>>>0){u=7;break}switch(d[a>>1]|0){case 13:case 10:{u=7;break e}case 47:break e;case 91:{ye()|0;break}case 92:{l[70]=o+4;break}default:}}(u|0)==7&&ne()}function me(o){switch(o=o|0,d[o>>1]|0){case 62:{o=(d[o+-2>>1]|0)==61;break}case 41:case 59:{o=1;break}case 104:{o=B(o+-2|0,200,4)|0;break}case 121:{o=B(o+-2|0,208,6)|0;break}case 101:{o=B(o+-2|0,220,3)|0;break}default:o=0}return o|0}function Ye(o){o=o|0;var a=0,u=0,m=0,w=0,g=0;for(w=(l[70]|0)+2|0,l[70]=w,u=l[71]|0;a=w+2|0,!(w>>>0>=u>>>0||(m=d[a>>1]|0,!o&&ft(m)|0));){if(m<<16>>16==42&&(d[w+4>>1]|0)==47){g=8;break}w=a}(g|0)==8&&(l[70]=a,a=w+4|0),l[70]=a}function Z(o,a,u){o=o|0,a=a|0,u=u|0;var m=0,w=0;e:do if(!u)o=0;else{for(;m=p[o>>0]|0,w=p[a>>0]|0,m<<24>>24==w<<24>>24;)if(u=u+-1|0,u)o=o+1|0,a=a+1|0;else{o=0;break e}o=(m&255)-(w&255)|0}while(0);return o|0}function Ge(o){o=o|0;e:do switch(o<<16>>16){case 38:case 37:case 33:{o=1;break}default:if((o&-8)<<16>>16==40|(o+-58&65535)<6)o=1;else{switch(o<<16>>16){case 91:case 93:case 94:{o=1;break e}default:}o=(o+-123&65535)<4}}while(0);return o|0}function Lt(o){o=o|0;e:do switch(o<<16>>16){case 38:case 37:case 33:break;default:if(!((o+-58&65535)<6|(o+-40&65535)<7&o<<16>>16!=41)){switch(o<<16>>16){case 91:case 94:break e;default:}return o<<16>>16!=125&(o+-123&65535)<4|0}}while(0);return 1}function ot(o){o=o|0;var a=0;a=d[o>>1]|0;e:do if((a+-9&65535)>=5){switch(a<<16>>16){case 160:case 32:{a=1;break e}default:}if(Ge(a)|0)return a<<16>>16!=46|(ct(o)|0)|0;a=0}else a=1;while(0);return a|0}function xe(o){o=o|0;var a=0,u=0,m=0,w=0;return u=v,v=v+16|0,m=u,l[m>>2]=0,l[64]=o,a=l[3]|0,w=a+(o<<1)|0,o=w+2|0,d[w>>1]=0,l[m>>2]=o,l[65]=o,l[57]=0,l[61]=0,l[59]=0,l[58]=0,l[63]=0,l[60]=0,v=u,a|0}function B(o,a,u){o=o|0,a=a|0,u=u|0;var m=0,w=0;return m=o+(0-u<<1)|0,w=m+2|0,o=l[3]|0,w>>>0>=o>>>0&&!(Z(w,a,u<<1)|0)?(w|0)==(o|0)?o=1:o=ot(m)|0:o=0,o|0}function be(o,a,u,m){o=o|0,a=a|0,u=u|0,m=m|0;var w=0,g=0;w=l[65]|0,l[65]=w+20,g=l[63]|0,l[(g|0?g+16|0:232)>>2]=w,l[63]=w,l[w>>2]=o,l[w+4>>2]=a,l[w+8>>2]=u,l[w+12>>2]=m,l[w+16>>2]=0}function lt(o){switch(o=o|0,d[o>>1]|0){case 107:{o=B(o+-2|0,134,4)|0;break}case 101:{(d[o+-2>>1]|0)==117?o=B(o+-4|0,106,6)|0:o=0;break}default:o=0}return o|0}function Re(o,a){o=o|0,a=a|0;var u=0;return u=l[3]|0,u>>>0<=o>>>0&&(d[o>>1]|0)==a<<16>>16?(u|0)==(o|0)?u=1:u=Ne(d[o+-2>>1]|0)|0:u=0,u|0}function Ne(o){o=o|0;e:do if((o+-9&65535)<5)o=1;else{switch(o<<16>>16){case 32:case 160:{o=1;break e}default:}o=o<<16>>16!=46&(Ge(o)|0)}while(0);return o|0}function je(){var o=0,a=0,u=0;o=l[71]|0,u=l[70]|0;e:for(;a=u+2|0,!(u>>>0>=o>>>0);)switch(d[a>>1]|0){case 13:case 10:break e;default:u=a}l[70]=a}function G(o){for(o=o|0;!(De(o)|0||Ge(o)|0);)if(o=(l[70]|0)+2|0,l[70]=o,o=d[o>>1]|0,!(o<<16>>16)){o=0;break}return o|0}function Pe(){var o=0;switch(o=l[(l[59]|0)+20>>2]|0,o|0){case 1:{o=-1;break}case 2:{o=-2;break}default:o=o-(l[3]|0)>>1}return o|0}function F(o){return o=o|0,!(B(o,180,5)|0)&&!(B(o,190,3)|0)?o=B(o,196,2)|0:o=1,o|0}function Ce(o){switch(o=o|0,o<<16>>16){case 160:case 32:case 12:case 11:case 9:{o=1;break}default:o=0}return o|0}function ct(o){return o=o|0,(d[o>>1]|0)==46&&(d[o+-2>>1]|0)==46?o=(d[o+-4>>1]|0)==46:o=0,o|0}function Me(o){return o=o|0,(l[3]|0)==(o|0)?o=1:o=ot(o+-2|0)|0,o|0}function Q(){var o=0;return o=l[(l[60]|0)+12>>2]|0,o?o=o-(l[3]|0)>>1:o=-1,o|0}function It(){var o=0;return o=l[(l[59]|0)+12>>2]|0,o?o=o-(l[3]|0)>>1:o=-1,o|0}function Tt(){var o=0;return o=l[(l[60]|0)+8>>2]|0,o?o=o-(l[3]|0)>>1:o=-1,o|0}function $t(){var o=0;return o=l[(l[59]|0)+16>>2]|0,o?o=o-(l[3]|0)>>1:o=-1,o|0}function jt(){var o=0;return o=l[(l[59]|0)+4>>2]|0,o?o=o-(l[3]|0)>>1:o=-1,o|0}function Pt(){var o=0;return o=l[59]|0,o=l[(o|0?o+28|0:228)>>2]|0,l[59]=o,(o|0)!=0|0}function St(){var o=0;return o=l[60]|0,o=l[(o|0?o+16|0:232)>>2]|0,l[60]=o,(o|0)!=0|0}function ne(){p[794]=1,l[66]=(l[70]|0)-(l[3]|0)>>1,l[70]=(l[71]|0)+2}function De(o){return o=o|0,(o|128)<<16>>16==160|(o+-9&65535)<5|0}function Ue(o){return o=o|0,o<<16>>16==39|o<<16>>16==34|0}function Je(){return(l[(l[59]|0)+8>>2]|0)-(l[3]|0)>>1|0}function At(){return(l[(l[60]|0)+4>>2]|0)-(l[3]|0)>>1|0}function ft(o){return o=o|0,o<<16>>16==13|o<<16>>16==10|0}function xt(){return(l[l[59]>>2]|0)-(l[3]|0)>>1|0}function Nt(){return(l[l[60]>>2]|0)-(l[3]|0)>>1|0}function Ct(){return b[(l[59]|0)+24>>0]|0|0}function Mt(o){o=o|0,l[3]=o}function Ke(){return(p[795]|0)!=0|0}function Dt(){return l[66]|0}function Ut(o){return o=o|0,v=o+992+15&-16,992}return{su:Ut,ai:$t,e:Dt,ee:At,ele:Q,els:Tt,es:Nt,f:Ke,id:Pe,ie:jt,ip:Ct,is:xt,p:E,re:St,ri:Pt,sa:xe,se:It,ses:Mt,ss:Je}}(typeof self<"u"?self:global,{},ut),Wt=X.su(Ze-(2<<17))}const n=q.length+1;X.ses(Wt),X.sa(n-1),js(q,new Uint16Array(ut,Wt,n)),X.p()||(z=X.e(),Ae());const i=[],r=[];for(;X.ri();){const c=X.is(),f=X.ie(),h=X.ai(),p=X.id(),d=X.ss(),l=X.se();let b;X.ip()&&(b=zt(p===-1?c:c+1,q.charCodeAt(p===-1?c-1:c))),i.push({n:b,s:c,e:f,ss:d,se:l,d:p,a:h})}for(;X.re();){const c=X.es(),f=X.ee(),h=X.els(),p=X.ele(),d=q.charCodeAt(c),l=h>=0?q.charCodeAt(h):-1;r.push({s:c,e:f,ls:h,le:p,n:d===34||d===39?zt(c+1,d):q.slice(c,f),ln:h<0?void 0:l===34||l===39?zt(h+1,l):q.slice(h,p)})}return[i,r,!!X.f()]}function zt(s,e){z=s;let t="",n=z;for(;;){z>=q.length&&Ae();const i=q.charCodeAt(z);if(i===e)break;i===92?(t+=q.slice(n,z),t+=Rn(),n=z):(i===8232||i===8233||en(i)&&Ae(),++z)}return t+=q.slice(n,z++),t}function Rn(){let s=q.charCodeAt(++z);switch(++z,s){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(Ft(2));case 117:return function(){const e=q.charCodeAt(z);let t;return e===123?(++z,t=Ft(q.indexOf("}",z)-z),++z,t>1114111&&Ae()):t=Ft(4),t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}();case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:q.charCodeAt(z)===10&&++z;case 10:return"";case 56:case 57:Ae();default:if(s>=48&&s<=55){let e=q.substr(z-1,3).match(/^[0-7]+/)[0],t=parseInt(e,8);return t>255&&(e=e.slice(0,-1),t=parseInt(e,8)),z+=e.length-1,s=q.charCodeAt(z),e==="0"&&s!==56&&s!==57||Ae(),String.fromCharCode(t)}return en(s)?"":String.fromCharCode(s)}}function Ft(s){const e=z;let t=0,n=0;for(let i=0;i<s;++i,++z){let r,c=q.charCodeAt(z);if(c!==95){if(c>=97)r=c-97+10;else if(c>=65)r=c-65+10;else{if(!(c>=48&&c<=57))break;r=c-48}if(r>=16)break;n=c,t=16*t+r}else n!==95&&i!==0||Ae(),n=c}return n!==95&&z-e===s||Ae(),t}function en(s){return s===13||s===10}function Ae(){throw Object.assign(Error(`Parse error ${Zs}:${q.slice(0,z).split(`
`).length}:${z-q.lastIndexOf(`
`,z-1)}`),{idx:z})}const On=["__dirname","__filename","exports","module","require"];let Bt;async function Ps(s,e,t){Bt||({default:Bt}=await Fe(()=>import("./index-835b9dac.js").then(f=>f.i),["assets/index-835b9dac.js","assets/_commonjsHelpers-de833af9.js","assets/index-812d989a.js","assets/browser-f8dbb0d6.js"]));const n=new Set,i=new Set,r=new Set;Bt.transform(e,{ast:!1,sourceMaps:!1,inputSourceMap:!1,babelrc:!1,babelrcRoots:!1,configFile:!1,highlightCode:!1,compact:!1,sourceType:"script",parserOpts:{allowReturnOutsideFunction:!0,errorRecovery:!0},plugins:[({types:f})=>({visitor:{Program(h,p){p.functionDepth=0},CallExpression(h,p){if(f.isIdentifier(h.node.callee,{name:"require"})||f.isIdentifier(h.node.callee.object,{name:"require"})&&f.isIdentifier(h.node.callee.property,{name:"resolve"})||f.isMemberExpression(h.node.callee)&&f.isIdentifier(h.node.callee.object,{name:"module"})&&f.isIdentifier(h.node.callee.property,{name:"require"})){const d=yt(h.get("arguments.0").node,t);n.add(d),p.functionDepth>0&&i.add(d)}},ReferencedIdentifier(h){let p=h.node.name;h.scope.hasBinding(p)||r.add(p)},Scope:{enter(h,p){f.isFunction(h.scope.block)&&p.functionDepth++},exit(h,p){f.isFunction(h.scope.block)&&p.functionDepth--}}}})]});let c=!1;for(let f of On)if(r.has(f)){c=!0;break}return{deps:[...n],dynamicDeps:s.filter(f=>f.n).map(f=>f.n),cjsLazyDeps:[...i],size:e.length,format:"commonjs",usesCjs:c}}function yt(s,e,t=!1,n=!1){if(s.type==="StringLiteral")return s.value;if(s.type==="TemplateLiteral"){let i="";for(let r=0;r<s.quasis.length;r++){const c=s.quasis[r].value.cooked;c.length&&(i+=c,n=!1);const f=s.expressions[r];if(f){const h=yt(f,e,t,n);h.length&&(n=h.endsWith("*"),i+=h)}}return i}if(s.type==="BinaryExpression"&&s.operator==="+"){const i=yt(s.left,e,t,n);i.length&&(n=i.endsWith("*"));const r=yt(s.right,e,t,n);return i+r}if(s.type==="Identifier"){if(s.name==="__dirname")return".";if(s.name==="__filename")return"./"+e}return n?"":"*"}let Gt,Ss,As;const kn=globalThis.console,Ln={log(){},warn(){},memory(){},assert(){},clear(){},count(){},countReset(){},debug(){},dir(){},dirxml(){},error(){},exception(){},group(){},groupCollapsed(){},groupEnd(){},info(){},table(){},time(){},timeEnd(){},timeLog(){},timeStamp(){},trace(){}};async function In(s,e){Gt||([{default:Gt},{default:{default:Ss}},{default:As}]=await Promise.all([Fe(()=>import("./index-835b9dac.js").then(r=>r.i),["assets/index-835b9dac.js","assets/_commonjsHelpers-de833af9.js","assets/index-812d989a.js","assets/browser-f8dbb0d6.js"]),Fe(()=>import("./index-967e443f.js").then(r=>r.i),["assets/index-967e443f.js","assets/_commonjsHelpers-de833af9.js","assets/index-81878805.js","assets/index-812d989a.js","assets/browser-f8dbb0d6.js"]),Fe(()=>import("./index-bd971562.js").then(r=>r.i),["assets/index-bd971562.js","assets/index-81878805.js"])]));const t=new Set,n=new Set;let i=!1;globalThis.console=Ln;try{Gt.transform(s,{filename:"/"+e,ast:!1,sourceMaps:!1,inputSourceMap:!1,babelrc:!1,babelrcRoots:!1,configFile:!1,highlightCode:!1,compact:!1,sourceType:"module",parserOpts:{plugins:["jsx"],errorRecovery:!0},presets:[[Ss,{onlyRemoveTypeImports:!0}]],plugins:[As,({types:r})=>({visitor:{ExportAllDeclaration(c){t.add(c.node.source.value)},ExportNamedDeclaration(c){c.node.source&&t.add(c.node.source.value)},ImportDeclaration(c){t.add(c.node.source.value)},Import(c){n.add(bt(c.parentPath.get("arguments.0").node,e,!0))},MetaProperty(c){r.isIdentifier(c.node.meta,{name:"import"})&&r.isIdentifier(c.node.property,{name:"meta"})&&(i=!0)}}})]})}finally{globalThis.console=kn}return{deps:[...t],dynamicDeps:[...n],cjsLazyDeps:null,size:s.length,format:"typescript"}}function bt(s,e,t=!1,n=!1){if(s.type==="StringLiteral")return s.value;if(s.type==="TemplateLiteral"){let i="";for(let r=0;r<s.quasis.length;r++){const c=s.quasis[r].value.cooked;c.length&&(i+=c,n=!1);const f=s.expressions[r];if(f){const h=bt(f,e,t,n);h.length&&(n=h.endsWith("*"),i+=h)}}return i}if(s.type==="BinaryExpression"&&s.operator==="+"){const i=bt(s.left,e,t,n);i.length&&(n=i.endsWith("*"));const r=bt(s.right,e,t,n);return i+r}if(t&&s.type==="Identifier"){if(s.name==="__dirname")return".";if(s.name==="__filename")return"./"+e}return n?"":"*"}class C extends Error{constructor(e,t){super(e),this.jspmError=!0,this.code=t}}function kt(...s){throw new Error("Internal Error"+(s.length?" "+s.join(", "):""))}function Tn(s){return s==="file:"||s==="https:"||s==="http:"||s==="data:"}let pe;if(typeof Deno<"u"){const s=Deno.cwd();pe=new URL("file://"+(s[0]==="/"?"":"/")+s+"/")}else typeof process<"u"&&process.versions.node?pe=new URL("file://"+process.cwd()+"/"):typeof document<"u"&&(pe=new URL(document.baseURI));!pe&&typeof location<"u"&&(pe=new URL(location.href));pe.search=pe.hash="";function ge(s,e,t){return s.startsWith("/")?t?new URL("."+s.slice(s[1]==="/"?1:0),t).href:s:new URL(s,e).href}function Ie(s){return s?` imported from ${s}`:""}function $n(s,e){return s.protocol===e.protocol&&s.host===e.host&&s.port===e.port&&s.username===e.username&&s.password===e.password}function Jt(s,e,t=!1){const n=s.href;let i=e.href;if(i.endsWith("/")||(i+="/"),n.startsWith(i))return(t?"/":"./")+n.slice(i.length);if(!$n(s,e)||t)return s.href;const r=e.pathname,c=s.pathname,f=Math.min(r.length,c.length);let h=-1;for(let p=0;p<f&&r[p]===c[p];p++)c[p]==="/"&&(h=p);return"../".repeat(r.slice(h+1).split("/").length-1)+c.slice(h+1)+s.search+s.hash}function Rs(s){try{if(s[0]==="#")return!1;new URL(s)}catch{return!1}return!0}function Le(s){return!tn(s)&&!Rs(s)}function tn(s){return s.startsWith("./")||s.startsWith("../")||s.startsWith("/")}const vt="https://deno.land/x/",ze="https://deno.land/std";let qt;function jn(s,e){if(e.includes("deno")&&s.startsWith("npm:"))return s;if(s.startsWith("deno:")){let t=s.slice(5);t.endsWith(".ts")&&(t=t.slice(0,-3));let n=t,i=".";const r=t.indexOf("/");return r!==-1&&(n=t.slice(0,r),i=`./${t.slice(r+1)}`),{alias:n,subpath:i,target:{pkgTarget:{registry:"deno",name:"std",ranges:[new Te("*")],unstable:!0},installSubpath:`./${r===-1?t:t.slice(0,r)}`}}}}async function Pn(s){if(s.registry==="deno")return`${ze}@${s.version}/`;if(s.registry==="denoland")return`${vt}${s.name}@${sn[s.name]?"v":""}${s.version}/`;throw new Error(`Deno provider does not support the ${s.registry} registry for package "${s.name}" - perhaps you mean to install "denoland:${s.name}"?`)}async function Sn(s){if(s.startsWith("https://deno.land/std@"))return{exports:{"./archive":"./archive/mod.ts","./archive/*.ts":"./archive/*.ts","./archive/*":"./archive/*.ts","./async":"./async/mod.ts","./async/*.ts":"./async/*.ts","./async/*":"./async/*.ts","./bytes":"./bytes/mod.ts","./bytes/*.ts":"./bytes/*.ts","./bytes/*":"./bytes/*.ts","./collection":"./collection/mod.ts","./collection/*.ts":"./collection/*.ts","./collection/*":"./collection/*.ts","./crypto":"./crypto/mod.ts","./crypto/*.ts":"./crypto/*.ts","./crypto/*":"./crypto/*.ts","./datetime":"./datetime/mod.ts","./datetime/*.ts":"./datetime/*.ts","./datetime/*":"./datetime/*.ts","./dotenv":"./dotenv/mod.ts","./dotenv/*.ts":"./dotenv/*.ts","./dotenv/*":"./dotenv/*.ts","./encoding":"./encoding/mod.ts","./encoding/*.ts":"./encoding/*.ts","./encoding/*":"./encoding/*.ts","./examples":"./examples/mod.ts","./examples/*.ts":"./examples/*.ts","./examples/*":"./examples/*.ts","./flags":"./flags/mod.ts","./flags/*.ts":"./flags/*.ts","./flags/*":"./flags/*.ts","./fmt":"./fmt/mod.ts","./fmt/*.ts":"./fmt/*.ts","./fmt/*":"./fmt/*.ts","./fs":"./fs/mod.ts","./fs/*.ts":"./fs/*.ts","./fs/*":"./fs/*.ts","./hash":"./hash/mod.ts","./hash/*.ts":"./hash/*.ts","./hash/*":"./hash/*.ts","./http":"./http/mod.ts","./http/*.ts":"./http/*.ts","./http/*":"./http/*.ts","./io":"./io/mod.ts","./io/*.ts":"./io/*.ts","./io/*":"./io/*.ts","./log":"./log/mod.ts","./log/*.ts":"./log/*.ts","./log/*":"./log/*.ts","./media_types":"./media_types/mod.ts","./media_types/*.ts":"./media_types/*.ts","./media_types/*":"./media_types/*.ts","./node":"./node/mod.ts","./node/*.ts":"./node/*.ts","./node/*":"./node/*.ts","./path":"./path/mod.ts","./path/*.ts":"./path/*.ts","./path/*":"./path/*.ts","./permissions":"./permissions/mod.ts","./permissions/*.ts":"./permissions/*.ts","./permissions/*":"./permissions/*.ts","./signal":"./signal/mod.ts","./signal/*.ts":"./signal/*.ts","./signal/*":"./signal/*.ts","./streams":"./streams/mod.ts","./streams/*.ts":"./streams/*.ts","./streams/*":"./streams/*.ts","./testing":"./testing/mod.ts","./testing/*.ts":"./testing/*.ts","./testing/*":"./testing/*.ts","./textproto":"./textproto/mod.ts","./textproto/*.ts":"./textproto/*.ts","./textproto/*":"./textproto/*.ts","./uuid":"./uuid/mod.ts","./uuid/*.ts":"./uuid/*.ts","./uuid/*":"./uuid/*.ts","./version":"./version.ts","./version.ts":"./version.ts","./wasi":"./wasi/mod.ts","./wasi/*.ts":"./wasi/*.ts","./wasi/*":"./wasi*.ts"}};const e=new URL("package.json",s),t=await ce(e.href,this.fetchOpts);switch(t.status){case 200:case 304:return await t.json()}return null}const sn={};function nn(s){let e=null;if(s.startsWith(ze)&&s[ze.length]==="@"){const t=s.slice(ze.length+1,s.indexOf("/",ze.length+1));e=s.slice(ze.length+t.length+2),e.endsWith("/mod.ts")?e=e.slice(0,-7):e.endsWith(".ts")&&(e=e.slice(0,-3));const n=e.indexOf("/")===-1?e:e.slice(0,e.indexOf("/"));return{pkg:{registry:"deno",name:"std",version:t},layer:"default",subpath:`./${n}${e?`./${e}/mod.ts`:""}`}}else if(s.startsWith(vt)){const t=s.slice(vt.length),n=t.indexOf("@");if(n===-1)return;const i=t.indexOf("/",n),r=t.slice(0,n),c=t.slice(n+((sn[r]=t[n+1]==="v")?2:1),i===-1?t.length:i);return{pkg:{registry:"denoland",name:r,version:c},subpath:null,layer:"default"}}}async function An(s,e,t){let{registry:n,name:i,range:r}=s;if(qt&&n==="deno")return{registry:n,name:i,version:qt};if(r.isExact)return{registry:n,name:i,version:r.version.toString()};r.isWildcard||(r=new Te(r.version.toString()));const c={...this.fetchOpts,headers:Object.assign({},this.fetchOpts.headers||{},{accept:typeof document>"u"?"text/html":"text/javascript"})},f=n==="denoland"?vt+i+"/mod.ts":ze+"/version.ts",h=await ce(f,c);if(!h.ok)throw new Error(`Deno: Unable to lookup ${f}`);const{version:p}=(await nn(h.url)).pkg;return n==="deno"&&(qt=p),{registry:n,name:i,version:p}}var xn=Object.freeze({__proto__:null,resolveBuiltin:jn,pkgToUrl:Pn,getPackageConfig:Sn,parseUrlPkg:nn,resolveLatestTarget:An});const{SemverRange:et}=Be,Nn=["https","http","data","file","ipfs"];async function Cn(s,e,t){const n=e.indexOf(":");if(tn(e)||n!==-1&&Nn.includes(e.slice(0,n))||ys.has(e.slice(0,n))){let r,c,f=".";const h=ys.has(e.slice(0,n))&&s.resolveBuiltin(e);if(h){if(typeof h=="string")throw new Error(`Builtin "${e}" was resolved to package specifier ${h}, but JSPM does not currently support installing specifiers for builtins.`);({alias:c,subpath:f=".",target:r}=h)}else{var i;const p=e.indexOf("|");p!==-1&&(f=`./${e.slice(p+1)}`,e=e.slice(0,p)),r={pkgTarget:new URL(e+(e.endsWith("/")?"":"/"),t||pe),installSubpath:null};const d=await s.getPackageBase(r.pkgTarget.href);c=((i=d?await s.getPackageConfig(d):null)===null||i===void 0?void 0:i.name)||r.pkgTarget.pathname.split("/").slice(0,-1).pop()}if(!c)throw new C(`Unable to determine an alias for target package ${e}`);return{alias:c,target:r,subpath:f}}}async function Mn(s,e,t,n){const i=await Cn(s,e,t);if(i)return i;const r=e.indexOf(":"),c=e.indexOf("@");if(e.indexOf(":")!==-1&&c!==-1&&c<r)throw new Error("Package aliases not yet supported. PRs welcome.");const f=at(r===-1?e:e.slice(r+1));if(!f)throw new C(`Invalid package name ${e}`);let h=null;r!==-1&&(h=e.slice(0,r));let p=f.pkgName;const d=f.pkgName.indexOf("@",1);d!==-1?p=f.pkgName.slice(0,d):p=f.pkgName;const l=await s.getPackageConfig(t.href);if(d===-1&&l){var b,I,v,E;const $=((b=l.dependencies)===null||b===void 0?void 0:b[p])||((I=l.peerDependencies)===null||I===void 0?void 0:I[p])||((v=l.optionalDependencies)===null||v===void 0?void 0:v[p])||((E=l.devDependencies)===null||E===void 0?void 0:E[p]);if($)return{target:Ee($,t,h||n,f.pkgName),alias:p,subpath:f.subpath}}return{target:Ee(f.pkgName,t,h||n),alias:p,subpath:f.subpath}}function Ee(s,e,t,n){s==="."&&(s="./");let i,r,c;const f=s.indexOf(":");if(s.startsWith("./")||s.startsWith("../")||s.startsWith("/")||f===1)return{pkgTarget:new URL(s,e),installSubpath:null};if(i=f<1?t:s.slice(0,f),i==="file")return{pkgTarget:new URL(s.slice(i.length+1),e),installSubpath:null};if(i==="https"||i==="http")return{pkgTarget:new URL(s),installSubpath:null};const h=s.lastIndexOf("@");let p=!1;if(h>f+1){r=s.slice(f+1,h);const l=s.slice(h+1);c=n||et.isValid(l)?[new et(l)]:l.split("||").map(b=>Is(b)),l===""&&(p=!0)}else f===-1&&n?(r=n,c=et.isValid(s)?[new et(s)]:s.split("||").map(l=>Is(l))):(r=s.slice(f+1),c=[new et("*")]);f===-1&&r.indexOf("/")!==-1&&r[0]!=="@"&&(i="github");const d=r.split("/").length;if(d>2||d===1&&r[0]==="@")throw new C(`Invalid package target ${s}`);return{pkgTarget:{registry:i,name:r,ranges:c,unstable:p},installSubpath:null}}function Dn(s){return`${s.registry?s.registry+":":""}${s.name}${s.version?"@"+s.version:""}`}function Un(s){const e=at(s);if(!e||e.subpath!==".")throw new Error(`"${s}" is not a valid npm-style package name. Subpaths must be provided separately to the installation package name.`)}function at(s){let e=s.indexOf("/");if(s[0]==="@"){if(e===-1)return;e=s.indexOf("/",e+1)}return e===-1?{pkgName:s,subpath:"."}:{pkgName:s.slice(0,e),subpath:`.${s.slice(e)}`}}const Et="https://ga.jspm.io/",us="https://ga.system.jspm.io/",_n="https://api.jspm.io/",Wn=5*60*1e3,zn=5*1e3,Fn=["default","system"];async function Rt(s,e){return`${e==="system"?us:Et}${Dn(s)}/`}const Bn=/^(([a-z]+):)?((?:@[^/\\%@]+\/)?[^./\\%@][^/\\%@]*)@([^\/]+)(\/.*)?$/;function Gn(s){let e=null,t;if(s.startsWith(Et))t="default";else if(s.startsWith(us))t="system";else return;const[,,n,i,r]=s.slice((t==="default"?Et:us).length).match(Bn)||[];if(n&&i&&r)return n==="npm"&&i==="@jspm/core"&&s.includes("/nodelibs/")&&(e=`./nodelibs/${s.slice(s.indexOf("/nodelibs/")+10).split("/")[1]}`,e&&e.endsWith(".js")?e=e.slice(0,-3):e=null),{pkg:{registry:n,name:i,version:r},layer:t,subpath:e}}let ds={};function Jn(){ds={}}async function xs(s,e){const t=await ce(`${s}package.json`,e);if(t.ok)return!0;const n=await ce(`${s}/_error.log`,e);if(n.ok){const i=await n.text();throw new C(`Resolved dependency ${s} with error:

${i}
Please post an issue at jspm/project on GitHub, or by following the link below:

https://github.com/jspm/project/issues/new?title=CDN%20build%20error%20for%20${encodeURIComponent(s)}&body=_Reporting%20CDN%20Build%20Error._%0A%0A%3C!--%20%20No%20further%20description%20necessary,%20just%20click%20%22Submit%20new%20issue%22%20--%3E`)}return console.error(`Unable to request ${s}package.json - ${t.status} ${t.statusText||"returned"}`),!1}async function tt(s,e){if(await xs(await Rt(s,"default"),e))return;const t=`${s.name}@${s.version}`,n=await ce(`${_n}build/${t}`,e);if(!n.ok&&n.status!==403){const r=(await n.json()).error;throw new C(`Unable to request the JSPM API for a build of ${t}, with error: ${r}.`)}let i=Date.now();for(;;){if(await new Promise(r=>setTimeout(r,zn)),await xs(await Rt(s,"default"),e))return;if(Date.now()-i>=Wn)throw new C(`Timed out waiting for the build of ${t} to be ready on the JSPM CDN. Try again later, or post a JSPM project issue if the issue persists.`)}}async function He(s,e,t){const{registry:n,name:i,range:r,unstable:c}=s;if(r.isExact&&!r.version.tag){const p={registry:n,name:i,version:r.version.toString()};return await tt(p,this.fetchOpts),p}const f=ds[s.registry+":"+s.name]=ds[s.registry+":"+s.name]||{latest:null,majors:Object.create(null),minors:Object.create(null),tags:Object.create(null)};if(r.isWildcard||r.isExact&&r.version.tag==="latest"){let p=await(f.latest||(f.latest=dt.call(this,n,i,"",c,t)));return p instanceof Promise&&(p=await p),p?(this.log("jspm/resolveLatestTarget",`${s.registry}:${s.name}@${r} -> WILDCARD ${p.version}${t?" ["+t+"]":""}`),await tt(p,this.fetchOpts),p):null}if(r.isExact&&r.version.tag){const p=r.version.tag;let d=await(f.tags[p]||(f.tags[p]=dt.call(this,n,i,p,c,t)));return d instanceof Promise&&(d=await d),d?(this.log("jspm/resolveLatestTarget",`${s.registry}:${s.name}@${r} -> TAG ${p}${t?" ["+t+"]":""}`),await tt(d,this.fetchOpts),d):null}let h=!1;if(r.isMajor){const p=r.version.major;let d=await(f.majors[p]||(f.majors[p]=dt.call(this,n,i,p,c,t)));if(d instanceof Promise&&(d=await d),!d)return null;if(r.version.gt(d.version))h=!0;else return this.log("jspm/resolveLatestTarget",`${s.registry}:${s.name}@${r} -> MAJOR ${d.version}${t?" ["+t+"]":""}`),await tt(d,this.fetchOpts),d}if(h||r.isStable){const p=`${r.version.major}.${r.version.minor}`;let d=await(f.minors[p]||(f.minors[p]=dt.call(this,n,i,p,c,t)));return d instanceof Promise&&(d=await d),d?(this.log("jspm/resolveLatestTarget",`${s.registry}:${s.name}@${r} -> MINOR ${d.version}${t?" ["+t+"]":""}`),await tt(d,this.fetchOpts),d):null}return null}function qn(s,e=!1){return`${Et}${s.registry}:${s.name}${s.version?"@"+s.version:e?"@":""}`}async function dt(s,e,t,n,i){const r=await ce(qn({registry:s,name:e,version:t},n),this.fetchOpts);switch(r.status){case 304:case 200:return{registry:s,name:e,version:(await r.text()).trim()};case 404:const c=await Xn(e),h=new Te(String(t)||"*",n).bestMatch(c,n);if(h)return{registry:s,name:e,version:h};throw new C(`Unable to resolve ${s}:${e}@${t} to a valid version${Ie(i)}`);default:throw new C(`Invalid status code ${r.status} looking up "${s}:${e}" - ${r.statusText}${Ie(i)}`)}}const Xt=new Map;async function Xn(s){if(Xt.has(s))return Xt.get(s);const e=await(await ce(`https://npmlookup.jspm.io/${encodeURI(s)}`,{})).json(),t=Object.keys(e.versions||{});return Xt.set(s,t),t}var Ns=Object.freeze({__proto__:null,supportedLayers:Fn,pkgToUrl:Rt,parseUrlPkg:Gn,clearResolveCache:Jn,resolveLatestTarget:He});const ps="https://cdn.skypack.dev/";async function Vn(s){return`${ps}${s.name}@${s.version}/`}const Hn=/^((?:@[^/\\%@]+\/)?[^./\\%@][^/\\%@]*)@([^\/]+)(\/.*)?$/;function Yn(s){if(!s.startsWith(ps))return;const[,e,t]=s.slice(ps.length).match(Hn)||[];if(!(!e||!t))return{registry:"npm",name:e,version:t}}var Kn=Object.freeze({__proto__:null,pkgToUrl:Vn,parseUrlPkg:Yn,resolveLatestTarget:He});const ms="https://cdn.jsdelivr.net/";async function Qn(s){return`${ms}${s.registry}/${s.name}@${s.version}/`}const Zn=/^([^\/]+)\/((?:@[^/\\%@]+\/)?[^./\\%@][^/\\%@]*)@([^\/]+)(\/.*)?$/;function ei(s){if(!s.startsWith(ms))return;const[,e,t,n]=s.slice(ms.length).match(Zn)||[];return{registry:e,name:t,version:n}}var ti=Object.freeze({__proto__:null,pkgToUrl:Qn,parseUrlPkg:ei,resolveLatestTarget:He});const ws="https://unpkg.com/";async function si(s){return`${ws}${s.name}@${s.version}/`}const ni=/^((?:@[^/\\%@]+\/)?[^./\\%@][^/\\%@]*)@([^\/]+)(\/.*)?$/;function ii(s){if(!s.startsWith(ws))return;const[,e,t]=s.slice(ws.length).match(ni)||[];if(e&&t)return{registry:"npm",name:e,version:t}}var ri=Object.freeze({__proto__:null,pkgToUrl:si,parseUrlPkg:ii,resolveLatestTarget:He});const rn=new Set(["_http_agent","_http_client","_http_common","_http_incoming","_http_outgoing","_http_server","_stream_duplex","_stream_passthrough","_stream_readable","_stream_transform","_stream_wrap","_stream_writable","_tls_common","_tls_wrap","assert","assert/strict","async_hooks","buffer","child_process","cluster","console","constants","crypto","dgram","diagnostics_channel","dns","dns/promises","domain","events","fs","fs/promises","http","http2","https","inspector","module","net","os","path","path/posix","path/win32","perf_hooks","process","punycode","querystring","readline","repl","stream","stream/promises","string_decoder","sys","timers","timers/promises","tls","trace_events","tty","url","util","util/types","v8","vm","wasi","worker_threads","zlib"]);async function ai(s,e){return s.registry!=="node"?Rt(s,e):`node:${s.name}/`}function oi(s,e){const t=s.startsWith("node:")?s.slice(5):rn.has(s)?s:null;if(t)return e.includes("deno")||e.includes("node")?`node:${t}`:{target:{pkgTarget:{registry:"npm",name:"@jspm/core",ranges:[new Te("*")],unstable:!0},installSubpath:`./nodelibs/${t}`},alias:t}}async function li(){return{exports:{".":"."}}}async function ci(s,e,t){return s.registry!=="npm"||s.name!=="@jspm/core"?null:He.call(this,{registry:"npm",name:"@jspm/core",range:new Te("*"),unstable:!0},e,t)}function fi(s){if(!s.startsWith("node:"))return;let e=s.slice(5);return e.endsWith("/")&&(e=e.slice(0,-1)),{registry:"node",name:e,version:""}}var hi=Object.freeze({__proto__:null,nodeBuiltinSet:rn,pkgToUrl:ai,resolveBuiltin:oi,getPackageConfig:li,resolveLatestTarget:ci,parseUrlPkg:fi});const gs="https://esm.sh/";async function ui(s){return`${gs}*${s.name}@${s.version}/`}const di=/^(?:v\d+\/)?\*?((?:@[^/\\%@]+\/)?[^./\\%@][^/\\%@]*)@([^\/]+)(\/.*)?$/;function pi(s){if(!s.startsWith(gs))return;const[,e,t]=s.slice(gs.length).match(di)||[];if(!(!e||!t))return{registry:"npm",name:e,version:t}}async function mi(s){const e=await ce(`${s}package.json`,this.fetchOpts);switch(e.status){case 200:case 304:break;case 400:case 401:case 403:case 404:case 406:case 500:this.pcfgs[s]=null;return;default:throw new C(`Invalid status code ${e.status} reading package config for ${s}. ${e.statusText}`)}const t=await e.json();if(t.exports)for(const n of Object.keys(t.exports))t.exports[n]=n;if(t.imports)for(const n of Object.keys(t.imports))t.imports[n]=n;return t}var wi=Object.freeze({__proto__:null,pkgToUrl:ui,parseUrlPkg:pi,getPackageConfig:mi,resolveLatestTarget:He});const gi={deno:xn,jsdelivr:ti,node:hi,skypack:Kn,unpkg:ri,"esm.sh":wi,"jspm.io":Ns,jspm:Ns};function Cs(s,e){const t=e[s];if(t)return t;throw new C(`No provider named "${s}" has been defined.`)}const yi={"denoland:":"deno","deno:":"deno"},bi=new Set(["npm","deno","node"]),ys=new Set(["node","deno"]);function an(s,e,t){if(!s.length&&on.test(e))return ln(e,s,t);const n=[],i=[];for(const c of s){if(c.d===-1){n.includes(c.n)||n.push(c.n);continue}if(c.d>=0&&c.n)try{i.push(c.n)}catch{console.warn(`TODO: Dynamic import custom expression tracing in ${t} for:

${e.slice(c.ss,c.se)}
`)}}const r=e.length;return{deps:n,dynamicDeps:i,cjsLazyDeps:null,size:r,format:"esm"}}const on=/^\s*(\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*)*\s*System\s*\.\s*register\s*\(\s*(\[[^\]]*\])\s*,\s*\(?function\s*\(\s*([^\),\s]+\s*(,\s*([^\),\s]+)\s*)?\s*)?\)/;function ln(s,e,t){const[,,,n,,,i]=s.match(on)||[];if(!n)return an(e,s,t);const r=JSON.parse(n.replace(/'/g,'"')),c=[];if(i){const h=`${i}.import(`;let p=-1;for(;(p=s.indexOf(h,p+1))!==-1;){const d=p+h.length+1,l=s[p+h.length];if(l==='"'||l==="'"){const b=s.indexOf(l,p+h.length+1);if(b!==-1)try{c.push(JSON.parse('"'+s.slice(d,b)+'"'));continue}catch{}}console.warn("TODO: Dynamic import custom expression tracing.")}}const f=s.length;return{deps:r,dynamicDeps:c,cjsLazyDeps:null,size:f,format:"system"}}let Vt,Ms;function vi(s){return s.indexOf(":")===-1?!1:ys.has(s.slice(0,s.indexOf(":")))}function pt(s){return s.indexOf(":")===-1?!1:bi.has(s.slice(0,s.indexOf(":")))}class Ei{addCustomProvider(e,t){if(!t.pkgToUrl)throw new Error('Custom provider "'+e+'" must define a "pkgToUrl" method.');if(!t.parseUrlPkg)throw new Error('Custom provider "'+e+'" must define a "parseUrlPkg" method.');if(!t.resolveLatestTarget)throw new Error('Custom provider "'+e+'" must define a "resolveLatestTarget" method.');this.providers=Object.assign({},this.providers,{[e]:t})}providerNameForUrl(e){for(const t of Object.keys(this.providers)){const n=this.providers[t];if(n.ownsUrl&&n.ownsUrl.call(this,e)||n.parseUrlPkg.call(this,e))return t}}providerForUrl(e){const t=this.providerNameForUrl(e);return t?this.providers[t]:null}async parseUrlPkg(e){for(const t of Object.keys(this.providers)){const i=this.providers[t].parseUrlPkg.call(this,e);if(i)return{pkg:"pkg"in i?i.pkg:i,source:{provider:t,layer:"layer"in i?i.layer:"default"},subpath:"subpath"in i?i.subpath:null}}return null}async pkgToUrl(e,{provider:t,layer:n}){return Cs(t,this.providers).pkgToUrl.call(this,e,n)}resolveBuiltin(e){for(const t of Object.values(this.providers)){if(!t.resolveBuiltin)continue;const n=t.resolveBuiltin.call(this,e,this.env);if(n)return n}}async getPackageBase(e){const t=await this.parseUrlPkg(e);if(t)return this.pkgToUrl(t.pkg,t.source);let n;try{n=new URL("./",e)}catch{return e}const i=new URL("/",n).href;do{let r;if(r=await this.checkPjson(n.href))return new URL(".",r).href;if(n.href===i)return new URL("./",e).href}while(n=new URL("../",n))}async getPackageConfig(e){if(!e.startsWith("file:")&&!e.startsWith("http:")&&!e.startsWith("https:")&&!e.startsWith("ipfs:")&&!e.startsWith("node:"))return null;if(!e.endsWith("/"))throw new Error(`Internal Error: Package URL must end in "/". Got ${e}`);let t=this.pcfgs[e];return t||(this.pcfgPromises[e]||(this.pcfgPromises[e]=(async()=>{var n;const i=this.providerForUrl(e);if(i){var r;const f=await((r=i.getPackageConfig)===null||r===void 0?void 0:r.call(this,e));if(f!==void 0){this.pcfgs[e]=f;return}}const c=await ce(`${e}package.json`,this.fetchOpts);switch(c.status){case 200:case 304:break;case 400:case 401:case 403:case 404:case 406:case 500:this.pcfgs[e]=null;return;default:throw new C(`Invalid status code ${c.status} reading package config for ${e}. ${c.statusText}`)}if(c.headers&&!(!((n=c.headers.get("Content-Type"))===null||n===void 0)&&n.match(/^application\/json(;|$)/)))this.pcfgs[e]=null;else try{this.pcfgs[e]=await c.json()}catch{this.pcfgs[e]=null}})()),await this.pcfgPromises[e],this.pcfgs[e])}async getDepList(e,t=!1){const n=await this.getPackageConfig(e);return n?[...new Set([Object.keys(n.dependencies||{}),Object.keys(t&&n.devDependencies||{}),Object.keys(n.peerDependencies||{}),Object.keys(n.optionalDependencies||{}),Object.keys(n.imports||{})].flat())]:[]}async checkPjson(e){return await this.getPackageConfig(e)===null?!1:e}async exists(e){const t=await ce(e,this.fetchOpts);switch(t.status){case 200:case 304:return!0;case 400:case 401:case 403:case 404:case 406:case 500:return!1;default:throw new C(`Invalid status code ${t.status} loading ${e}. ${t.statusText}`)}}async resolveLatestTarget(e,{provider:t,layer:n},i){let r;for(const p of e.ranges.sort(e.ranges[0].constructor.compare))r?p.gt(r)&&!r.contains(p)&&(r=p):r=p;const c={registry:e.registry,name:e.name,range:r,unstable:e.unstable},h=await Cs(t,this.providers).resolveLatestTarget.bind(this)(c,n,i);if(h)return h;throw t==="nodemodules"?new C(`${i}node_modules/${e.name} does not exist, try installing "${e.name}" with npm first via "npm install ${e.name}".`):new C(`Unable to resolve package ${c.registry}:${c.name} in range "${c.range}" from parent ${i}.`)}async wasCommonJS(e){var t;const n=await this.getPackageBase(e);if(!n)return!1;const i=await this.getPackageConfig(n);if(!i)return!1;const r="./"+e.slice(n.length);return!!(!(i==null||(t=i.exports)===null||t===void 0)&&t[r+"!cjs"])}async realPath(e){if(!e.startsWith("file:")||this.preserveSymlinks)return e;let t=!1;e=e.replace(/%3a/i,()=>(t=!0,":")),Vt||([{realpath:Vt},{pathToFileURL:Ms}]=await Promise.all([Fe(()=>Promise.resolve().then(()=>fs),void 0),Fe(()=>Promise.resolve().then(()=>fs),void 0)]));const n=Ms(await new Promise((i,r)=>Vt(new URL(e),(c,f)=>c?r(c):i(f)))).href;return t?"file:"+n.slice(5).replace(":","%3a"):n}async finalizeResolve(e,t,n){if(t&&e.endsWith("/")&&(e=e.slice(0,-1)),t&&(e=await(async()=>{if(await this.exists(e+"/package.json")){const i=await this.getPackageConfig(e)||{};return this.env.includes("browser")&&typeof i.browser=="string"?this.finalizeResolve(await de.call(this,i.browser,new URL(e)),t,n):this.env.includes("module")&&typeof i.module=="string"?this.finalizeResolve(await de.call(this,i.module,new URL(e)),t,n):typeof i.main=="string"?this.finalizeResolve(await de.call(this,i.main,new URL(e)),t,n):this.finalizeResolve(await de.call(this,null,new URL(e)),t,n)}return await this.exists(e+"/index.js")?e+"/index.js":await this.exists(e+"/index.json")?e+"/index.json":await this.exists(e+"/index.node")?e+"/index.node":await this.exists(e)?e:await this.exists(e+".js")?e+".js":await this.exists(e+".json")?e+".json":await this.exists(e+".node")?e+".node":e})()),this.env.includes("browser")&&(n=n||await this.getPackageBase(e),e.startsWith(n))){const i=await this.getPackageConfig(n);if(i&&typeof i.browser=="object"&&i.browser!==null){const r="./"+e.slice(n.length);if(i.browser[r]){const c=i.browser[r];if(c===!1)throw new Error(`TODO: Empty browser map for ${r} in ${e}`);if(!c.startsWith("./"))throw new Error(`TODO: External browser map for ${r} to ${c} in ${e}`);return n+c.slice(2)===e?e:await this.finalizeResolve(n+c.slice(2),t,n)}}}return e}async getExportResolution(e,t,n){const i=await this.getPackageConfig(e)||{};if(n[0]==="#"){if(i.imports===void 0||i.imports===null)return null;const r=Ds(n,i.imports);if(!r)return null;const c=rt(i.imports[r]);for(const f of c)try{if(await this.finalizeResolve(f,!1,e)===e+t.slice(2))return"."}catch{}return null}if(i.exports!==void 0&&i.exports!==null)if(typeof i.exports=="string"){if(t!==".")return null;const r=new URL(i.exports,e).href;try{if(await this.finalizeResolve(r,!1,e)===e+t.slice(2))return"."}catch{}return null}else if(Ri(i.exports)){let r;for(const c of Object.keys(i.exports)){const f=rt(i.exports[c]);for(const h of f)if(h.indexOf("*")===-1){if(await this.finalizeResolve(new URL(h,e).href,!1,e)===e+t.slice(2)){if(r)if(n.endsWith(r.slice(2))){if(!n.endsWith(c.slice(2)))continue}else n.endsWith(c.slice(2))||c.length<r.length&&(r=c);r=c}}else{const p=h.split("*");if(!t.startsWith(p[0]))continue;const d=t.indexOf(p[1],p[0].length);if(d===-1)continue;const l=t.slice(p[0].length,d),b=h.replace(/\*/g,l);if(t===b){const I=c.slice(0,c.indexOf("*")),v=c.slice(c.indexOf("*")+1);if(r){if(n.endsWith(r.slice(2))){if(!n.endsWith(c.slice(2).replace("*",l))||r.startsWith(I)&&r.endsWith(v))continue}else if(!n.endsWith(c.slice(2).replace("*",l))&&r.startsWith(I)&&r.endsWith(v))continue}r=c.replace("*",l)}}}return r}else{if(t!==".")return null;const r=rt(i.exports);for(const c of r)try{if(await this.finalizeResolve(new URL(c,e).href,!1,e)===e+t.slice(2))return"."}catch{}return null}else{if(t!=="."){try{if(await this.finalizeResolve(new URL(t,new URL(e)).href,!1,e)===e+t.slice(2))return"."}catch{}return null}try{if(typeof i.main=="string"&&await this.finalizeResolve(await de.call(this,i.main,new URL(e),n,e),!1,e)===e+t.slice(2))return"."}catch{}try{if(await this.finalizeResolve(await de.call(this,null,new URL(e),n,e),!1,e)===e+t.slice(2))return"."}catch{}try{if(typeof i.browser=="string"&&await this.finalizeResolve(await de.call(this,i.browser,new URL(e),n,e),!1,e)===e+t.slice(2))return"."}catch{}try{return typeof i.module=="string"&&await this.finalizeResolve(await de.call(this,i.module,new URL(e),n,e),!1,e)===e+t.slice(2)?".":null}catch{}}return null}async resolveExport(e,t,n,i,r,c,f){const h=n?this.cjsEnv:this.env,p=await this.getPackageConfig(e)||{};if(typeof p.exports=="object"&&p.exports!==null&&Object.keys(p.exports).length===0){const l={registry:"npm",name:"@jspm/core",ranges:[new Te("*")],unstable:!0},b=c.getProvider(l),I=await this.resolveLatestTarget(l,b,f.href);return this.resolveExport(await this.pkgToUrl(I,b),"./nodelibs/@empty",n,i,r,c,f)}function d(){throw new C(`No '${t}' exports subpath defined in ${e} resolving ${r}${Ie(f)}.`,"MODULE_NOT_FOUND")}if(p.exports!==void 0&&p.exports!==null){let l=function(b){for(let I in b)if(I[0]!==".")return!1;return!0};if(typeof p.exports=="string"){if(t===".")return this.finalizeResolve(new URL(p.exports,e).href,i,e);d()}else if(l(p.exports)){const b=Ds(t,p.exports);if(b){let I="";const v=b.indexOf("*");v!==-1?I=t.slice(v,t.length-(b.length-v-1)):b.endsWith("/")&&(I=t.slice(b.length));const E=this.resolvePackageTarget(p.exports[b],e,n,I,!1);return E===null&&d(),this.finalizeResolve(E,i,e)}d()}else{if(t===".")return this.finalizeResolve(this.resolvePackageTarget(p.exports,e,n,"",!1),i,e);d()}}else return t==="."||i&&t==="./"?h.includes("browser")&&typeof p.browser=="string"?this.finalizeResolve(await de.call(this,p.browser,new URL(e),r,e),i,e):h.includes("module")&&typeof p.module=="string"?this.finalizeResolve(await de.call(this,p.module,new URL(e),r,e),i,e):typeof p.main=="string"?this.finalizeResolve(await de.call(this,p.main,new URL(e),r,e),i,e):this.finalizeResolve(await de.call(this,null,new URL(e),r,e),i,e):this.finalizeResolve(new URL(t,new URL(e)).href,i,e)}async analyze(e,t,n,i,r=!0){const c=await ce(e,this.fetchOpts);if(!c)throw new C(`Unable to fetch URL "${e}" for ${t}`);switch(c.status){case 200:case 304:break;case 404:throw new C(`Module not found: ${e}${Ie(t)}`,"MODULE_NOT_FOUND");default:throw new C(`Invalid status code ${c.status} loading ${e}. ${c.statusText}`)}try{var f=await c.text()}catch(d){if(r&&(d.code==="ERR_SOCKET_TIMEOUT"||d.code==="ETIMEOUT"||d.code==="ECONNRESET"))return this.analyze(e,t,n,i,!1);throw d}try{if(e.endsWith(".ts")||e.endsWith(".tsx")||e.endsWith(".jsx"))return await In(f,e);if(e.endsWith(".json"))try{return JSON.parse(f),{deps:[],dynamicDeps:[],cjsLazyDeps:null,size:f.length,format:"json"}}catch{}const[d,l]=hs(f);if(d.every(b=>b.d>0)&&!l.length&&e.startsWith("file:")){var h;if(i){var p;if(!(e.endsWith(".mjs")||e.endsWith(".js")&&((p=await this.getPackageConfig(await this.getPackageBase(e)))===null||p===void 0?void 0:p.type)==="module"))return Ps(d,f,e)}else if(e.endsWith(".cjs")||e.endsWith(".js")&&((h=await this.getPackageConfig(await this.getPackageBase(e)))===null||h===void 0?void 0:h.type)!=="module")return Ps(d,f,e)}return n?ln(f,d,e):an(d,f,e)}catch(d){if(!d.message||!d.message.startsWith("Parse error @:"))throw d;if(r)try{return this.analyze(e,t,n,i,!1)}catch{}if(d.message&&d.message.startsWith("Parse error @:")){const[l]=d.message.split(`
`,1),b=l.slice(14);let[I,v]=b.split(":");const E=f.split(`
`);let $="";throw I>1&&($+=`
  `+E[I-2]),$+=`
> `+E[I-1],$+=`
  `+" ".repeat(v-1)+"^",E.length>1&&($+=`
  `+E[I]),new C(`${$}

Error parsing ${e}:${b}`)}throw d}}resolvePackageTarget(e,t,n,i,r){if(typeof e=="string"){if(e===".")return t.slice(0,-1);if(!e.startsWith("./")){if(r)return e;throw new Error(`Invalid exports target ${e} resolving ./${i} in ${t}`)}if(!e.startsWith("./"))throw new Error("Invalid ");if(i==="")return new URL(e,t).href;if(e.indexOf("*")!==-1)return new URL(e.replace(/\*/g,i),t).href;if(e.endsWith("/"))return new URL(e+i,t).href;throw new Error(`Expected pattern or path export resolving ./${i} in ${t}`)}else if(typeof e=="object"&&e!==null&&!Array.isArray(e)){for(const c in e)if(c==="default"||(n?this.cjsEnv:this.env).includes(c)){const f=this.resolvePackageTarget(e[c],t,n,i,r);if(f)return f}}else if(Array.isArray(e))for(const c of e)return this.resolvePackageTarget(c,t,n,i,r);return null}constructor(e,t,n,i=!1){if(this.pcfgPromises=Object.create(null),this.pcfgs=Object.create(null),this.preserveSymlinks=!1,this.providers=gi,e.includes("require"))throw new Error("Cannot manually pass require condition");e.includes("import")||e.push("import"),this.env=e,this.cjsEnv=this.env.map(r=>r==="import"?"require":r),this.log=t,this.fetchOpts=n,this.preserveSymlinks=i}}function rt(s,e=new Set){if(typeof s=="string")e.add(s);else if(typeof s=="object"&&s!==null&&!Array.isArray(s)){for(const t in s)rt(s[t],e);return e}else if(Array.isArray(s))for(const t of s)return rt(t,e),e;return e}async function de(s,e,t,n){let i;if(s?.endsWith("index.js")){if(await this.exists(i=new URL(`./${s}`,e).href))return i}else if(s){if(await this.exists(i=new URL(`./${s}/index.js`,e).href)||await this.exists(i=new URL(`./${s}/index.json`,e).href)||await this.exists(i=new URL(`./${s}/index.node`,e).href)||await this.exists(i=new URL(`./${s}`,e).href)||await this.exists(i=new URL(`./${s}.js`,e).href)||await this.exists(i=new URL(`./${s}.json`,e).href)||await this.exists(i=new URL(`./${s}.node`,e).href))return i}else if(e.protocol!=="file:"&&await this.exists(i=new URL("./mod.ts",e).href)||await this.exists(i=new URL("./index.js",e).href)||await this.exists(i=new URL("./index.json",e).href)||await this.exists(i=new URL("./index.node",e).href))return i;throw new C(`Unable to resolve ${s?s+" in ":""}${e} resolving ${t??""}${Ie(n)}.`,"MODULE_NOT_FOUND")}function Ds(s,e){if(s in e)return s;let t;for(const n of Object.keys(e)){const i=n.indexOf("*");if(!(!n.endsWith("/")&&i===-1))if(n.endsWith("/"))s.startsWith(n)&&(!t||n.length>t.length)&&(t=n);else{const r=n.slice(0,i),c=n.slice(i+1);s.startsWith(r)&&s.endsWith(c)&&s.length>r.length+c.length&&(!t||!t.startsWith(r)||!t.endsWith(c))&&(t=n)}}return t}function Ri(s){for(let e in s)if(e[0]!==".")return!1;return!0}let Ht;async function Yt(s,e){Ht||({createHash:Ht}=await Fe(()=>Promise.resolve().then(()=>fs),void 0));const n=await(await ce(s,e)).text(),i=Ht("sha384");return i.update(n),"sha384-"+i.digest("base64")}function cn(s){return typeof window<"u"?window.btoa(s):Buffer.from(s).toString("base64")}function bs(s){return typeof window<"u"?window.atob(s):Buffer.from(s,"base64").toString("utf8")}const{Semver:Oi,SemverRange:st}=Be;function ki(s){const e=[];let t=s.lastIndexOf("/");const n=s.indexOf("://")+1;for(;(t=s.lastIndexOf("/",t-1))!==n;)e.push(s.slice(0,t+1));return e}function mt(s,e,t){if(t&&!t.endsWith("/")&&kt(t),!t)return s.primary[e];const n=s.secondary[t];var i;return(i=n?.[e])!==null&&i!==void 0?i:null}function Li(s,e,t,n){const i=ki(t);for(const r of i){if(!s.flattened[r])continue;const c=s.flattened[r][e];if(c){for(const f of c)if(f.export===n||f.export.endsWith("/")&&n.startsWith(f.export))return f.resolution}}return null}function Kt(s,e,t,n=null){n===null?s.primary[e]=t:(s.secondary[n]=s.secondary[n]||Object.create(null))[e]=t}function we(s,e,t,n=null,i=null){if(n&&!n.endsWith("/")&&kt(n),n===null){const r=s.primary[e];return r&&r.installUrl===t&&r.installSubpath===i?!1:(s.primary[e]={installUrl:t,installSubpath:i},!0)}else{s.secondary[n]=s.secondary[n]||{};const r=s.secondary[n][e];return r&&r.installUrl===t&&r.installSubpath===i?!1:(s.secondary[n][e]={installUrl:t,installSubpath:i},!0)}}function Ii(s,e){for(const t of Object.keys(e.primary))s.primary[t]=e.primary[t];for(const t of Object.keys(e.secondary))s[t]?Object.assign(s[t]=Object.create(null),e[t]):s.secondary[t]=e.secondary[t];for(const t of Object.keys(e.flattened))s[t]?Object.assign(s[t],e[t]):s.flattened[t]=e.flattened[t]}function Ti(s,e){for(const t of Object.keys(e.primary))s.primary[t]=e.primary[t];for(const t of Object.keys(e.secondary))s[t]?Object.assign(s[t]=Object.create(null),e[t]):s.secondary[t]=e.secondary[t]}function Us(s,e,t="npm",n=!1){const i=Object.create(null);if(s.dependencies)for(const r of Object.keys(s.dependencies))i[r]=Ee(s.dependencies[r],e,t,r).pkgTarget;if(s.peerDependencies)for(const r of Object.keys(s.peerDependencies))r in i||(i[r]=Ee(s.peerDependencies[r],e,t,r).pkgTarget);if(s.optionalDependencies)for(const r of Object.keys(s.optionalDependencies))r in i||(i[r]=Ee(s.optionalDependencies[r],e,t,r).pkgTarget);if(n&&s.devDependencies)for(const r of Object.keys(s.devDependencies))r in i||(i[r]=Ee(s.devDependencies[r],e,t,r).pkgTarget);return i}async function vs(s,e,t=!1){let n,i,r;if(s.registry==="node_modules"){const f=bs(s.version),h=await e.getPackageConfig(f);if(!h)throw new C(`Package ${f} has no package config, cannot create package target.`);if(!h.name||!h.version)throw new C(`Package ${f} has no name or version, cannot create package target.`);i=h.name,r=h.version,n="npm"}else({registry:n,name:i,version:r}=s);const c=new Oi(r);return c.tag?{registry:n,name:i,ranges:[new st(r)],unstable:!1}:t?c.major!==0?{registry:n,name:i,ranges:[new st(c.major)],unstable:!1}:c.minor!==0?{registry:n,name:i,ranges:[new st(c.major+"."+c.minor)],unstable:!1}:{registry:n,name:i,ranges:[new st(r)],unstable:!1}:{registry:n,name:i,ranges:[new st("^"+r)],unstable:!1}}function $i(s,e,t){const n=[];for(const[i,r]of Object.entries(t.primary))!(r instanceof URL)&&r.registry===e&&r.name===s&&n.push({alias:i,pkgScope:null,ranges:r.ranges});for(const[i,r]of Object.entries(t.secondary))for(const c of Object.keys(r)){const f=r[c];!(f instanceof URL)&&f.registry===e&&f.name===s&&n.push({alias:c,pkgScope:i,ranges:f.ranges})}return n}async function ji(s,e,t,n,i,r,c){const f={primary:Object.create(null),secondary:Object.create(null),flattened:Object.create(null)},h={imports:Object.create(null),scopes:Object.create(null)},p=await r.getPackageBase(t.href),d=await r.getPackageConfig(p),l={primary:d?Us(d,new URL(p),i,!0):Object.create(null),secondary:Object.create(null)},b=new Set;for(const v of Object.keys(s.imports||{})){if(Le(v)){const E=at(v);let{parsedTarget:$,pkgUrl:A,subpath:R}=await _s(s.imports[v],t,n,p,r);const x=$&&await r.getExportResolution(A,R,v);if(b.add(A),x){if(v[0]==="#")continue;l.primary[E.pkgName]||(l.primary[E.pkgName]=await vs($.pkg,r));let T=null;if(E.subpath!==x&&(E.subpath==="."?T=x:x==="."?T=!1:x.endsWith(E.subpath.slice(1))&&(T=x.slice(0,E.subpath.length))),T!==!1){we(f,E.pkgName,A,null,T);continue}}if(d&&d.name===E.pkgName){const T=await r.getExportResolution(p,R,v);if(E.subpath===T)continue}}h.imports[Le(v)?v:ge(v,t,n)]=ge(s.imports[v],t,n)}for(const v of Object.keys(s.scopes||{})){var I;const E=(I=ge(v,t,n))!==null&&I!==void 0?I:v,$=await r.getPackageBase(E),A=new URL($).pathname==="/";b.add($);const R=s.scopes[v];for(const x of Object.keys(R)){if(Le(x)){const T=at(x);let{parsedTarget:y,pkgUrl:k,subpath:Y}=await _s(R[x],t,n,$,r);b.add(k);const K=y&&await r.getExportResolution(k,Y,x);if(K){if(x[0]==="#")continue;l.primary[T.pkgName]||(l.primary[T.pkgName]=y?await vs(y.pkg,r):new URL(k));let ye=null;if(T.subpath!==K&&(T.subpath==="."?ye=K:K==="."?ye=!1:K.endsWith(T.subpath.slice(1))&&(ye=K.slice(0,T.subpath.length))),ye!==!1){if(A){const $e=f.flattened[$]=f.flattened[$]||{};$e[T.pkgName]=$e[T.pkgName]||[],$e[T.pkgName].push({export:T.subpath,resolution:{installUrl:k,installSubpath:ye}})}else we(f,T.pkgName,k,$,ye);continue}}}(h.scopes[E]=h.scopes[E]||Object.create(null))[Le(x)?x:ge(x,t,n)]=ge(R[x],t,n)}}return await Promise.all([...b].map(async v=>{if(!Rs(v))return;const E=await qi(v);E&&(l.secondary[v]=Us(E,new URL(v),i,!1))})),{maps:h,constraints:l,locks:await Pi(f,c,r,p)}}async function Pi(s,e,t,n){const i={primary:{},secondary:{},flattened:{}};for(const[r,c]of Object.entries(s.primary)){const{installUrl:f,installSubpath:h}=await Qt(c,e,t,n);we(i,r,f,null,h)}for(const[r,c]of Object.entries(s.secondary))for(const[f,h]of Object.entries(c)){const{installUrl:p,installSubpath:d}=await Qt(h,e,t,r);we(i,f,p,r,d)}for(const[r,c]of Object.entries(s.flattened)){i.flattened[r]={};for(const[f,h]of Object.entries(c)){i.flattened[r][f]=[];for(const p of h){const d=await Qt(p.resolution,e,t,r);i.flattened[r][f].push({export:p.export,resolution:d})}}}return i}async function Qt(s,e,t,n){const i=await t.parseUrlPkg(s.installUrl);if(!i)return s;const r=await t.getPackageBase(n),c=await Si(i,e,t,r);return c?{installUrl:await t.pkgToUrl(c.pkg,e),installSubpath:s.installSubpath}:s}async function Si(s,{provider:e,layer:t},n,i){const r=s.pkg;if((r.registry==="deno"||r.registry==="denoland")&&e==="deno")return s;if(r.registry==="deno"||r.registry==="denoland"||e==="deno")return null;if(r.registry==="node_modules"===(e==="nodemodules"))return{...s,source:{provider:e,layer:t}};const h=await vs(r,n);let p;try{p=await n.resolveLatestTarget(h,{provider:e,layer:t},i)}catch{return null}return{pkg:p,source:{provider:e,layer:t},subpath:s.subpath}}async function _s(s,e,t,n,i,r){let c=ge(s,e,t),f=await i.parseUrlPkg(c),h=f?await i.pkgToUrl(f.pkg,f.source):await i.getPackageBase(c);const p="."+c.slice(h.length-1);return{parsedTarget:f,pkgUrl:h,subpath:p}}var Ws,zs;class Ai{visitInstalls(e){if(!e(this.installs.primary,null)){for(const t of Object.keys(this.installs.secondary))if(e(this.installs.secondary[t],t))return}}startInstall(){if(this.installing)throw new Error("Internal error: already installing");this.installing=!0,this.newInstalls=!1,this.added=new Map}finishInstall(){this.installing=!1}getProvider(e){let t=this.defaultProvider;for(const n of Object.keys(this.providers))if(n.endsWith(":")&&e.registry===n.slice(0,-1)||e.name.startsWith(n)&&(e.name.length===n.length||e.name[n.length]==="/")){t=Fs(this.providers[n]);break}return t}async installTarget(e,{pkgTarget:t,installSubpath:n},i,r,c,f){const h=c===null,p=h&&r.includes("latest")||!h&&r==="latest-all";if(this.resolutions[e]){const v=Ee(this.resolutions[e],this.opts.baseUrl,this.defaultRegistry,e);if(v.installSubpath=n,JSON.stringify(t)!==JSON.stringify(v.pkgTarget))return this.installTarget(e,v,i,r,c,f)}if(t instanceof URL){const v=t.href,E=v+(v.endsWith("/")?"":"/");return this.log("installer/installTarget",`${e} ${c} -> ${v} (URL)`),this.newInstalls=we(this.installs,e,E,c,n),{installUrl:E,installSubpath:n}}const d=this.getProvider(t);if(r==="default"||r==="freeze"||!p){const v=await this.getBestExistingMatch(t);if(v){this.log("installer/installTarget",`${e} ${c} -> ${JSON.stringify(v)} (existing match)`);const E=await this.resolver.pkgToUrl(v,d);return this.newInstalls=we(this.installs,e,E,c,n),Kt(this.constraints,e,t,c),{installUrl:E,installSubpath:n}}}const l=await this.resolver.resolveLatestTarget(t,d,f),b=await this.resolver.pkgToUrl(l,d),I=$i(l.name,l.registry,this.constraints);if(r!=="freeze"&&!p&&!h&&l&&!this.tryUpgradeAllTo(l,b,I)){const v=await this.getBestExistingMatch(t);if(v){this.log("installer/installTarget",`${e} ${c} -> ${JSON.stringify(l)} (existing match not latest)`);const E=await this.resolver.pkgToUrl(v,d);return this.newInstalls=we(this.installs,e,E,c,n),Kt(this.constraints,e,t,c),{installUrl:E,installSubpath:n}}}return this.log("installer/installTarget",`${e} ${c} -> ${b} ${n||"<no-subpath>"} (latest)`),this.newInstalls=we(this.installs,e,b,c,n),Kt(this.constraints,e,t,c),r!=="freeze"&&this.upgradeSupportedTo(l,b,I),{installUrl:b,installSubpath:n}}async install(e,t,n=null,i,r=this.installBaseUrl){var c,f,h,p;this.log("installer/install",`installing ${e} from ${r} in scope ${n}`),this.installing||kt("Not installing");const d=!n||n==this.installBaseUrl;if(this.resolutions[e])return this.installTarget(e,Ee(this.resolutions[e],this.opts.baseUrl,this.defaultRegistry,e),i,t,d?null:n,r);const l=n||await this.resolver.getPackageBase(r),b=await this.resolver.getPackageConfig(l)||{},I=((c=b.dependencies)===null||c===void 0?void 0:c[e])||((f=b.peerDependencies)===null||f===void 0?void 0:f[e])||((h=b.optionalDependencies)===null||h===void 0?void 0:h[e])||d&&((p=b.devDependencies)===null||p===void 0?void 0:p[e]),v=I&&Ee(I,new URL(l),this.defaultRegistry,e),E=!!v&&(d&&t.includes("latest")||!d&&t==="latest-all"),$=mt(this.installs,e,d?null:n);if(!E&&$&&(d||t==="freeze"||await this.inRange($.installUrl,v.pkgTarget)))return this.log("installer/install",`existing lock for ${e} from ${r} in scope ${n} is ${JSON.stringify($)}`),$;if(!d){const y=Li(this.installs,e,n,i);if(!E&&y&&(t==="freeze"||await this.inRange(y.installUrl,v.pkgTarget)))return this.newInstalls=we(this.installs,e,y.installUrl,n,y.installSubpath),y}if(v)return this.installTarget(e,v,i,t,d?null:n,r);const A=e+(i?i.slice(1):""),R=this.resolver.resolveBuiltin(A);if(R)return typeof R=="string"?R:this.installTarget(A,R.target,i,t,d?null:n,r);if(this.installs.primary[e]){const{installUrl:y}=mt(this.installs,e,null);return{installUrl:y,installSubpath:null}}const x=Ee("*",new URL(l),this.defaultRegistry,e),{installUrl:T}=await this.installTarget(e,x,null,t,d?null:n,r);return{installUrl:T,installSubpath:null}}get pkgUrls(){const e=new Set;for(const t of Object.values(this.installs.primary))e.add(t.installUrl);for(const t of Object.keys(this.installs.secondary))for(const{installUrl:n}of Object.values(this.installs.secondary[t]))e.add(n);for(const t of Object.keys(this.installs.flattened))for(const{resolution:{installUrl:n}}of Object.values(this.installs.flattened[t]).flat())e.add(n);return e}async getBestExistingMatch(e){let t=null;for(const n of this.pkgUrls){const i=await this.resolver.parseUrlPkg(n);i&&await this.inRange(i.pkg,e)&&(t?t=ht.compare(new ht(t.version),i.pkg.version)===-1?i.pkg:t:t=i.pkg)}return t}async inRange(e,t){var n;if(!t||t instanceof URL)return!1;const i=typeof e=="string"?(n=await this.resolver.parseUrlPkg(e))===null||n===void 0?void 0:n.pkg:e;return i?i.registry===t.registry&&i.name===t.name&&t.ranges.some(r=>r.has(i.version,!0)):!1}tryUpgradeAllTo(e,t,n){const i=new ht(e.version);let r=!0;for(const{ranges:c}of n)c.every(f=>!f.has(i))&&(r=!1);if(!r)return!1;for(const{alias:c,pkgScope:f}of n){const h=mt(this.installs,c,f);if(!h)continue;const{installSubpath:p}=h;this.newInstalls=we(this.installs,c,t,f,p)}return!0}upgradeSupportedTo(e,t,n){const i=new ht(e.version);for(const{alias:r,pkgScope:c,ranges:f}of n){const h=mt(this.installs,r,c);if(!h||!f.some(d=>d.has(i,!0)))continue;const{installSubpath:p}=h;this.newInstalls=we(this.installs,r,t,c,p)}}constructor(e,t,n,i){this.installing=!1,this.newInstalls=!1,this.added=new Map,this.hasLock=!1,this.defaultProvider={provider:"jspm.io",layer:"default"},this.defaultRegistry="npm",this.log=n,this.resolver=i,this.resolutions=t.resolutions||{},this.installBaseUrl=e,this.opts=t,this.hasLock=!!t.lock,this.installs=t.lock||{primary:Object.create(null),secondary:Object.create(null),flattened:Object.create(null)},this.constraints={primary:Object.create(null),secondary:Object.create(null)},t.defaultRegistry&&(this.defaultRegistry=t.defaultRegistry),t.defaultProvider&&(this.defaultProvider=Fs(t.defaultProvider)),this.providers=Object.assign({},yi);var r;t.defaultProvider.includes("deno")&&((r=(Ws=this.providers)[zs="npm:"])!==null&&r!==void 0||(Ws[zs]="jspm.io")),t.providers&&Object.assign(this.providers,t.providers)}}function Fs(s){const e=s.split("#");return{provider:e[0],layer:e[1]||"default"}}function xi(s,e){return s===null||e==="."?s||e:`${s}${e.slice(1)}`}class Ni{async addInputMap(e,t=this.mapUrl,n=this.rootUrl,i){return this.processInputMap=this.processInputMap.then(async()=>{const r=new Ve({map:e,mapUrl:t,rootUrl:n}).rebase(this.mapUrl,this.rootUrl),c=Object.keys(r.imports||[]);for(const d of c)this.pins.includes(d)||this.pins.push(d);const{maps:f,locks:h,constraints:p}=await ji(r,i,t,n,this.installer.defaultRegistry,this.resolver,this.installer.defaultProvider);this.inputMap.extend(f),Ii(this.installer.installs,h),Ti(this.installer.constraints,p)})}async visit(e,t,n=this.baseUrl.href,i=new Set){var r;if(!n)throw new Error("Internal error: expected parentUrl");if(!((r=this.opts.ignore)===null||r===void 0)&&r.includes(e)||i.has(`${e}##${n}`))return;i.add(`${e}##${n}`),this.log("tracemap/visit",`Attempting to resolve ${e} to a module from ${n}, toplevel=${t.toplevel}, mode=${t.installMode}`);const c=await this.resolve(e,n,t.installMode,t.toplevel),f=await this.getTraceEntry(c,n);if(f?.format==="commonjs"&&f.usesCjs&&!this.opts.commonJS)throw new C(`Unable to trace ${c}, as it is a CommonJS module. Either enable CommonJS tracing explicitly by setting "GeneratorOptions.commonJS" to true, or use a provider that performs ESM transpiling like jspm.io via defaultProvider: 'jspm.io'.`);if(t.visitor&&await t.visitor(e,n,c,t.toplevel,f)||!f)return;let h=[...f.deps];if(f.dynamicDeps.length&&!t.static)for(const p of f.dynamicDeps)h.includes(p)||h.push(p);if(f.cjsLazyDeps&&!t.static)for(const p of f.cjsLazyDeps)h.includes(p)||h.push(p);t.toplevel&&(pt(e)||Le(e))&&(t={...t,toplevel:!1}),await Promise.all(h.map(async p=>{if(p.indexOf("*")!==-1){this.log("todo","Handle wildcard trace "+p+" in "+c);return}await this.visit(p,t,c,i)}))}async extractMap(e){const t=new Ve({mapUrl:this.mapUrl,rootUrl:this.rootUrl});t.extend(this.inputMap);do this.installer.newInstalls=!1,await Promise.all(e.map(async p=>{await this.visit(p,{installMode:"freeze",static:this.opts.static,toplevel:!0})}));while(this.installer.newInstalls);const n=new Set,i=new Set,r=[];let c=n;const f=async(p,d,l,b,I)=>{if(n.has(l)||c.add(l),I)for(const R of I.dynamicDeps)r.push([R,l]);if(b){if(Le(p)||pt(p)){var v,E;const R=t.imports[p];(!R||R!==l&&(!((v=this.tracedUrls)===null||v===void 0||(E=v[d])===null||E===void 0)&&E.wasCjs))&&t.set(p,l)}}else if(Le(p)||pt(p)){var $,A;const R=await this.resolver.getPackageBase(d),x=($=t.scopes[R])===null||$===void 0?void 0:$[p];x?x!==l&&((A=t.scopes[d])===null||A===void 0?void 0:A[p])!==l&&t.set(p,l,d):t.set(p,l,R)}},h=new Set;return await Promise.all(e.map(async p=>{await this.visit(p,{static:!0,visitor:f,installMode:"freeze",toplevel:!0},this.baseUrl.href,h)})),c=i,await Promise.all(r.map(async([p,d])=>{await this.visit(p,{visitor:f,installMode:"freeze",toplevel:!1},d,h)})),this.installer.newInstalls,{map:t,staticDeps:[...n],dynamicDeps:[...i]}}startInstall(){this.installer.startInstall()}async finishInstall(e=this.pins){const t=await this.extractMap(e);return this.installer.finishInstall(),t}async add(e,t,n){await this.installer.installTarget(e,t,null,n,null,this.mapUrl.href)}async resolve(e,t,n,i){var r,c;const f=(r=this.tracedUrls[t])===null||r===void 0?void 0:r.wasCjs,h=await this.resolver.getPackageBase(t);h||kt();const p=((c=this.tracedUrls[t])===null||c===void 0?void 0:c.format)==="commonjs";if((!Le(e)||e==="..")&&!pt(e)){let T=new URL(e,t);if(!Tn(T.protocol))throw new C(`Found unexpected protocol ${T.protocol}${Ie(t)}`);const y=T.href;let k=await this.resolver.realPath(await this.resolver.finalizeResolve(y,p,h));const Y=this.inputMap.resolve(k,t);return Y!==k&&!Y.startsWith("node:")&&!Y.startsWith("deno:")&&(k=Y),k!==y&&(this.inputMap.set(y.endsWith("/")?y.slice(0,-1):y,k),T=new URL(k)),this.log("tracemap/resolve",`${e} ${t} -> ${T} (URL resolution)`),T.href}const d=Ks(t,this.inputMap.scopes,this.inputMap.mapUrl),l=d.filter(([,T])=>T.startsWith(h));if(l.length)for(const[T]of l){const y=he(e,this.inputMap.scopes[T]);if(y){const k=await this.resolver.realPath(ge(this.inputMap.scopes[T][y]+e.slice(y.length),this.inputMap.mapUrl,this.inputMap.rootUrl));return this.log("tracemap/resolve",`${e} ${t} -> ${k} (subscope resolution)`),k}}const b=d.find(([,T])=>T===h);if(b){const T=this.inputMap.scopes[b[0]],y=he(e,T),k=y?await this.resolver.realPath(ge(T[y]+e.slice(y.length),this.inputMap.mapUrl,this.inputMap.rootUrl)):null;if(k)return this.log("tracemap/resolve",`${e} ${t} -> ${k} (scope resolution)`),k}const I=he(e,this.inputMap.imports),v=I?await this.resolver.realPath(ge(this.inputMap.imports[I]+e.slice(I.length),this.inputMap.mapUrl,this.inputMap.rootUrl)):null;if(v)return this.log("tracemap/resolve",`${e} ${t} -> ${v} (imports resolution)`),v;const E=at(e);if(!E)throw new C(`Invalid package name ${e}`);const{pkgName:$,subpath:A}=E,R=await this.resolver.getPackageConfig(h)||{};if(R.exports&&R.name===$){const T=await this.resolver.realPath(await this.resolver.resolveExport(h,A,f,p,e,this.installer,new URL(t)));return this.log("tracemap/resolve",`${e} ${t} -> ${T} (package own-name resolution)`),T}if(R.imports&&$[0]==="#"){const T=he(e,R.imports);if(!T)throw new C(`No '${e}' import defined in ${h}${Ie(t)}.`);const y=this.resolver.resolvePackageTarget(R.imports[T],h,f,e.slice(T.length),!0);if(!Rs(y))return this.resolve(y,t,n,i);const k=await this.resolver.realPath(y);return this.log("tracemap/resolve",`${e} ${t} -> ${k} (package imports resolution)`),k}const x=await this.installer.install($,n,i?null:h,A,t);if(typeof x=="string")return x;if(x){const{installUrl:T,installSubpath:y}=x,k=await this.resolver.realPath(await this.resolver.resolveExport(T,xi(y,A),f,p,e,this.installer,new URL(t)));return this.log("tracemap/resolve",`${e} ${t} -> ${k} (installation resolution)`),k}throw new C(`No resolution in map for ${e}${Ie(t)}`)}async getTraceEntry(e,t){if(e in this.tracedUrls){const i=this.tracedUrls[e];return await i.promise,i}if(vi(e))return null;if(e.endsWith("/"))throw new C(`Trailing "/" installs not supported installing ${e} for ${t}`);const n=this.tracedUrls[e]={promise:null,wasCjs:!1,usesCjs:!1,deps:null,dynamicDeps:null,cjsLazyDeps:null,hasStaticParent:!0,size:NaN,integrity:"",format:void 0};return n.promise=(async()=>{var i;const r=((i=this.tracedUrls[t])===null||i===void 0?void 0:i.format)==="commonjs",{deps:c,dynamicDeps:f,cjsLazyDeps:h,size:p,format:d,usesCjs:l}=await this.resolver.analyze(e,t,this.opts.system,r);n.format=d,n.size=p,n.deps=c.sort(),n.dynamicDeps=f.sort(),n.cjsLazyDeps=h&&h.sort(),(d==="commonjs"||await this.resolver.wasCommonJS(e))&&(n.wasCjs=!0),n.promise=null})(),await n.promise,n}constructor(e,t,n){this.tracedUrls={},this.pins=[],this.processInputMap=Promise.resolve(),this.log=t,this.resolver=n,this.mapUrl=e.mapUrl,this.baseUrl=e.baseUrl,this.rootUrl=e.rootUrl||null,this.opts=e,this.inputMap=new Ve({mapUrl:this.mapUrl,rootUrl:this.rootUrl}),this.installer=new Ai(this.mapUrl.pathname.endsWith("/")?this.mapUrl.href:`${this.mapUrl.href}/`,this.opts,this.log,this.resolver)}}function Ci(){let s,e=new Promise(r=>s=r),t=[];const n=async function*(){for(;;){for(;t.length;)yield t.shift();await e}};function i(r,c){if(t.length)t.push({type:r,message:c});else{t=[{type:r,message:c}];const f=s;e=new Promise(h=>s=h),f()}}return{log:i,logStream:n}}const Mi=/^\s+/;class Di{replace(e,t,n){const i=Zt(this.offsetTable,e),r=Zt(this.offsetTable,t);this.source=this.source.slice(0,e+i)+n+this.source.slice(t+r),Bs(this.offsetTable,t,n.length-(t+r-e-i))}remove(e,t,n=!1){if(this.replace(e,t,""),n){typeof n=="boolean"&&(n=Mi);const f=this.idx(t);var i;const[h]=(i=this.source.slice(f).match(n))!==null&&i!==void 0?i:[];var r;this.source=this.source.slice(0,f)+this.source.slice((r=f+h?.length)!==null&&r!==void 0?r:0);var c;Bs(this.offsetTable,t,(c=-h?.length)!==null&&c!==void 0?c:0)}}idx(e){return e+Zt(this.offsetTable,e)}constructor(e){this.offsetTable=[],this.source=e}}function Bs(s,e,t){let n=s.length,i=!1;for(;n-- >0;){const[r]=s[n];if(r<e||r===e&&(i=!0))break}i?s.splice(n,1,[e,t+s[n][1]]):s.splice(n+1,0,[e,t])}function Zt(s,e){let t=0;for(const[n,i]of s){if(n>e)break;t+=i}return t}var es,ts,ss;const Ot=((es=globalThis.process)===null||es===void 0?void 0:es.platform)==="win32";Ot&&Object.keys((ts=globalThis.process)===null||ts===void 0?void 0:ts.env).find(s=>!!s.match(/^PATH$/i));(ss=globalThis.process)===null||ss===void 0||ss.platform;const fn={tab:"  ",newline:Ot?`\r
`:`
`,trailingNewline:Ot?`\r
`:`
`,indent:"",quote:'"'};function Ui(s){let e=s.match(/\r?\n|\r(?!\n)/);return e?e[0]:Ot?`\r
`:`
`}function _i(s,e){let t,n=s.split(e);for(const d of n){const l=d.match(/^\s*[^\s]/);l&&(t===void 0||l.length<t.length)&&(t=l[0].slice(0,-1))}t=t||"",n=n.map(d=>d.slice(t.length));let i=n.map(d=>{var l;return((l=d.match(/^[ \t]*/))===null||l===void 0?void 0:l[0])||""})||[],r=new Map,c=0;i.forEach(d=>{let l=Math.abs(d.length-c);l!==0&&r.set(l,(r.get(l)||0)+1),c=d.length});let f=0;for(const d of r.keys())(!f||r.get(d)>=r.get(f))&&(f=d);let h=new Map;i.forEach(d=>{let l=d.substr(d.length-f);h.set(l,(h.get(l)||0)+1)});let p="";for(const[d,l]of h)(!p||l>h.get(p))&&(p=d);return n.length<5&&n.reduce((d,l)=>d+l.length,0)<100&&(p="  "),{indent:t||"",tab:p}}function Wi(s){let e=Object.assign({},fn);e.newline=Ui(s);let{indent:t,tab:n}=_i(s,e.newline);e.indent=t,e.tab=n;let i=s.match(/"|'/);return i&&(e.quote=i[0]),e.trailingNewline=s&&s.match(new RegExp(e.newline+"$"))?e.newline:"",e}function zi(s,e){s.startsWith("\uFEFF")&&(s=s.substr(1));let t=Wi(s);try{return{json:JSON.parse(s),style:t}}catch{throw new C(`Error parsing JSON file${e?" "+e:""}`)}}let W,j;const Fi=["link","base"];function Gs(s,e=["script","link","base","!--"]){const t=[];W=s,j=0;let n={tagName:void 0,start:-1,end:-1,attributes:[],innerStart:-1,innerEnd:-1};for(;j<W.length;){for(var i;W.charCodeAt(j++)!==60;)if(j===W.length)return t;const r=j-1,c=(i=Js())===null||i===void 0?void 0:i.toLowerCase();if(c==="!--"){for(;W.charCodeAt(j)!==45||W.charCodeAt(j+1)!==45||W.charCodeAt(j+2)!==62;)if(++j===W.length)return t;t.push({tagName:"!--",start:r,end:j+3,attributes:[],innerStart:r+3,innerEnd:j}),j+=3}else{if(c===void 0)return t;if(e.includes(c)){n.tagName=c,n.start=j-c.length-2;const f=n.attributes;let h;for(;h=ns();)f.push(h);let p=Fi.includes(c);if(W.charCodeAt(j-2)===47&&W.charCodeAt(j-1)===62&&(p=!0),p)n.end=j;else for(n.innerStart=j;;){for(;W.charCodeAt(j++)!==60;)if(j===W.length)return t;const d=Js();if(d===void 0)return t;if(d===`/${n.tagName}`){for(n.innerEnd=j-8;ns(););n.end=j;break}}t.push(n),n={tagName:void 0,start:-1,end:-1,attributes:[],innerStart:-1,innerEnd:-1}}else for(;ns(););}}return t}function Js(){let s=j,e;for(;!ke(e=W.charCodeAt(j++))&&e!==62;)if(j===W.length)return null;return W.slice(s,e===62?--j:j-1)}function ns(){let s;for(;ke(s=W.charCodeAt(j));)if(++j===W.length)return null;if(s===62||s===47&&(s=W.charCodeAt(++j))===62)return j++,null;const e=j;for(;!ke(s=W.charCodeAt(j++))&&s!==61;){if(j===W.length)return null;if(s===62)return e+2===j&&W.charCodeAt(e)===47?null:{nameStart:e,nameEnd:--j,valueStart:-1,valueEnd:-1}}const t=j-1;if(s!==61){for(;ke(s=W.charCodeAt(j))&&s!==61;)if(++j===W.length||s===62)return null;if(s!==61)return{nameStart:e,nameEnd:t,valueStart:-1,valueEnd:-1}}for(;ke(s=W.charCodeAt(j++));)if(j===W.length||s===62)return null;if(s===34){const n=j;for(;W.charCodeAt(j++)!==34;)if(j===W.length)return null;return{nameStart:e,nameEnd:t,valueStart:n,valueEnd:j-1}}else if(s===39){const n=j;for(;W.charCodeAt(j++)!==39;)if(j===W.length)return null;return{nameStart:e,nameEnd:t,valueStart:n,valueEnd:j-1}}else{const n=j-1;for(j++;!ke(s=W.charCodeAt(j))&&s!==62;)if(++j===W.length)return null;return{nameStart:e,nameEnd:t,valueStart:n,valueEnd:j}}}function ke(s){return s===32||s<14&&s>8}function nt(s,e,t){for(const n of e.attributes)if(s.slice(n.nameStart,n.nameEnd)===t)return s.slice(n.valueStart,n.valueEnd);return null}const qs=/(^|\/)(es-module-shims|esms)(\.min)?\.js$/;function Xe(s,e){return Object.fromEntries(e.map(t=>Bi(s,t)).map(t=>[t.name,t]))}function is(s,e=pe){const t={base:e,newlineTab:`
`,map:{json:null,style:null,start:-1,end:-1,newScript:!1,attrs:null},staticImports:new Set,dynamicImports:new Set,preloads:[],modules:[],esModuleShims:null,comments:[]},n=Gs(s,["!--","base","script","link"]);let i=!1;for(const c of n)switch(c.tagName){case"!--":t.comments.push({start:c.start,end:c.end,attrs:{}});break;case"base":const f=nt(s,c,"href");f&&(t.base=new URL(f,e));break;case"script":const h=nt(s,c,"type");if(h==="importmap"){const p=s.slice(c.innerStart,c.innerEnd),d=p.trim().length===0,{json:l,style:b}=d?{json:{},style:fn}:zi(p,e.href+"#importmap"),{start:I,end:v}=c,E=Xe(s,c.attributes);let $=c.start;for(;ke(s.charCodeAt(--$)););t.newlineTab=Es(s,$+1),t.map={json:l,style:b,start:I,end:v,attrs:E,newScript:!1},i=!0}else if(h==="module"){const p=nt(s,c,"src");if(p)qs.test(p)?t.esModuleShims={start:c.start,end:c.end,attrs:Xe(s,c.attributes)}:(t.staticImports.add(Le(p)?"./"+p:p),t.modules.push({start:c.start,end:c.end,attrs:Xe(s,c.attributes)}));else{const[d]=hs(s.slice(c.innerStart,c.innerEnd))||[];for(const{n:l,d:b}of d)l&&(b===-1?t.staticImports:t.dynamicImports).add(l)}}else if(!h||h==="javascript"){const p=nt(s,c,"src");if(p)qs.test(p)&&(t.esModuleShims={start:c.start,end:c.end,attrs:Xe(s,c.attributes)});else{const[d]=hs(s.slice(c.innerStart,c.innerEnd))||[];for(const{n:l,d:b}of d)l&&(b===-1?t.staticImports:t.dynamicImports).add(l)}}i||(wt(s,c.start,t.map,c,t),i=!0);break;case"link":if(nt(s,c,"rel")==="modulepreload"){const{start:p,end:d}=c,l=Xe(s,c.attributes);t.preloads.push({start:p,end:d,attrs:l})}i||(wt(s,c.start,t.map,c,t),i=!0)}if(!i){var r;const c=(r=Gs(s,["head"]))===null||r===void 0?void 0:r[0];if(c){let f=c.innerStart;for(;s[f]!=="<";)f++;wt(s,f,t.map,c,t),i=!0}}return i||wt(s,s.length,t.map,{tagName:"html",start:s.length,end:s.length,attributes:[],innerStart:s.length,innerEnd:s.length},t),t}function wt(s,e,t,n,i){let r=e;for(;ke(s.charCodeAt(--r)););if(i.newlineTab=Es(s,r+1),i.newlineTab.indexOf(`
`)===-1){for(r=n.start;ke(s.charCodeAt(--r)););i.newlineTab=Es(s,r+1)}t.newScript=!0,t.attrs=Xe(s,n.attributes),t.start=t.end=e}function Bi(s,{nameStart:e,nameEnd:t,valueStart:n,valueEnd:i}){return{start:e,end:i!==-1?i:t,quote:n!==-1&&(s[n-1]==='"'||s[n-1]==="'")?s[n-1]:"",name:s.slice(e,t),value:n===-1?null:s.slice(n,i)}}function Es(s,e){if(s===""||e===-1)return"";const t=e;for(s[e]==="\r"&&s[e+1]===`
`&&e++,s[e]===`
`&&e++;s[e]===" "||s[e]==="	";)e++;return s.slice(t,e)||""}function Gi(s,e){return{ownsUrl:t,pkgToUrl:n,parseUrlPkg:i,resolveLatestTarget:r,getPackageConfig:c};function t(f){return e&&f===s||f.includes("/node_modules/")}async function n(f){if(f.registry==="node_modules")return`${bs(f.version)}`;const h=await Xs.call(this,f.name,s);if(!h)throw new C(`Failed to resolve ${f.name} against node_modules from ${s}`);return`${bs(h.version)}`}function i(f){const h=f.lastIndexOf("/node_modules/");if(h===-1)return null;const p=f.slice(h+14).split("/"),d=p[0][0]==="@"?`${p[0]}/${p[1]}`:p[0],l=`${f.slice(0,h+14)}${d}/`,b=`./${f.slice(l.length)}`;if(d&&l)return{pkg:{name:d,registry:"node_modules",version:cn(l)},subpath:b==="./"?null:b,layer:"default"}}async function r(f,h,p){return Xs.call(this,f.name,p)}async function c(f){if(!t.call(this,f))return null;const h=new URL("package.json",f),p=await ce(h.href,this.fetchOpts);switch(p.status){case 200:case 304:break;default:return null}async function d(b){if(b)for(const[I,v]of Object.entries(b)){if(!Ji(v))continue;const E=new URL(`./node_modules/${I}`,f);await hn.call(this,E)&&(b[I]=E.href)}}const l=await p.json();return await d.call(this,l.dependencies),await d.call(this,l.peerDependencies),await d.call(this,l.optionalDependencies),await d.call(this,l.devDependencies),l}}async function Xs(s,e){let t=new URL(`node_modules/${s}`,e);const n=new URL(`/node_modules/${s}`,e).href,i=s[0]==="@";for(;!await hn.call(this,t);){if(t.href===n)return null;t=new URL(`../../${i?"../":""}node_modules/${s}`,t)}return{name:s,registry:"node_modules",version:cn(`${t.href}/`)}}async function hn(s,e){const t=await ce(s,this.fetchOpts);switch(t.status){case 304:case 200:return!0;case 404:return!1;default:throw new C(`Invalid status code ${t.status} looking up "${s}" - ${t.statusText}${Ie(e)}`)}}function Ji(s){return s.startsWith("file:")}class Os{async addMappings(e,t=this.mapUrl,n=this.rootUrl,i){typeof t=="string"&&(t=new URL(t,this.baseUrl)),typeof n=="string"&&(n=new URL(n,this.baseUrl));let r;if(typeof e=="string")try{e=JSON.parse(e)}catch{const c=is(e,t);e=c.map.json||{},i=(i||[]).concat(c.preloads.map(f=>{var h;return(h=f.attrs.href)===null||h===void 0?void 0:h.value}).filter(f=>f)),r=[...new Set([...c.staticImports,...c.dynamicImports])]}return await this.traceMap.addInputMap(e,t,n,i),r||[...this.traceMap.pins]}getLock(){return JSON.parse(JSON.stringify(this.traceMap.installer.installs))}async pin(e,t){return this.link(e,t)}async traceInstall(e,t){return this.link(e,t)}async link(e,t){typeof e=="string"&&(e=[e]);let n=!1;this.installCnt++===0&&this.traceMap.startInstall(),e=e.map(i=>i.replace(/\\/g,"/")),await this.traceMap.processInputMap;try{await Promise.all(e.map(i=>this.traceMap.visit(i,{installMode:"freeze",toplevel:!0},t||this.baseUrl.href)));for(const i of e)this.traceMap.pins.includes(i)||this.traceMap.pins.push(i)}catch(i){throw n=!0,i}finally{if(--this.installCnt===0){const{map:i,staticDeps:r,dynamicDeps:c}=await this.traceMap.finishInstall();if(this.map=i,!n)return{staticDeps:r,dynamicDeps:c}}}}async linkHtml(e,t){if(Array.isArray(e)){const c=await Promise.all(e.map(f=>this.linkHtml(f,t)));return[...new Set(c)].reduce((f,h)=>f.concat(h),[])}let n;t&&(typeof t=="string"?n=new URL(ge(t,this.mapUrl,this.rootUrl)):n=t);const i=is(e,n),r=[...new Set([...i.staticImports,...i.dynamicImports])];return await Promise.all(r.map(c=>this.link(c,n?.href))),r}async htmlGenerate(e,{mapUrl:t,rootUrl:n,htmlUrl:i,preload:r=!1,integrity:c=!1,whitespace:f=!0,esModuleShims:h=!0,comment:p=!0}={}){typeof t=="string"&&(t=new URL(t));const d=await this.addMappings(e,t,n);return await this.htmlInject(e,{pins:d,htmlUrl:i||t,rootUrl:n,preload:r,integrity:c,whitespace:f,esModuleShims:h,comment:p})}async htmlInject(e,{trace:t=!1,pins:n=!t,htmlUrl:i,rootUrl:r,preload:c=!1,integrity:f=!1,whitespace:h=!0,esModuleShims:p=!0,comment:d=!0}={}){if(d===!0&&(d=" Generated by @jspm/generator - https://github.com/jspm/generator "),typeof i=="string"&&(i=new URL(i)),f&&(c=!0),this.installCnt!==0)throw new C("htmlGenerate cannot run alongside other install ops");const l=is(e,i);let b=n===!0?this.traceMap.pins:Array.isArray(n)?n:[];if(t){const y=await this.linkHtml(e,i);b=[...new Set([...b,...y])]}try{var{map:I,staticDeps:v,dynamicDeps:E}=await this.extractMap(b,i,r)}catch(y){throw new C(`${y.message}

If you are linking locally against your node_modules folder, make sure that you have all the necessary dependencies installed.`)}const $=c===!0&&f||c==="all"?[...new Set([...v,...E])]:v,A=h?l.newlineTab.includes(`
`)?l.newlineTab:`
`+l.newlineTab:l.newlineTab,R=new Di(e);let x="";if(p){let y;try{y=await this.traceMap.resolver.resolveLatestTarget({name:"es-module-shims",registry:"npm",ranges:[new Te("*")],unstable:!1},this.traceMap.installer.defaultProvider,this.baseUrl.href)}catch{let K=`Unable to resolve "es-module-shims@*" under current provider "${this.traceMap.installer.defaultProvider.provider}".`;throw this.traceMap.installer.defaultProvider.provider==="nodemodules"&&(K+=`

Jspm automatically injects a shim so that the import map in your HTML file will be usable by older browsers.
You may need to run "npm install es-module-shims" to install the shim if you want to link against your local node_modules folder.`),K+=`
To disable the import maps polyfill injection, set esModuleShims: false.`,new C(K)}let k=await this.traceMap.resolver.pkgToUrl(y,this.traceMap.installer.defaultProvider)+"dist/es-module-shims.js";(i||r)&&(k=Jt(new URL(k),new URL(r??i),!!r)),x=`<script async src="${k}" crossorigin="anonymous"${f?` integrity="${await Yt(k,this.traceMap.resolver.fetchOpts)}"`:""}><\/script>${A}`,l.esModuleShims&&R.remove(l.esModuleShims.start,l.esModuleShims.end,!0)}for(const y of l.preloads)R.remove(y.start,y.end,!0);let T="";if(c&&$.length){let y=!0;for(let k of $.sort())(y||h)&&(T+=A),y&&(y=!1),f?T+=`<link rel="modulepreload" href="${r||i?Jt(new URL(k),new URL(r||i),!!r):k}" integrity="${await Yt(k,this.traceMap.resolver.fetchOpts)}" />`:T+=`<link rel="modulepreload" href="${r||i?Jt(new URL(k),new URL(r||i),!!r):k}" />`}if(f)for(const y of l.modules){if(!y.attrs.src)continue;y.attrs.integrity&&R.remove(y.attrs.integrity.start-(R.source[R.idx(y.attrs.integrity.start-1)]===" "?1:0),y.attrs.integrity.end+1);const k=Object.keys(y.attrs).filter(Y=>Y!=="integrity").sort((Y,K)=>y.attrs[Y].end>y.attrs[K].end?-1:1)[0];R.replace(y.attrs[k].end+1,y.attrs[k].end+1,` integrity="${await Yt(ge(y.attrs.src.value,this.mapUrl,this.rootUrl),this.traceMap.resolver.fetchOpts)}"`)}if(d){const y=l.comments.find(k=>R.source.slice(R.idx(k.start),R.idx(k.end)).includes(d));y&&R.remove(y.start,y.end,!0)}return R.replace(l.map.start,l.map.end,(d?"<!--"+d+"-->"+A:"")+x+'<script type="importmap">'+(h?A:"")+JSON.stringify(I,null,h?2:0).replace(/\n/g,A)+(h?A:"")+"<\/script>"+T+(l.map.newScript?A:"")),R.source}async install(e){return this._install(e)}async _install(e,t){if(this.latest&&(t??(t="latest-primaries")),this.freeze&&(t??(t="freeze")),e==null)return await this.traceMap.processInputMap,t??(t="default"),this._install(Object.entries(this.traceMap.installer.installs.primary).map(([i,r])=>{const c=this.traceMap.installer.constraints.primary[i];let f=r.installUrl;c&&(c instanceof URL?f=c.href:f=`${c.registry}:${c.name}`);var h;return{alias:i,target:f,subpath:(h=r.installSubpath)!==null&&h!==void 0?h:void 0}}),t);if(Array.isArray(e)){if(e.length===0){const{map:i,staticDeps:r,dynamicDeps:c}=await this.traceMap.finishInstall();return this.map=i,{staticDeps:r,dynamicDeps:c}}return await Promise.all(e.map(i=>this._install(i,t))).then(i=>i.find(r=>r))}if(typeof e!="string"&&e.subpaths!==void 0)return e.subpaths.every(i=>{if(typeof i!="string"||i!=="."&&!i.startsWith("./"))throw new Error(`Install subpath "${i}" must be equal to "." or start with "./".`)}),await Promise.all(e.subpaths.map(i=>this._install({target:e.target,alias:e.alias,subpath:i},t))).then(i=>i.find(r=>r));let n=!1;this.installCnt++===0&&this.traceMap.startInstall(),await this.traceMap.processInputMap;try{let i,r,c;typeof e=="string"||typeof e.target=="string"?{alias:i,target:r,subpath:c}=await Xi.call(this,e,this.traceMap.installer.defaultRegistry):({alias:i,target:r,subpath:c}=e,Un(i)),this.log("generator/install",`Adding primary constraint for ${i}: ${JSON.stringify(r)}`),t??(t="latest-primaries"),await this.traceMap.add(i,r,t),await this.traceMap.visit(i+c.slice(1),{installMode:t,toplevel:!0},this.mapUrl.href),this.traceMap.pins.includes(i+c.slice(1))||this.traceMap.pins.push(i+c.slice(1))}catch(i){throw n=!0,i}finally{if(--this.installCnt===0){const{map:i,staticDeps:r,dynamicDeps:c}=await this.traceMap.finishInstall();if(this.map=i,!n)return{staticDeps:r,dynamicDeps:c}}}}async reinstall(){if(this.installCnt++===0&&this.traceMap.startInstall(),await this.traceMap.processInputMap,--this.installCnt===0){const{map:e,staticDeps:t,dynamicDeps:n}=await this.traceMap.finishInstall();return this.map=e,{staticDeps:t,dynamicDeps:n}}}async update(e){typeof e=="string"&&(e=[e]),this.installCnt++===0&&this.traceMap.startInstall(),await this.traceMap.processInputMap;const t=this.traceMap.installer.installs.primary,n=this.traceMap.installer.constraints.primary;let i="latest-primaries";e||(e=Object.keys(t),i="latest-all");const r=[];for(const c of e){const f=t[c];if(!f)throw this.installCnt--,new C(`No "imports" package entry for "${c}" to update. Note update takes package names not package specifiers.`);const{installUrl:h,installSubpath:p}=f,d=this.traceMap.pins.filter(l=>l===c||l.startsWith(c)&&l[c.length]==="/").map(l=>`.${l.slice(c.length)}`);if(n[c])r.push({alias:c,subpaths:d,target:{pkgTarget:n[c],installSubpath:p}});else{const l=await this.traceMap.resolver.parseUrlPkg(h);if(!l)throw new Error(`Unable to determine a package version lookup for ${c}. Make sure it is supported as a provider package.`);const b={pkgTarget:{registry:l.pkg.registry,name:l.pkg.name,ranges:[new Te("^"+l.pkg.version)],unstable:!1},installSubpath:p};r.push({alias:c,subpaths:d,target:b})}}if(await this._install(r,i),--this.installCnt===0){const{map:c,staticDeps:f,dynamicDeps:h}=await this.traceMap.finishInstall();return this.map=c,{staticDeps:f,dynamicDeps:h}}}async uninstall(e){typeof e=="string"&&(e=[e]),this.installCnt++===0&&this.traceMap.startInstall(),await this.traceMap.processInputMap;let t=this.traceMap.pins;const n=new Set([...e]);for(let i=0;i<t.length;i++){const r=t[i],c=e.filter(f=>f===r||f.endsWith("/")&&r.startsWith(f));if(c.length){t.splice(i--,1);for(const f of c)n.delete(f)}}if(n.size)throw this.installCnt--,new C(`No "imports" entry for "${[...n][0]}" to uninstall.`);if(this.traceMap.pins=t,--this.installCnt===0){const{map:i}=await this.traceMap.finishInstall();this.map=i}}async extractMap(e,t,n){if(typeof t=="string"&&(t=new URL(t,this.baseUrl)),typeof n=="string"&&(n=new URL(n,this.baseUrl)),Array.isArray(e)||(e=[e]),this.installCnt++!==0)throw new C("Cannot run extract map during installs");if(this.traceMap.startInstall(),await this.traceMap.processInputMap,--this.installCnt!==0)throw new C("Another install was started during extract map.");const{map:i,staticDeps:r,dynamicDeps:c}=await this.traceMap.finishInstall(e);return i.rebase(t,n),i.flatten(),i.sort(),i.combineSubpaths(),{map:i.toJSON(),staticDeps:r,dynamicDeps:c}}resolve(e,t=this.baseUrl){typeof t=="string"&&(t=new URL(t,this.baseUrl));const n=this.map.resolve(e,t);if(n===null)throw new C(`Unable to resolve "${e}" from ${t.href}`,"MODULE_NOT_FOUND");return n}get importMap(){return this.map}getAnalysis(e){typeof e!="string"&&(e=e.href);const t=this.traceMap.tracedUrls[e];if(!t)throw new Error(`The URL ${e} has not been traced by this generator instance.`);return{format:t.format,staticDeps:t.deps,dynamicDeps:t.dynamicDeps,cjsLazyDeps:t.cjsLazyDeps||[]}}getMap(e,t){const n=this.map.clone();return n.rebase(e,t),n.flatten(),n.sort(),n.combineSubpaths(),n.toJSON()}constructor({baseUrl:e,mapUrl:t,rootUrl:n=void 0,inputMap:i=void 0,env:r=["browser","development","module","import"],defaultProvider:c,defaultRegistry:f="npm",customProviders:h=void 0,providers:p,resolutions:d={},cache:l=!0,ignore:b=[],freeze:I,latest:v,ipfsAPI:E,commonJS:$=!1}={}){this.installCnt=0;const{log:A,logStream:R}=Ci();this.log=A,this.logStream=R,Qs?.env?.JSPM_GENERATOR_LOG&&(async()=>{for await(const{type:k,message:Y}of this.logStream())console.log(`\x1B[1m${k}:\x1B[0m ${Y}`)})();let x;if(l==="offline"?x={cache:"force-cache",headers:{"Accept-Encoding":"gzip, br"}}:l?x={headers:{"Accept-Encoding":"gzip, br"}}:x={cache:"no-store",headers:{"Accept-Encoding":"gzip, br"}},E&&(x.ipfsAPI=E),t&&!e){t=typeof t=="string"?new URL(t,pe):t;try{e=new URL("./",t)}catch{e=new URL(t+"/")}}else e&&!t?t=e:!t&&!e&&(e=t=pe);if(this.baseUrl=typeof e=="string"?new URL(e,pe):e,this.baseUrl.pathname.endsWith("/")||(this.baseUrl=new URL(this.baseUrl.href),this.baseUrl.pathname+="/"),this.mapUrl=typeof t=="string"?new URL(t,this.baseUrl):t,this.rootUrl=typeof n=="string"?new URL(n,this.baseUrl):n||null,this.rootUrl&&!this.rootUrl.pathname.endsWith("/")&&(this.rootUrl.pathname+="/"),!this.mapUrl.pathname.endsWith("/"))try{this.mapUrl=new URL("./",this.mapUrl)}catch{this.mapUrl=new URL(this.mapUrl.href+"/")}const T=new Ei(r,A,x,!0);if(h)for(const k of Object.keys(h))T.addCustomProvider(k,h[k]);const y=Gi(this.baseUrl.href,c==="nodemodules");T.addCustomProvider("nodemodules",y),c=Vi(c,i,T),this.traceMap=new Ni({mapUrl:this.mapUrl,rootUrl:this.rootUrl,baseUrl:this.baseUrl,defaultProvider:c,defaultRegistry:f,providers:p,ignore:b,resolutions:d,commonJS:$},A,T),this.map=new Ve({mapUrl:this.mapUrl,rootUrl:this.rootUrl}),i&&this.addMappings(i),this.latest=v,this.freeze=I}}async function qi(s,{provider:e,cache:t}={}){const n=new Os({cache:!t,defaultProvider:e});return typeof s=="object"&&"name"in s?s=await n.traceMap.resolver.pkgToUrl(s,n.traceMap.installer.defaultProvider):typeof s=="string"?s=new URL(s).href:s=s.href,n.traceMap.resolver.getPackageConfig(s)}async function Xi(s,e){if(typeof s=="string"&&(s={target:s}),typeof s.target!="string")throw new Error('All installs require a "target" string.');if(s.subpath!==void 0&&(typeof s.subpath!="string"||s.subpath!=="."&&!s.subpath.startsWith("./")))throw new Error(`Install subpath "${s.subpath}" must be a string equal to "." or starting with "./".${typeof s.subpath=="string"?`
Try setting the subpath to "./${s.subpath}"`:""}`);const{alias:t,target:n,subpath:i}=await Mn(this.traceMap.resolver,s.target,this.baseUrl,e);return{target:n,alias:s.alias||t,subpath:s.subpath||i}}function Vi(s,e,t){const n={};for(const c of Object.values(e?.imports||{})){const f=t.providerNameForUrl(c);f&&(n[f]=(n[f]||0)+1)}let i,r=0;for(const[c,f]of Object.entries(n))f>r&&(i=c,r=f);return s||i||"jspm.io"}class Hi{automergeRepo;myRegistryDocHandle;constructor(e,t){this.automergeRepo=e,this.myRegistryDocHandle=t,window.myRegistryDocHandle=t}async update(e,t){const n=new Os({resolutions:{[e]:`/automerge-repo/${t}`,"@automerge/automerge-wasm":"./src/web"}});console.log("before packages",n.getMap()),console.log("Linking"),await n.link(e),console.log("prepared packages",n.getMap()),await this.cacheImportMap(n.getMap(),n.traceMap.resolver)}async cacheImportMap(e,t){console.log("updating package registry");const n=async i=>{const r=await t.getPackageBase(i),c=await t.getPackageConfig(r);r&&c?await this.cachePackage(r,c):console.warn("could not cache package",r,c)};if(await Promise.all(Object.values(e.imports).map(n)),e.scopes){const i=Object.values(e.scopes).map(async r=>{await Promise.all(Object.values(r).map(n))});await Promise.all(i)}console.log("updated package registry",this.myRegistryDocHandle.docSync().packages)}async cachePackage(e,t){const{name:n,version:i,files:r}=t;if(!n)throw new Error("no name in package config");if(!i)throw new Error("no version in package config");if(!r)throw new Error("no files in package config");const c=await this.myRegistryDocHandle.doc();if(c.packages[n]&&c.packages[n][i]){console.log("already have this package",n,i);return}console.log("fetching package",n,i);const f=await this.fetchPackage(e,t);console.log("fetched package",n,i),this.linkPackage(n,i,f.url)}linkPackage(e,t,n){this.myRegistryDocHandle.change(i=>{i.packages[e]||(i.packages[e]={}),i.packages[e][t]!==n&&(i.packages[e][t]=n)}),console.log("registered package",e,t,n)}async findLinkedNames(e){const t=[],n=await this.myRegistryDocHandle.doc();for(const[i,r]of Object.entries(n.packages))for(const[c,f]of Object.entries(r))e==f&&t.push({version:c,name:i});return t}async fetchPackage(e,t){const{name:n,version:i,files:r}=t,c={};await Promise.all(r.map(async h=>{const p=await fetch(e+h),d={contentType:p.headers.get("Content-Type"),contents:new un(await p.text())};c[h]=d}));const f=this.automergeRepo.create();return f.change(h=>{Object.entries(t).forEach(([p,d])=>h[p]=d),h.fileContents=c}),console.log("cached package",n,i,f.url,f.doc),f}jspmProvider(){return{resolveLatestTarget:async(e,t,n)=>{const{registry:i,name:r,range:c,stable:f}=e,h=this.myRegistryDocHandle.docSync();if(!h.packages[r])throw new Error(`package ${r} not found in registry`);const p=Object.keys(h.packages[r]);let d=c.bestMatch(p,f);if(!d){if(d=new Te("*").bestMatch(p,f),!d)return console.log(`${r}: Could not satisfy range ${c.toString()} among ${p}, giving up!`),null;console.log(`${r}: Could not satisfy range ${c.toString()} among ${p}, falling back to ${d.toString()}`)}const l=d.toString();return{registry:i,name:r,version:l}},async pkgToUrl(e,t){let n=await e;const i=window.myRegistryDocHandle.docSync();n.pkg&&(n=n.pkg);const{registry:r,name:c,version:f}=n;if(!c||!f)throw console.log(n),console.log(i),new Error("pkgToUrl: missing name or version");const h=i.packages?.[c]?.[f];if(!h)throw new Error(`package ${c} not found in registry`);return new URL(`/automerge-repo/${h}/`,window.location).toString()},parseUrlPkg(e){const t=new URL(e);if(!t.pathname.startsWith("/automerge-repo"))return null;const n=/^\/automerge-repo\/(?<docUrl>[^\/]*)\/(?<subpath>.*)$/,{docUrl:i,subpath:r}=t.pathname.match(n).groups;return console.log("parseUrlPkg",e),new Promise((c,f)=>{repo.find(i).doc().then(h=>{const{name:p,version:d}=h;console.log("parseUrlPkg",{docUrl:i,name:p,version:d,subpath:r}),c({layer:"default",pkg:{registry:"automerge-registry",name:p,version:d},subpath:r})})})},ownsUrl(e){return new URL(e).pathname.startsWith("/automerge-repo")},async getPackageConfig(e){const t=new URL(e);if(!t.pathname.startsWith("/automerge-repo"))return null;const n=/^\/automerge-repo\/(?<docUrl>[^\/]*)\/(?<subpath>.*)$/,{docUrl:i,subpath:r}=t.pathname.match(n).groups;return new Promise((c,f)=>{repo.find(i).doc().then(h=>{const{fileContents:p,...d}=h;c(d)})})},supportedLayers:["*"]}}}async function Yi(s,e,t){const n=new Hi(s,e),{name:i}=await t.doc();console.log("Building importMap for ",i),n.linkPackage(i,"0.0.1",t.url),await n.update(i,t.url);const r=new Os({resolutions:{"@automerge/automerge-wasm":"./src/web"},defaultProvider:"automerge",customProviders:{automerge:n.jspmProvider()}});console.log(i),await r.install(i),console.log("new import map",r.getMap()),t.change(c=>{c.importMap=r.getMap()})}const Zi=Object.freeze(Object.defineProperty({__proto__:null,generateInitialImportMap:Yi},Symbol.toStringTag,{value:"Module"}));export{fs as _,Zi as b,pn as s};
